<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>解决Element-ui选择器（ElSelect）因数据量大导致页面卡顿的问题</title>
      <link href="scroll_select/"/>
      <url>scroll_select/</url>
      
        <content type="html"><![CDATA[<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"> * @Author: luopeng</span><br><span class="line"> * @Description:  el-select下拉滚动加载</span><br><span class="line"> * @<span class="built_in">Date</span>: <span class="number">2022</span>-<span class="number">08</span>-<span class="number">31</span> <span class="number">09</span>:<span class="number">22</span>:<span class="number">49</span></span><br><span class="line"> * @LastEditTime: <span class="number">2022</span>-<span class="number">08</span>-<span class="number">31</span> <span class="number">15</span>:<span class="number">53</span>:<span class="number">35</span></span><br><span class="line">--&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;content&quot;</span>&gt;</span><br><span class="line">    &lt;el-select</span><br><span class="line">      :value=<span class="string">&quot;value&quot;</span></span><br><span class="line">      clearable</span><br><span class="line">      :size=<span class="string">&quot;size&quot;</span></span><br><span class="line">      :multiple=<span class="string">&quot;multiple&quot;</span></span><br><span class="line">      :filter-method=<span class="string">&quot;filterMethod&quot;</span></span><br><span class="line">      v-bind=<span class="string">&quot;$attrs&quot;</span></span><br><span class="line">      v-select-showmore=<span class="string">&quot;showMore(rangeNumber)&quot;</span></span><br><span class="line">      @visible-change=<span class="string">&quot;visibleChange&quot;</span></span><br><span class="line">      @input=<span class="string">&quot;handleInput&quot;</span></span><br><span class="line">      @change=<span class="string">&quot;handleChange&quot;</span></span><br><span class="line">    &gt;</span><br><span class="line">      &lt;el-option</span><br><span class="line">        v-<span class="keyword">for</span>=<span class="string">&quot;item in options.slice(0, rangeNumber)&quot;</span></span><br><span class="line">        :key=<span class="string">&quot;item.value&quot;</span></span><br><span class="line">        :label=<span class="string">&quot;item.label&quot;</span></span><br><span class="line">        :value=<span class="string">&quot;item[valueKey]&quot;</span></span><br><span class="line">      &gt;&lt;/el-option&gt;</span><br><span class="line">    &lt;/el-select&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; debounce &#125; <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; deepClone &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    value: &#123; <span class="attr">type</span>: [<span class="built_in">String</span>, <span class="built_in">Number</span>, <span class="built_in">Array</span>] &#125;,</span><br><span class="line">    list: &#123;</span><br><span class="line">      type: <span class="built_in">Array</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="function">() =&gt;</span> [],</span><br><span class="line">    &#125;,</span><br><span class="line">    valueKey: &#123;</span><br><span class="line">      type: <span class="built_in">String</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="string">&#x27;value&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    size: &#123;</span><br><span class="line">      type: <span class="built_in">String</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="string">&#x27;mini&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    multiple: &#123;</span><br><span class="line">      type: <span class="built_in">Boolean</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      options: [],</span><br><span class="line">      rangeNumber: <span class="number">10</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    <span class="function"><span class="title">initValue</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> newArr = deepClone(<span class="built_in">this</span>.list);</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">this</span>.value) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.multiple) &#123;</span><br><span class="line">          <span class="keyword">const</span> checks = <span class="built_in">this</span>.list.filter(<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="built_in">this</span>.value.includes(item[<span class="built_in">this</span>.valueKey]));</span><br><span class="line">          checks.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> index = <span class="built_in">this</span>.list.indexOf(item);</span><br><span class="line">            newArr.unshift(newArr.splice(index, <span class="number">1</span>)[<span class="number">0</span>]);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> checks = <span class="built_in">this</span>.list.find(<span class="function">(<span class="params">item</span>) =&gt;</span> item[<span class="built_in">this</span>.valueKey] === <span class="built_in">this</span>.value);</span><br><span class="line">          <span class="keyword">const</span> index = <span class="built_in">this</span>.list.indexOf(checks);</span><br><span class="line">          newArr.unshift(newArr.splice(index, <span class="number">1</span>)[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> newArr;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="comment">// elementui下拉超过7条会出滚动条,如果初始不出滚动条无法触发loadMore方法</span></span><br><span class="line">    <span class="function"><span class="title">showMore</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="comment">/* eslint-disable no-return-assign */</span></span><br><span class="line">      <span class="keyword">return</span> <span class="function">() =&gt;</span> (<span class="built_in">this</span>.rangeNumber += <span class="number">10</span>); <span class="comment">// 每次滚动到底部可以新增条数</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 筛选方法</span></span><br><span class="line">    filterMethod: debounce(<span class="function"><span class="keyword">function</span> <span class="title">filterFun</span>(<span class="params">filterVal</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">const</span> query = filterVal?.trim() || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      <span class="keyword">if</span> (query) &#123;</span><br><span class="line">        <span class="comment">/* eslint-disable max-len */</span></span><br><span class="line">        <span class="keyword">const</span> filterArr = <span class="built_in">this</span>.list.filter(<span class="function">(<span class="params">item</span>) =&gt;</span> item.label?.toLowerCase().includes(query.toLowerCase()));</span><br><span class="line">        <span class="built_in">this</span>.options = filterArr;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// this.options = this.list;</span></span><br><span class="line">        <span class="built_in">this</span>.options = <span class="built_in">this</span>.initValue;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">300</span>),</span><br><span class="line">    <span class="comment">// 下拉框出现时，调用过滤方法</span></span><br><span class="line">    <span class="function"><span class="title">visibleChange</span>(<span class="params">flag</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">        <span class="built_in">this</span>.filterMethod();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">handleChange</span>(<span class="params">value</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">this</span>.multiple) &#123;</span><br><span class="line">        <span class="keyword">const</span> selectList = <span class="built_in">this</span>.options.filter(<span class="function">(<span class="params">item</span>) =&gt;</span> value.includes(item[<span class="built_in">this</span>.valueKey]));</span><br><span class="line">        <span class="built_in">this</span>.$emit(<span class="string">&#x27;change&#x27;</span>, selectList);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> selectObj = <span class="built_in">this</span>.options.find(<span class="function">(<span class="params">item</span>) =&gt;</span> item[<span class="built_in">this</span>.valueKey] === value);</span><br><span class="line">      <span class="built_in">this</span>.$emit(<span class="string">&#x27;change&#x27;</span>, selectObj);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">handleInput</span>(<span class="params">val</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.$emit(<span class="string">&#x27;input&#x27;</span>, val);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.options = <span class="built_in">this</span>.initValue;</span><br><span class="line">  &#125;,</span><br><span class="line">  directives: &#123;</span><br><span class="line">    <span class="string">&#x27;select-showmore&#x27;</span>: <span class="function">(<span class="params">el, binding</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> selectWrapDom = el.querySelector(<span class="string">&#x27;.el-select-dropdown .el-select-dropdown__wrap&#x27;</span>);</span><br><span class="line">      <span class="keyword">if</span> (selectWrapDom) &#123;</span><br><span class="line">        <span class="keyword">const</span> scrollFun = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">/* 如果元素滚动到底, 下面等式返回true, 没有则返回false */</span></span><br><span class="line">          <span class="keyword">const</span> condition = selectWrapDom.scrollHeight - selectWrapDom.scrollTop &lt;= selectWrapDom.clientHeight;</span><br><span class="line">          <span class="keyword">if</span> (condition) binding.value();</span><br><span class="line">        &#125;;</span><br><span class="line">        selectWrapDom.addEventListener(<span class="string">&#x27;scroll&#x27;</span>, scrollFun);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>el-form表单封装</title>
      <link href="form_component/"/>
      <url>form_component/</url>
      
        <content type="html"><![CDATA[<h2 id="缘由"><a href="#缘由" class="headerlink" title="缘由"></a>缘由</h2><blockquote><p>系统页面大部分为<code>form+tabel</code>的结构，系统复杂起来代码就看起来非常冗余，要修改起来也很麻烦，于是决定将表单封装起来。</p></blockquote><hr><h2 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h2><ol><li><p>业务与逻辑区分</p><ul><li>新建<code>const.js</code>文件，处理表单逻辑</li></ul></li><li><p>配置化</p><ul><li><code>json</code>对象化配置表单属性</li></ul></li><li><p>扩展&amp;特殊处理</p><ul><li>配置<code>slot</code>插槽</li></ul></li></ol><hr><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-form</span><br><span class="line">    ref=<span class="string">&quot;form&quot;</span></span><br><span class="line">    :id=<span class="string">&quot;formConfig.id&quot;</span></span><br><span class="line">    :<span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;formConfig.className&quot;</span></span><br><span class="line">    :label-width=<span class="string">&quot;formConfig.labelWidth || &#x27;100px&#x27;&quot;</span></span><br><span class="line">    :size=<span class="string">&quot;formConfig.size || &#x27;medium&#x27;&quot;</span></span><br><span class="line">    :rules=<span class="string">&quot;formConfig.rules&quot;</span></span><br><span class="line">    :model=<span class="string">&quot;formData&quot;</span></span><br><span class="line">  &gt;</span><br><span class="line">      &lt;template</span><br><span class="line">        v-<span class="keyword">for</span>=<span class="string">&quot;(item, index) in getConfigList()&quot;</span></span><br><span class="line">        :key=<span class="string">&quot;index&quot;</span></span><br><span class="line">      &gt;</span><br><span class="line">        &lt;el-form-item</span><br><span class="line">          :prop=<span class="string">&quot;item.value&quot;</span></span><br><span class="line">          :label=<span class="string">&quot;item.label&quot;</span></span><br><span class="line">          :label-width=<span class="string">&quot;item.labelWidth&quot;</span></span><br><span class="line">          :<span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;item.className&quot;</span></span><br><span class="line">        &gt;</span><br><span class="line">          &lt;!-- solt --&gt;</span><br><span class="line">          &lt;template v-<span class="keyword">if</span>=<span class="string">&quot;item.type === &#x27;slot&#x27;&quot;</span>&gt;</span><br><span class="line">            &lt;slot :name=<span class="string">&quot;&#x27;form-&#x27; + item.value&quot;</span> /&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">          &lt;component</span><br><span class="line">            :is=<span class="string">&quot;item.type&quot;</span></span><br><span class="line">            v-model=<span class="string">&quot;formData[item.value]&quot;</span></span><br><span class="line">            :type=<span class="string">&quot;item.dataType&quot;</span></span><br><span class="line">            :picker-options=<span class="string">&quot;item.timePickerOptions&quot;</span></span><br><span class="line">            :clearable=<span class="string">&quot;item.clearable&quot;</span></span><br><span class="line">            :disabled=<span class="string">&quot;item.disabled&quot;</span></span><br><span class="line">            :start-placeholder=<span class="string">&quot;item.startPlaceholder&quot;</span></span><br><span class="line">            :end-placeholder=<span class="string">&quot;item.endPlaceholder&quot;</span></span><br><span class="line">            :range-separator=<span class="string">&quot;item.rangeSeparator || &#x27;-&#x27;&quot;</span></span><br><span class="line">            :filterable=<span class="string">&quot;item.filterable&quot;</span></span><br><span class="line">            :multiple=<span class="string">&quot;item.multiple&quot;</span></span><br><span class="line">            :collapse-tags=<span class="string">&quot;item.collapseTags&quot;</span></span><br><span class="line">            <span class="keyword">default</span>-first-option</span><br><span class="line">            :allow-create=<span class="string">&quot;item.allowCreate&quot;</span></span><br><span class="line">            :no-data-text=<span class="string">&quot;item.noDataText || &#x27;&#x27;&quot;</span></span><br><span class="line">            :placeholder=<span class="string">&quot;getPlaceholder(item)&quot;</span></span><br><span class="line">            :value-format=<span class="string">&quot;item.valueFormat&quot;</span></span><br><span class="line">            :format=<span class="string">&quot;item.valueFormat&quot;</span></span><br><span class="line">            :style=<span class="string">&quot;&#123; width: item.width || &#x27;100%&#x27; &#125;&quot;</span></span><br><span class="line">            :maxlength=<span class="string">&quot;item.maxLength&quot;</span></span><br><span class="line">            :autosize=<span class="string">&quot;item.autosize || &#123; minRows: 2, maxRows: 10 &#125;&quot;</span></span><br><span class="line">            @click=<span class="string">&quot;handleEvent(item.event, formData[item.value], &#x27;click&#x27;)&quot;</span></span><br><span class="line">            @change=<span class="string">&quot;handleEvent(item.event, formData[item.value], &#x27;change&#x27;)&quot;</span></span><br><span class="line">            @input=<span class="string">&quot;handleEvent(item.event, formData[item.value], &#x27;input&#x27;)&quot;</span></span><br><span class="line">            @blur=<span class="string">&quot;handleEvent(item.event, formData[item.value], &#x27;blur&#x27;)&quot;</span></span><br><span class="line">          &gt;</span><br><span class="line">            &lt;template v-<span class="keyword">if</span>=<span class="string">&quot;item.type === &#x27;el-select&#x27;&quot;</span>&gt;</span><br><span class="line">              &lt;el-option</span><br><span class="line">                v-<span class="keyword">for</span>=<span class="string">&quot;(childItem, childIndex) in listTypeInfo[item.list]&quot;</span></span><br><span class="line">                :key=<span class="string">&quot;`$&#123;childItem.value&#125;$&#123;childIndex&#125;`&quot;</span></span><br><span class="line">                :label=<span class="string">&quot;childItem.label&quot;</span></span><br><span class="line">                :value=<span class="string">&quot;childItem.value&quot;</span></span><br><span class="line">              &gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">            &#123;&#123; item.title || <span class="string">&#x27;&#x27;</span> &#125;&#125;</span><br><span class="line">          &lt;/component&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">   &lt;/template&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">&#x27;FormItemComp&#x27;</span>,</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">formData</span>: &#123;&#125; &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    <span class="comment">// 表单配置项</span></span><br><span class="line">    formConfig: &#123;</span><br><span class="line">      type: <span class="built_in">Object</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 表单数据</span></span><br><span class="line">    data: &#123; <span class="attr">type</span>: <span class="built_in">Object</span> &#125;,</span><br><span class="line">    <span class="comment">// 下拉选项list</span></span><br><span class="line">    listTypeInfo: &#123; <span class="attr">type</span>: <span class="built_in">Object</span> &#125;,</span><br><span class="line">    <span class="comment">// ref</span></span><br><span class="line">    refObj: &#123; <span class="attr">type</span>: <span class="built_in">Object</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line">    data: &#123;</span><br><span class="line">      <span class="function"><span class="title">handler</span>(<span class="params">val</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!val) <span class="keyword">return</span>;</span><br><span class="line">        <span class="built_in">this</span>.formData = val;</span><br><span class="line">        <span class="comment">// 将form实例返回到父级</span></span><br><span class="line">        <span class="built_in">this</span>.$emit(<span class="string">&#x27;update:refObj&#x27;</span>, <span class="built_in">this</span>.$refs.form);</span><br><span class="line">      &#125;,</span><br><span class="line">      deep: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.formData = <span class="built_in">this</span>.data;</span><br><span class="line">    <span class="comment">// 将form实例返回到父级</span></span><br><span class="line">    <span class="built_in">this</span>.$emit(<span class="string">&#x27;update:refObj&#x27;</span>, <span class="built_in">this</span>.$refs.form);</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="comment">// 获取字段列表</span></span><br><span class="line">    <span class="function"><span class="title">getConfigList</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.formConfig.fieldList.filter(</span><br><span class="line">        (item) =&gt; !<span class="built_in">Object</span>.prototype.hasOwnProperty.call(item, <span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">          || (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(item, <span class="string">&#x27;show&#x27;</span>) &amp;&amp; item.show),</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 得到placeholder的显示</span></span><br><span class="line">    <span class="function"><span class="title">getPlaceholder</span>(<span class="params">row</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> placeholder;</span><br><span class="line">      <span class="keyword">const</span> types = [<span class="string">&#x27;el-select&#x27;</span>, <span class="string">&#x27;el-date-picker&#x27;</span>];</span><br><span class="line">      <span class="keyword">if</span> (row.type === <span class="string">&#x27;el-input&#x27;</span>) &#123;</span><br><span class="line">        placeholder = <span class="string">`请输入<span class="subst">$&#123;row.placeholder || <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (types.includes(row.type)) &#123;</span><br><span class="line">        placeholder = <span class="string">`请选择<span class="subst">$&#123;row.placeholder || <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        placeholder = row.label;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> placeholder;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 表单事件派发</span></span><br><span class="line">    <span class="function"><span class="title">handleEvent</span>(<span class="params">event, data, type</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.$emit(<span class="string">&#x27;handleEvent&#x27;</span>, &#123; event, data, type &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// const.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> FormJson =  &#123;</span><br><span class="line">  id: <span class="string">&#x27;form&#x27;</span>,</span><br><span class="line">  rules: &#123;&#125;,</span><br><span class="line">  labelWidth: <span class="string">&#x27;100px&#x27;</span>,</span><br><span class="line">  size: <span class="string">&#x27;mini&#x27;</span>,</span><br><span class="line">  className: <span class="string">&#x27;el-form-component&#x27;</span>,</span><br><span class="line">  fieldList: [</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;名称:&#x27;</span>,</span><br><span class="line">      value: <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">      type: <span class="string">&#x27;el-select&#x27;</span>,</span><br><span class="line">      clearable: <span class="literal">true</span>,</span><br><span class="line">      list: <span class="string">&#x27;nameList&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;来源:&#x27;</span>,</span><br><span class="line">      value: <span class="string">&#x27;source&#x27;</span>,</span><br><span class="line">      type: <span class="string">&#x27;el-select&#x27;</span>,</span><br><span class="line">      clearable: <span class="literal">true</span>,</span><br><span class="line">      list: <span class="string">&#x27;formSelect1&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;主体:&#x27;</span>,</span><br><span class="line">      value: <span class="string">&#x27;subject&#x27;</span>,</span><br><span class="line">      type: <span class="string">&#x27;el-input&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;分类:&#x27;</span>,</span><br><span class="line">      value: <span class="string">&#x27;nature&#x27;</span>,</span><br><span class="line">      type: <span class="string">&#x27;el-select&#x27;</span>,</span><br><span class="line">      clearable: <span class="literal">true</span>,</span><br><span class="line">      list: <span class="string">&#x27;formSelect2&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;日期:&#x27;</span>,</span><br><span class="line">      value: <span class="string">&#x27;date&#x27;</span>,</span><br><span class="line">      type: <span class="string">&#x27;el-date-picker&#x27;</span>,</span><br><span class="line">      dataType: <span class="string">&#x27;daterange&#x27;</span>,</span><br><span class="line">      valueFormat: <span class="string">&#x27;yyyy-MM-dd&#x27;</span>,</span><br><span class="line">      startPlaceholder: <span class="string">&#x27;开始日期&#x27;</span>,</span><br><span class="line">      endPlaceholder: <span class="string">&#x27;结束日期&#x27;</span>,</span><br><span class="line">      rangeSeparator: <span class="string">&#x27;至&#x27;</span>,</span><br><span class="line">      clearable: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;状态:&#x27;</span>,</span><br><span class="line">      value: <span class="string">&#x27;status&#x27;</span>,</span><br><span class="line">      type: <span class="string">&#x27;el-select&#x27;</span>,</span><br><span class="line">      clearable: <span class="literal">true</span>,</span><br><span class="line">      list: <span class="string">&#x27;projectStatus&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// slot插槽</span></span><br><span class="line">    &#123;</span><br><span class="line">      label: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      value: <span class="string">&#x27;btn&#x27;</span>,</span><br><span class="line">      type: <span class="string">&#x27;slot&#x27;</span>,</span><br><span class="line">      colWidth: <span class="number">18</span>,</span><br><span class="line">      className: <span class="string">&#x27;text-right&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;FormItemComp</span><br><span class="line">        :formConfig=<span class="string">&quot;FormJson&quot;</span></span><br><span class="line">        :refObj.sync=<span class="string">&quot;formRef&quot;</span></span><br><span class="line">        :data=<span class="string">&quot;formData&quot;</span></span><br><span class="line">        :listTypeInfo=<span class="string">&quot;listTypeInfo&quot;</span></span><br><span class="line">        @handleEvent=<span class="string">&quot;handleEvent&quot;</span></span><br><span class="line">    &gt;</span><br><span class="line">    &lt;template slot=<span class="string">&quot;form-btn&quot;</span>&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;el-button type=<span class="string">&quot;search&quot;</span> @click=<span class="string">&quot;&quot;</span>&gt;查询&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=<span class="string">&quot;reset&quot;</span> @click=<span class="string">&quot;&quot;</span>&gt;重置&lt;/el-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;/FormItemComp&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> FormItemComp <span class="keyword">from</span> <span class="string">&#x27;./FormItemComp&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; FormJson &#125; <span class="keyword">from</span> <span class="string">&#x27;./const.js&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            FormJson,</span><br><span class="line">            formRef: <span class="literal">null</span>, <span class="comment">// form ref</span></span><br><span class="line">            formData: &#123;</span><br><span class="line">                name: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                source: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                subject: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                nature: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                date: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                status: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// el-select选项</span></span><br><span class="line">            listTypeInfo: &#123;</span><br><span class="line">                formSelect1:[],</span><br><span class="line">                formSelect2:[],</span><br><span class="line">                projectStatus:[],</span><br><span class="line">                nameList:[],</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123; FormItemComp &#125;,</span><br><span class="line"></span><br><span class="line">    methods: &#123;</span><br><span class="line">    <span class="comment">// 表单的相关事件</span></span><br><span class="line">    <span class="function"><span class="title">handleEvent</span>(<span class="params">val</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo部署到个人云服务器</title>
      <link href="deploy/"/>
      <url>deploy/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote><p>最近趁着活动薅羊毛又把服务器续上了，既然白嫖到了不用白不用，就将个人博客挪个窝；顺便记录一下。</p></blockquote><hr><h2 id="购买服务器"><a href="#购买服务器" class="headerlink" title="购买服务器"></a>购买服务器</h2><p>首先我们需要有一台云服务器，我这里是买的<a href="https://cloud.tencent.com/product/cvm">腾讯云</a>的<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1642056347000.png"></p><hr><h2 id="通过git生成ssh秘钥"><a href="#通过git生成ssh秘钥" class="headerlink" title="通过git生成ssh秘钥"></a>通过git生成ssh秘钥</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 假如没有设置git的全局信息需要先设置 设置过了可以忽略</span></span><br><span class="line">git config --<span class="built_in">global</span> user.name <span class="string">&quot;yourname&quot;</span></span><br><span class="line">git config --<span class="built_in">global</span> user.email youremail@example.com</span><br><span class="line"><span class="comment">// 生成SSH密钥</span></span><br><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;youremail@example.com&quot;</span></span><br><span class="line"><span class="comment">// 禁用自动转换，这个不设置后面上传时会出现警告</span></span><br><span class="line">git config --<span class="built_in">global</span> core.autocrlf <span class="literal">false</span></span><br></pre></td></tr></table></figure><hr><h2 id="配置服务器git"><a href="#配置服务器git" class="headerlink" title="配置服务器git"></a>配置服务器git</h2><ol><li>登录服务器<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1642056955000.png"></li><li>安装git<br>通过git –version命令查看是否存在git命令，我这里已经安装好了；如果显示的是not found, 需要去安装<br><code>yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel perl-devel -y yum install -y git</code></li></ol><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1642057165000.png"></p><ol start="3"><li>创建用户并配置仓库<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">useradd git  <span class="comment">// 创建用户</span></span><br><span class="line">passwd git   <span class="comment">// 设置密码</span></span><br><span class="line">su git       <span class="comment">// 切换用户</span></span><br><span class="line">cd /home/git/  <span class="comment">// 进入git用户所在home目录</span></span><br><span class="line">mkdir -p projects/blog  <span class="comment">// 创建项目存放的目录（可以自行创建命名）</span></span><br><span class="line">mkdir repos &amp;&amp; cd repos  <span class="comment">// 创建文件夹</span></span><br><span class="line">git init --bare blog.git <span class="comment">// 创建一个裸露的仓库</span></span><br><span class="line">cd blog.git/hooks   <span class="comment">// 创建 hook 钩子函数</span></span><br><span class="line">vi post-receive     <span class="comment">// 编辑hook钩子</span></span><br></pre></td></tr></table></figure>在编辑区输入以下内容：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh </span><br><span class="line">git --work-tree=<span class="regexp">/home/gi</span>t/projects/blog --git-dir=<span class="regexp">/home/gi</span>t/repos/blog.git checkout -f</span><br><span class="line"></span><br><span class="line"><span class="comment">// /home/git/projects/blog 项目存放地址  </span></span><br><span class="line"><span class="comment">// /home/git/repos/blog.git git远程服务器仓库</span></span><br></pre></td></tr></table></figure><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1642058145000.png"></li></ol><p>按住<code>ESC</code>,然后输出<code>:wq</code>保存退出！</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chmod +x post-receive <span class="comment">// 为刚才的文件添加可执行的权限</span></span><br><span class="line"><span class="comment">// 退出切换到 root 登录</span></span><br><span class="line">exit                 </span><br><span class="line">su root</span><br><span class="line">chown -R git:git /home/git/repos/blog.git  <span class="comment">// 添加权限</span></span><br></pre></td></tr></table></figure><ol start="4"><li>测试本地能否将其clone</li></ol><p>在电脑上随便找个位置新建一个文件夹，并且将<code>bash</code>或者其他命令行工具切换到这里。开始执行以下命令（注意替换成你的服务器ip），测试能否将仓库<code>clone</code>下来。<br><code>git clone git@server_ip:/home/git/repos/blog.git</code></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1642058987000.png"></p><ol start="5"><li>建立SSH信任关系（免密登录）<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">su git  <span class="comment">// 切换到git用户</span></span><br><span class="line">cd ~</span><br><span class="line">mkdir .ssh  <span class="comment">// 创建.ssh目录</span></span><br><span class="line">chmod <span class="number">700</span> .ssh/ <span class="comment">// 赋予权限</span></span><br><span class="line">cd .ssh  <span class="comment">// 进入.ssh目录</span></span><br><span class="line">vi authorized_keys  <span class="comment">// 编辑一个名为authorized_keys的文件，并写入公钥(id_rsa.pub)内容</span></span><br><span class="line">chmod <span class="number">600</span> authorized_keys  <span class="comment">//添加完成后赋予权限 </span></span><br></pre></td></tr></table></figure>在本地测试能否连接成功<br><code>ssh git@server_ip</code>此时登录就只需要输入一次密码就好了。</li></ol><hr><h2 id="配置NGINX服务器"><a href="#配置NGINX服务器" class="headerlink" title="配置NGINX服务器"></a>配置NGINX服务器</h2><ol><li>安装<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 安装依赖 </span></span><br><span class="line">sudo yum install -y yum-utils </span><br><span class="line"><span class="comment">// 安装nginx服务 </span></span><br><span class="line">sudo yum install -y nginx</span><br></pre></td></tr></table></figure></li><li>配置<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//切换到nginx的配置文件目录</span></span><br><span class="line">cd /etc/nginx</span><br><span class="line"><span class="comment">// 编辑文件</span></span><br><span class="line">vi nginx.conf   <span class="comment">// 将 user 改成 root</span></span><br></pre></td></tr></table></figure><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1642060172000.png"></li></ol><p>修改<code>root</code>解析路径(<code>/home/git/projects/blog/</code>)<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1642060636000.png"></p><p>运行<code>nginx</code>此时在浏览器直接访问你的服务器ip地址即可看到一个404页面。</p><hr><h2 id="配置Hexo-deploy"><a href="#配置Hexo-deploy" class="headerlink" title="配置Hexo deploy"></a>配置Hexo deploy</h2><ol><li>配置博客根目录下的_config.yml文件<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">      <span class="attr">repo:</span> <span class="string">git@github.com:lp-Imagine/lp-Imagine.github.io.git</span></span><br><span class="line">      <span class="attr">branch:</span> <span class="string">master</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">      <span class="attr">repo:</span> <span class="string">git@42.192.205.229:/home/git/repos/blog.git</span></span><br><span class="line">      <span class="attr">branch:</span> <span class="string">master</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">baidu_url_submitter</span>   <span class="string">//</span> <span class="string">百度主动推送</span></span><br></pre></td></tr></table></figure></li><li>本地三连<code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code></li></ol><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1642061289000.png"></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>外挂标签</title>
      <link href="tagplus/"/>
      <url>tagplus/</url>
      
        <content type="html"><![CDATA[<h2 id="行内文本样式-text"><a href="#行内文本样式-text" class="headerlink" title="行内文本样式 text"></a>行内文本样式 text</h2><ol><li>带 <u>下划线</u> 的文本</li><li>带 <emp>着重号</emp> 的文本</li><li>带 <wavy>波浪线</wavy> 的文本</li><li>带 <del>删除线</del> 的文本</li><li>键盘样式的文本 <kbd>command</kbd> + <kbd>D</kbd></li><li>密码样式的文本：<psw>这里没有验证码</psw><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% u 下划线 %&#125; 的文本</span><br><span class="line">&#123;% emp 着重号 %&#125; 的文本</span><br><span class="line">&#123;% wavy 波浪线 %&#125; 的文本</span><br><span class="line">&#123;% del 删除线 %&#125; 的文本</span><br><span class="line">&#123;% kbd command %&#125; + &#123;% kbd D %&#125;</span><br><span class="line">&#123;% psw 这里没有验证码 %&#125;</span><br></pre></td></tr></table></figure></li></ol><ul><li><p>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<span class='p red'>红色</span>、<span class='p yellow'>黄色</span>、<span class='p green'>绿色</span>、<span class='p cyan'>青色</span>、<span class='p blue'>蓝色</span>、<span class='p gray'>灰色</span>。</p></li><li><p>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。</p><span class='p center logo large'>Volantis</span><span class='p center small'>A Wonderful Theme for Hexo</span></li><li><p>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<p class='p red'>红色</p>、<p class='p yellow'>黄色</p>、<p class='p green'>绿色</p>、<p class='p cyan'>青色</p>、<p class='p blue'>蓝色</p>、<p class='p gray'>灰色</p>。</p></li><li><p>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。</p><p class='p center logo large'>Volantis</p><p class='p center small'>A Wonderful Theme for Hexo</p></li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span red, 红色 %&#125;</span><br><span class="line">&#123;% span yellow, 黄色 %&#125;</span><br><span class="line">&#123;% span green, 绿色 %&#125;</span><br><span class="line">&#123;% span cyan, 青色 %&#125;</span><br><span class="line">&#123;% span blue, 蓝色 %&#125;</span><br><span class="line">&#123;% span gray, 灰色 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% span center logo large, Volantis %&#125;</span><br><span class="line">&#123;% span center small, A Wonderful Theme for Hexo %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% p red, 红色 %&#125;</span><br><span class="line">&#123;% p yellow, 黄色 %&#125;</span><br><span class="line">&#123;% p green, 绿色 %&#125;</span><br><span class="line">&#123;% p cyan, 青色 %&#125;</span><br><span class="line">&#123;% p blue, 蓝色 %&#125;</span><br><span class="line">&#123;% p gray, 灰色 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% p center logo large, Volantis %&#125;</span><br><span class="line">&#123;% p center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="note标签"><a href="#note标签" class="headerlink" title="note标签"></a>note标签</h2><div class="note icon simple"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon simple"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon simple"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon simple"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon simple"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon simple"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon simple"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;2022年....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="上标标签"><a href="#上标标签" class="headerlink" title="上标标签"></a>上标标签</h2><div class="tip "><p>默认情况</p></div><div class="tip success"><p>success</p></div><div class="tip error"><p>error</p></div><div class="tip warning"><p>warning</p></div><div class="tip bolt"><p>bolt</p></div><div class="tip ban"><p>ban</p></div><div class="tip home"><p>home</p></div><div class="tip sync"><p>sync</p></div><div class="tip cogs"><p>cogs</p></div><div class="tip key"><p>key</p></div><div class="tip bell"><p>bell</p></div><div class="tip fa-atom"><p>自定义font awesome图标</p></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip %&#125;默认情况&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip success %&#125;success&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip error %&#125;error&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip warning %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bolt %&#125;bolt&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban %&#125;ban&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip home %&#125;home&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip sync %&#125;sync&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip cogs %&#125;cogs&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip key %&#125;key&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bell %&#125;bell&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip fa-atom %&#125;自定义font awesome图标&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="动画标签"><a href="#动画标签" class="headerlink" title="动画标签"></a>动画标签</h2><div class="tip warning faa-horizontal animated"><p>warning</p></div><div class="tip ban faa-flash animated"><p>ban</p></div><div class="tip warning faa-horizontal animated faa-fast"><p>warning</p></div><div class="tip ban faa-flash animated faa-slow"><p>ban</p></div><div class="tip warning faa-horizontal animated-hover"><p>warning</p></div><div class="tip ban faa-flash animated-hover"><p>ban</p></div><div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">warning</p></div><div class="tip ban faa-parent animated-hover"><p class="faa-flash">ban</p></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated %&#125;ban&#123;% endtip %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% tip warning faa-horizontal animated-hover %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated-hover %&#125;ban&#123;% endtip %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% tip warning faa-parent animated-hover %&#125;&lt;p class=&quot;faa-horizontal&quot;&gt;warning&lt;/p&gt;&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-parent animated-hover %&#125;&lt;p class=&quot;faa-flash&quot;&gt;ban&lt;/p&gt;&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="复选列表-checkbox"><a href="#复选列表-checkbox" class="headerlink" title="复选列表 checkbox"></a>复选列表 checkbox</h2><div class='checkbox'><input type="checkbox" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="checkbox" />            <p>支持自定义颜色</p>            </div><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>绿色 + 默认选中</p>            </div><div class='checkbox yellow checked'><input type="checkbox" checked="checked"/>            <p>黄色 + 默认选中</p>            </div><div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>            <p>青色 + 默认选中</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>蓝色 + 默认选中</p>            </div><div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>            <p>增加</p>            </div><div class='checkbox minus yellow checked'><input type="checkbox" checked="checked"/>            <p>减少</p>            </div><div class='checkbox times red checked'><input type="checkbox" checked="checked"/>            <p>叉</p>            </div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox 纯文本测试 %&#125;</span><br><span class="line">&#123;% checkbox checked, 支持简单的 [markdown](https://guides.github.com/features/mastering-markdown/) 语法 %&#125;</span><br><span class="line">&#123;% checkbox red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% checkbox green checked, 绿色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, 黄色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, 青色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox blue checked, 蓝色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, 增加 %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, 减少 %&#125;</span><br><span class="line">&#123;% checkbox times red checked, 叉 %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="单选列表-radio"><a href="#单选列表-radio" class="headerlink" title="单选列表 radio"></a>单选列表 radio</h2><div class='checkbox'><input type="radio" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="radio" />            <p>支持自定义颜色</p>            </div><div class='checkbox green'><input type="radio" />            <p>绿色</p>            </div><div class='checkbox yellow'><input type="radio" />            <p>黄色</p>            </div><div class='checkbox cyan'><input type="radio" />            <p>青色</p>            </div><div class='checkbox blue'><input type="radio" />            <p>蓝色</p>            </div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio 纯文本测试 %&#125;</span><br><span class="line">&#123;% radio checked, 支持简单的 [markdown](https://guides.github.com/features/mastering-markdown/) 语法 %&#125;</span><br><span class="line">&#123;% radio red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% radio green, 绿色 %&#125;</span><br><span class="line">&#123;% radio yellow, 黄色 %&#125;</span><br><span class="line">&#123;% radio cyan, 青色 %&#125;</span><br><span class="line">&#123;% radio blue, 蓝色 %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="时间轴timeline"><a href="#时间轴timeline" class="headerlink" title="时间轴timeline"></a>时间轴timeline</h2><div class="timeline"><div class="timenode"><div class="meta"><p><p>2020-07-24 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases">2.6.6 -&gt; 3.0</a></p></p></div><div class="body"><ol><li>如果有 <code>hexo-lazyload-image</code> 插件，需要删除并重新安装最新版本，设置 <code>lazyload.isSPA: true</code>。</li><li>2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 <code>use_cdn: true</code> 则需要删除。</li><li>2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</li><li>2.x 版本的置顶 <code>top: true</code> 改为了 <code>pin: true</code>，并且同样适用于 <code>layout: page</code> 的页面。</li><li>如果使用了 <code>hexo-offline</code> 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</li></ol></div></div><div class="timenode"><div class="meta"><p><p>2020-05-15 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6">2.6.3 -&gt; 2.6.6</a></p></p></div><div class="body"><p>不需要额外处理。</p></div></div><div class="timenode"><div class="meta"><p><p>2020-04-20 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3">2.6.2 -&gt; 2.6.3</a></p></p></div><div class="body"><ol><li>全局搜索 <code>seotitle</code> 并替换为 <code>seo_title</code>。</li><li>group 组件的索引规则有变，使用 group 组件的文章内，<code>group: group_name</code> 对应的组件名必须是 <code>group_name</code>。</li><li>group 组件的列表名优先显示文章的 <code>short_title</code> 其次是 <code>title</code>。</li></ol></div></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;% timeline %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% timenode 2020-07-24 [2.6.6 -&gt; 3.0](https://github.com/volantis-x/hexo-theme-volantis/releases) %&#125;</span><br><span class="line"></span><br><span class="line">1. 如果有 `hexo-lazyload-image` 插件，需要删除并重新安装最新版本，设置 `lazyload.isSPA: true`。</span><br><span class="line">2. 2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 `use_cdn: true` 则需要删除。</span><br><span class="line">3. 2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</span><br><span class="line">4. 2.x 版本的置顶 `top: true` 改为了 `pin: true`，并且同样适用于 `layout: page` 的页面。</span><br><span class="line">5. 如果使用了 `hexo-offline` 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</span><br><span class="line"></span><br><span class="line">&#123;% endtimenode %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% timenode 2020-05-15 [2.6.3 -&gt; 2.6.6](https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6) %&#125;</span><br><span class="line"></span><br><span class="line">不需要额外处理。</span><br><span class="line"></span><br><span class="line">&#123;% endtimenode %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% timenode 2020-04-20 [2.6.2 -&gt; 2.6.3](https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3) %&#125;</span><br><span class="line"></span><br><span class="line">1. 全局搜索 `seotitle` 并替换为 `seo_title`。</span><br><span class="line">2. group 组件的索引规则有变，使用 group 组件的文章内，`group: group_name` 对应的组件名必须是 `group_name`。</span><br><span class="line">2. group 组件的列表名优先显示文章的 `short_title` 其次是 `title`。</span><br><span class="line"></span><br><span class="line">&#123;% endtimenode %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="链接卡片-link"><a href="#链接卡片-link" class="headerlink" title="链接卡片 link"></a>链接卡片 link</h2><div class="tag link"><a class="link-card" title="imagine's blog" href="https://imagineblog.vercel.app/"><div class="left"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/Akilarlxh/akilarlxh.github.io/img/siteicon/favicon.ico"/></div><div class="right"><p class="text">imagine's blog</p><p class="url">https://imagineblog.vercel.app/</p></div></a></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link imagine&#x27;s blog, https://imagineblog.vercel.app/, https://cdn.jsdelivr.net/gh/Akilarlxh/akilarlxh.github.io/img/siteicon/favicon.ico %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="按钮-btns"><a href="#按钮-btns" class="headerlink" title="按钮 btns"></a>按钮 btns</h2><div class="btns circle grid5">            <a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a>          </div><div class="btns rounded grid5">            <a class="button" href='/' title='下载源码'><i class='fas fa-download'></i>下载源码</a><a class="button" href='/' title='查看文档'><i class='fas fa-book-open'></i>查看文档</a>          </div><div class="btns circle center grid5">            <a href='https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p red'>专业版</p>  <img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_pro.png'></a><a href='https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p green'>免费版</p>  <img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_lite.png'></a>          </div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle grid5 %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% btns rounded grid5 %&#125;</span><br><span class="line">&#123;% cell 下载源码, /, fas fa-download %&#125;</span><br><span class="line">&#123;% cell 查看文档, /, fas fa-book-open %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% btns circle center grid5 %&#125;</span><br><span class="line">&lt;a href=&#x27;https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1&#x27;&gt;</span><br><span class="line">  &lt;i class=&#x27;fab fa-apple&#x27;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;b&gt;心率管家&lt;/b&gt;</span><br><span class="line">  &#123;% p red, 专业版 %&#125;</span><br><span class="line">  &lt;img src=&#x27;https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_pro.png&#x27;&gt;</span><br><span class="line">&lt;/a&gt;</span><br><span class="line">&lt;a href=&#x27;https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1&#x27;&gt;</span><br><span class="line">  &lt;i class=&#x27;fab fa-apple&#x27;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;b&gt;心率管家&lt;/b&gt;</span><br><span class="line">  &#123;% p green, 免费版 %&#125;</span><br><span class="line">  &lt;img src=&#x27;https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/qrcode/heartmate_lite.png&#x27;&gt;</span><br><span class="line">&lt;/a&gt;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="github卡片"><a href="#github卡片" class="headerlink" title="github卡片"></a>github卡片</h2><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/xaoxuu"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/?username=xaoxuu&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/xaoxuu"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/?username=xaoxuu&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/xaoxuu"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/?username=xaoxuu&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/xaoxuu"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/?username=xaoxuu&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/xaoxuu"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/?username=xaoxuu&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/xaoxuu"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/?username=xaoxuu&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/xaoxuu"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/?username=xaoxuu&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/xaoxuu"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/?username=xaoxuu&theme=calm&show_owner=true"/></a></td></tr></tbody></table><ul><li>仓库卡片</li></ul><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=calm&show_owner=true"/></a></td></tr></tbody></table><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard xaoxuu %&#125; | &#123;% ghcard xaoxuu, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard xaoxuu, theme=buefy %&#125; | &#123;% ghcard xaoxuu, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard xaoxuu, theme=onedark %&#125; | &#123;% ghcard xaoxuu, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard xaoxuu, theme=algolia %&#125; | &#123;% ghcard xaoxuu, theme=calm %&#125; |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 仓库卡片</span><br><span class="line"></span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=buefy %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=onedark %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=algolia %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=calm %&#125; |</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="github徽标"><a href="#github徽标" class="headerlink" title="github徽标"></a>github徽标</h2><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Butterfly-Theme-orange?logo=&color=orange&link=&"></object><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Hexo-Frame-orange?logo=hexo&color=orange&link=&"></object><object class="ghbdage" style="margin-inline:5px" title="本站使用JsDelivr为静态资源提供CDN加速" standby="loading..." data="https://img.shields.io/badge/JsDelivr-CDN-orange?logo=jsDelivr&color=abcdef&link=https://metroui.org.ua/index.html&"></object><p>//如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割</p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/GitHub-Source-orange?logo=GitHub&color=orange&link=https://github.com/&"></object><object class="ghbdage" style="margin-inline:5px" title="本站采用双线部署，默认线路托管于Vercel" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=brightgreen&link=https://vercel.com/&style=social&logoWidth=20"></object><p>//如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割</p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=orange&link=&style=social&logoWidth=20&logoColor=violet"></object><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Theme,Butterfly %&#125;</span><br><span class="line">&#123;% bdage Frame,Hexo,hexo %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% bdage CDN,JsDelivr,jsDelivr||abcdef,https://metroui.org.ua/index.html,本站使用JsDelivr为静态资源提供CDN加速 %&#125;</span><br><span class="line"><span class="comment">//如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割</span></span><br><span class="line">&#123;% bdage Source,GitHub,GitHub||,https://github.com/ %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% bdage Hosted,Vercel,Vercel||brightgreen,https://vercel.com/,本站采用双线部署，默认线路托管于Vercel||style=social&amp;logoWidth=20 %&#125;</span><br><span class="line"><span class="comment">//如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割</span></span><br><span class="line">&#123;% bdage Hosted,Vercel,Vercel||||style=social&amp;logoWidth=20&amp;logoColor=violet %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="网站卡片-sites"><a href="#网站卡片-sites" class="headerlink" title="网站卡片 sites"></a>网站卡片 sites</h2><div class="site-card-group"><a class="site-card" href="https://xaoxuu.com"><div class="img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg"/></div><div class="info"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png"/><span class="title">xaoxuu</span><span class="desc">简约风格</span></div></a><a class="site-card" href="https://inkss.cn"><div class="img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg"/></div><div class="info"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg"/><span class="title">inkss</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://blog.mhuig.top"><div class="img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png"/></div><div class="info"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png"/><span class="title">MHuiG</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://colsrch.top"><div class="img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png"/></div><div class="info"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg"/><span class="title">Colsrch</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://linhk1606.github.io"><div class="img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png"/></div><div class="info"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png"/><span class="title">Linhk1606</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site xaoxuu, url=https://xaoxuu.com, screenshot=https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg, avatar=https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png, description=简约风格 %&#125;</span><br><span class="line">&#123;% site inkss, url=https://inkss.cn, screenshot=https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg, avatar=https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site MHuiG, url=https://blog.mhuig.top, screenshot=https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png, avatar=https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Colsrch, url=https://colsrch.top, screenshot=https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png, avatar=https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Linhk1606, url=https://linhk1606.github.io, screenshot=https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png, avatar=https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="行内图片inlineimage"><a href="#行内图片inlineimage" class="headerlink" title="行内图片inlineimage"></a>行内图片inlineimage</h2><p>这是 <img no-lazy class="inline" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> 一段话。</p><p>这又是 <img no-lazy class="inline" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> 一段话。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif %&#125; 一段话。</span><br><span class="line"></span><br><span class="line">这又是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif, height=40px %&#125; 一段话。</span><br></pre></td></tr></table></figure><hr><h2 id="单张图片image"><a href="#单张图片image" class="headerlink" title="单张图片image"></a>单张图片image</h2><div class="img-wrap"><div class="img-bg"><img class="img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="没有什么故事。"/></div><span class="image-caption">没有什么故事。</span></div><div class="img-wrap"><div class="img-bg"><img class="img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" style="width:400px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="没有什么故事。" style="width:400px;"/></div><span class="image-caption">没有什么故事。</span></div><div class="img-wrap"><div class="img-bg" style="background:#1D0C04"><img class="img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="优化不同宽度浏览的观感" style="width:400px;"/></div><span class="image-caption">优化不同宽度浏览的观感</span></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, alt=没有什么故事。 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, alt=没有什么故事。 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, bg=#1D0C04, alt=优化不同宽度浏览的观感 %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="音频-audio"><a href="#音频-audio" class="headerlink" title="音频 audio"></a>音频 audio</h2><div class="audio"><audio controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3' type='audio/mp3'>Your browser does not support the audio tag.</audio></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3 %&#125;</span><br></pre></td></tr></table></figure><h2 id="视频-video"><a href="#视频-video" class="headerlink" title="视频 video"></a>视频 video</h2><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="videos" col='2'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div><div class="videos" col='4'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% videos, 2 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% videos, 4 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h2><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/4.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">MC</div>  <p>在Rikkaの六花服务器里留下的足迹</p>  <a href='/gallery/MC/'></a>  </figcaption>  </figure>    <figure class="gallery-group">  <img class="gallery-group-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/6.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Gundam</div>  <p>哦咧哇gundam哒！</p>  <a href='/gallery/Gundam/'></a>  </figcaption>  </figure>  </div><div class="justified-gallery"><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/12/25/gEy5Zc1Ai6VuO4N.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/12/25/E7Jvr4eIPwUNmzq.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/12/25/mh19anwBSWIkGlH.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://i.loli.net/2019/12/25/2tu9JC8ewpBFagv.jpg"></p>          </div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;gallery-group-main&quot;&gt;</span><br><span class="line">&#123;% galleryGroup MC 在Rikkaの六花服务器里留下的足迹 &#x27;/gallery/MC/&#x27; https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/4.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup Gundam 哦咧哇gundam哒！ &#x27;/gallery/Gundam/&#x27; https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/6.jpg %&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg)</span><br><span class="line">![](https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg)</span><br><span class="line">![](https://i.loli.net/2019/12/25/gEy5Zc1Ai6VuO4N.jpg)</span><br><span class="line">![](https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg)</span><br><span class="line">![](https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg)</span><br><span class="line">![](https://i.loli.net/2019/12/25/E7Jvr4eIPwUNmzq.jpg)</span><br><span class="line">![](https://i.loli.net/2019/12/25/mh19anwBSWIkGlH.jpg)</span><br><span class="line">![](https://i.loli.net/2019/12/25/2tu9JC8ewpBFagv.jpg)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="折叠框-folding"><a href="#折叠框-folding" class="headerlink" title="折叠框 folding"></a>折叠框 folding</h2><details ><summary> 查看图片测试 </summary>              <div class='content'>              <p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg"></p>              </div>            </details><details cyan open><summary> 查看默认打开的折叠框 </summary>              <div class='content'>              <p>这是一个默认打开的折叠框。</p>              </div>            </details><details green><summary> 查看代码测试 </summary>              <div class='content'>              <p>假装这里有代码块（代码块没法嵌套代码块）</p>              </div>            </details><details yellow><summary> 查看列表测试 </summary>              <div class='content'>              <ul><li>haha</li><li>hehe</li></ul>              </div>            </details><details red><summary> 查看嵌套测试 </summary>              <div class='content'>              <details blue><summary> 查看嵌套测试2 </summary>              <div class='content'>              <details ><summary> 查看嵌套测试3 </summary>              <div class='content'>              <p>hahaha <span><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png' style='height:24px'></span></p>              </div>            </details>              </div>            </details>              </div>            </details><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding 查看图片测试 %&#125;</span><br><span class="line"></span><br><span class="line">![](https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan open, 查看默认打开的折叠框 %&#125;</span><br><span class="line"></span><br><span class="line">这是一个默认打开的折叠框。</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding green, 查看代码测试 %&#125;</span><br><span class="line">假装这里有代码块（代码块没法嵌套代码块）</span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding yellow, 查看列表测试 %&#125;</span><br><span class="line"></span><br><span class="line">- haha</span><br><span class="line">- hehe</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding red, 查看嵌套测试 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding blue, 查看嵌套测试2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding 查看嵌套测试3 %&#125;</span><br><span class="line"></span><br><span class="line">hahaha &lt;span&gt;&lt;img src=&#x27;https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png&#x27; style=&#x27;height:24px&#x27;&gt;&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="分栏tab"><a href="#分栏tab" class="headerlink" title="分栏tab"></a>分栏tab</h2><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test1-1">test1 1</button></li><li class="tab"><button type="button" data-href="#test1-2">test1 2</button></li><li class="tab"><button type="button" data-href="#test1-3">test1 3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**This is Tab 1.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**This is Tab 2.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**This is Tab 3.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="诗词poem"><a href="#诗词poem" class="headerlink" title="诗词poem"></a>诗词poem</h2><div class='poem'><div class='poem-title'>水调歌头</div><div class='poem-author'>苏轼</div><p>丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。<br>明月几时有？把酒问青天。<br>不知天上宫阙，今夕是何年？<br>我欲乘风归去，又恐琼楼玉宇，高处不胜寒。<br>起舞弄清影，何似在人间？</p><p>转朱阁，低绮户，照无眠。<br>不应有恨，何事长向别时圆？<br>人有悲欢离合，月有阴晴圆缺，此事古难全。<br>但愿人长久，千里共婵娟。</p></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% poem 水调歌头,苏轼 %&#125;</span><br><span class="line">丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。</span><br><span class="line">明月几时有？把酒问青天。</span><br><span class="line">不知天上宫阙，今夕是何年？</span><br><span class="line">我欲乘风归去，又恐琼楼玉宇，高处不胜寒。</span><br><span class="line">起舞弄清影，何似在人间？</span><br><span class="line"></span><br><span class="line">转朱阁，低绮户，照无眠。</span><br><span class="line">不应有恨，何事长向别时圆？</span><br><span class="line">人有悲欢离合，月有阴晴圆缺，此事古难全。</span><br><span class="line">但愿人长久，千里共婵娟。</span><br><span class="line">&#123;% endpoem %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="进度条progress"><a href="#进度条progress" class="headerlink" title="进度条progress"></a>进度条progress</h2><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-red"  style="width: 10%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-yellow"  style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-green"  style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-cyan"  style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-gray"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress 10 red 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 30 yellow 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 50 green 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 70 cyan 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 90 blue 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 100 gray 进度条样式预览 %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="注释nota"><a href="#注释nota" class="headerlink" title="注释nota"></a>注释nota</h2><span class='nota' data-nota='可以看到注解内容出现在顶栏'>把鼠标移动到我上面试试</span><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota 把鼠标移动到我上面试试 ,可以看到注解内容出现在顶栏 %&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="旋转相册"><a href="#旋转相册" class="headerlink" title="旋转相册"></a>旋转相册</h2><div id='SF' class='carousel'><div id="SF-drag-container" class="drag-container"><div id="SF-spin-container" class="spin-container"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/0.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/04.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/2.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/3.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/4.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/6.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/2.jpg"><br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/3.jpg"><p>strike freedom</p></div><div id="SF-carousel-ground" class="carousel-ground"></div></div></div><script type="text/javascript">carouselinit('SF');</script><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% carousel &#x27;SF&#x27;,&#x27;strike freedom&#x27; %&#125;</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/0.jpg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/04.jpg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1.jpg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/2.jpg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/3.jpg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/4.jpg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/6.jpg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1.jpg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/2.jpg)</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/3.jpg)</span><br><span class="line">&#123;% endcarousel %&#125;</span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Element-UI问题清单</title>
      <link href="el/"/>
      <url>el/</url>
      
        <content type="html"><![CDATA[<blockquote><p>部分内容转载自：<a href="https://juejin.cn/user/1239904849499911">8号的凌晨4点</a>的<a href="https://juejin.cn/post/6981083988286767117">一份 ElementUI 问题清单</a></p></blockquote><h2 id="form表单只有一个-input-时回车键刷新页面"><a href="#form表单只有一个-input-时回车键刷新页面" class="headerlink" title="form表单只有一个 input 时回车键刷新页面"></a>form表单只有一个 input 时回车键刷新页面</h2><div class="tip bell faa-horizontal animated"><p>原因：触发了表单默认的提交行为，给el-form加上<span class='p red'>@submit.native.prevent</span>就行了。</p></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form</span> <span class="attr">inline</span> @<span class="attr">submit.native.prevent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;订单号&quot;</span>&gt;</span></span><br><span class="line">    &lt;el-input</span><br><span class="line">      v-model=&quot;query.orderNo&quot;</span><br><span class="line">      :placeholder=&quot;输入订单号查询&quot;</span><br><span class="line">      clearable</span><br><span class="line">      @keyup.enter.native=&quot;enterInput&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="动态表单form重置遇到的问题"><a href="#动态表单form重置遇到的问题" class="headerlink" title="动态表单form重置遇到的问题"></a>动态表单form重置遇到的问题</h2><div class="tip bolt faa-horizontal animated"><p>相对于动态表单（有条件的对表单进行渲染）而言，需要使用<span class='p red'>v-show</span>实现显示隐藏功能。如果使用<span class='p red'>v-if</span>会报错，但不会影响重置结果，报错的大概内容是<span class='p red'>‘indexOf’ is not function</span>。</p></div><hr><h2 id="解决表格线条不对齐"><a href="#解决表格线条不对齐" class="headerlink" title="解决表格线条不对齐"></a>解决表格线条不对齐</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> <span class="selector-class">.el-table</span> <span class="selector-tag">th</span><span class="selector-class">.gutter</span> &#123; </span><br><span class="line">    <span class="attribute">display</span>: table-cell <span class="meta">!important</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="表格固定列最后一行显示不全"><a href="#表格固定列最后一行显示不全" class="headerlink" title="表格固定列最后一行显示不全"></a>表格固定列最后一行显示不全</h2><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1628947994000.webp"></p><div class="tip bell faa-horizontal animated"><p>这种情况有时在宽度刚好处于临界值状态时会出现。因为固定列是独立于表格body动态计算高度的，出现了固定列高度小于表格高度所以造成最后一行被遮挡。</p></div><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 设置全局</span><br><span class="line"><span class="selector-class">.el-table__fixed-right</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="气泡确认框文档里的confirm事件不生效"><a href="#气泡确认框文档里的confirm事件不生效" class="headerlink" title="气泡确认框文档里的confirm事件不生效"></a>气泡确认框文档里的confirm事件不生效</h2><div class="tip warning"><p>版本：element-ui: “2.13.2”， vue: “2.6.10”</p></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将confirm改为onConfirm</span></span><br><span class="line">@onConfirm=<span class="string">&quot;onDeleteOrder(row.id)&quot;</span></span><br></pre></td></tr></table></figure><hr><h2 id="输入框用正则限制但绑定值未更新"><a href="#输入框用正则限制但绑定值未更新" class="headerlink" title="输入框用正则限制但绑定值未更新"></a>输入框用正则限制但绑定值未更新</h2><p>为了做输入框的正则限制，常采用下面的方式：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-input</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">&quot;form.retailMinOrder&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">onkeyup</span>=<span class="string">&quot;value=value.replace(/[^\d.]/g,&#x27;&#x27;)&quot;</span> </span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure><p>这样做虽然输入框的显示是正确的，但绑定的值是没有更新的，将 onkeyup 改为<span class='p red'>oninput</span> 即可。<br>输入中文后 v-model 会失效问题，可以这样写：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-input</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">&quot;form.retailMinOrder&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span> </span></span><br><span class="line"><span class="tag">  @<span class="attr">keyup.native</span>=<span class="string">&quot;form.retailMinOrder=form.retailMinOrder.replace(/[^\d.]/g,&#x27;&#x27;)&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="去除type-”number”输入框聚焦时的上下箭头"><a href="#去除type-”number”输入框聚焦时的上下箭头" class="headerlink" title="去除type=”number”输入框聚焦时的上下箭头"></a>去除type=”number”输入框聚焦时的上下箭头</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 设置全局 */</span></span><br><span class="line"><span class="selector-class">.clear-number-input</span><span class="selector-class">.el-input</span>::-webkit-outer-spin-button,</span><br><span class="line">.clear-number-input.el-input::-webkit-inner-spin-button &#123;</span><br><span class="line">  margin: <span class="number">0</span>;</span><br><span class="line">  -webkit-appearance: none <span class="meta">!important</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="selector-class">.clear-number-input</span><span class="selector-class">.el-input</span> <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;number&quot;</span>]</span>::-webkit-outer-spin-button,</span><br><span class="line">.clear-number-input.el-input input[type=<span class="string">&quot;number&quot;</span>]::-webkit-inner-spin-button &#123;</span><br><span class="line">  margin: <span class="number">0</span>;</span><br><span class="line">  -webkit-appearance: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clear-number-input</span><span class="selector-class">.el-input</span> &#123;</span><br><span class="line">  -moz-appearance: textfield;</span><br><span class="line">&#125; </span><br><span class="line"><span class="selector-class">.clear-number-input</span><span class="selector-class">.el-input</span> <span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;number&quot;</span>]</span> &#123;</span><br><span class="line">  -moz-appearance: textfield;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">class</span>=<span class="string">&quot;clear-number-input&quot;</span>  /&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="只校验表单中的某一个-些字段"><a href="#只校验表单中的某一个-些字段" class="headerlink" title="只校验表单中的某一个/些字段"></a>只校验表单中的某一个/些字段</h2><div class="tip bolt"><p>在一些用户注册场景中，提交整个表单前有时候我们会做一些单独字段的校验，例如发送手机验证码，发送时我们只需要校验手机号码这个字段，可以这样做：</p></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$refs[<span class="string">&#x27;form&#x27;</span>].validateField(<span class="string">&#x27;mobile&#x27;</span>, <span class="function"><span class="params">valid</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">    <span class="comment">// 发送验证码</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>需要多个字段，将参数改为数组形式即可。</p><hr><h2 id="移除对应表单项的校验结果"><a href="#移除对应表单项的校验结果" class="headerlink" title="移除对应表单项的校验结果"></a>移除对应表单项的校验结果</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;链接&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;url&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;refUrl&quot;</span> <span class="attr">v-show</span>=<span class="string">&quot;ruleForm.status==3&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;ruleForm.url&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入链接&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">changeStatus() &#123;</span><br><span class="line">this.$refs.refPath.clearValidate();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="弹窗重新打开时表单上次的校验信息未清除"><a href="#弹窗重新打开时表单上次的校验信息未清除" class="headerlink" title="弹窗重新打开时表单上次的校验信息未清除"></a>弹窗重新打开时表单上次的校验信息未清除</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> @<span class="attr">close</span>=<span class="string">&quot;onClose&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">ref</span>=<span class="string">&quot;form&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 弹窗关闭时重置表单</span><br><span class="line">onClose() &#123;</span><br><span class="line">  this.$refs[&#x27;form&#x27;].resetFields()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="表头与内容错位"><a href="#表头与内容错位" class="headerlink" title="表头与内容错位"></a>表头与内容错位</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 全局设置</span><br><span class="line"><span class="selector-class">.el-table--scrollable-y</span> <span class="selector-class">.el-table__body-wrapper</span> &#123;</span><br><span class="line"> <span class="attribute">overflow-y</span>: overlay <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="表单多级数据结构校验问题"><a href="#表单多级数据结构校验问题" class="headerlink" title="表单多级数据结构校验问题"></a>表单多级数据结构校验问题</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;form&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;部门&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;dept&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;姓名&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;user.name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">rules: &#123;</span><br><span class="line">  &#x27;user.name&#x27;: [&#123; required: true, message: &#x27;姓名不能为空&#x27;, trigger: &#x27;blur&#x27; &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="表格跨分页多选"><a href="#表格跨分页多选" class="headerlink" title="表格跨分页多选"></a>表格跨分页多选</h2><div class="tip bell faa-horizontal animated"><p>其实根据文档，只需加上<span class='p red'>row-key</span>和<span class='p red'>reserve-selection</span>即可。</p></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table</span> <span class="attr">row-key</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">&quot;selection&quot;</span> <span class="attr">reserve-selection</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="根据条件高亮行并去除默认hover颜色"><a href="#根据条件高亮行并去除默认hover颜色" class="headerlink" title="根据条件高亮行并去除默认hover颜色"></a>根据条件高亮行并去除默认hover颜色</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:row-class-name</span>=<span class="string">&quot;tableRowClassName&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">tableRowClassName(&#123; row &#125;) &#123;</span><br><span class="line">  return row.status === 2 ? &#x27;highlight&#x27; : &#x27;&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置全局</span><br><span class="line">.el-table .highlight &#123;</span><br><span class="line">  background-color: #b6e8fe;</span><br><span class="line">  &amp;:hover &gt; td &#123;</span><br><span class="line">    background-color: initial !important;</span><br><span class="line">  &#125;</span><br><span class="line">  td &#123;</span><br><span class="line">    background-color: initial !important;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="表单不想显示label但又想显示必填星号怎么办"><a href="#表单不想显示label但又想显示必填星号怎么办" class="headerlink" title="表单不想显示label但又想显示必填星号怎么办"></a>表单不想显示label但又想显示必填星号怎么办</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// label给个空格即可</span><br><span class="line"><span class="tag">&lt;<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot; &quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">placeholder</span>=<span class="string">&quot;名称不能为空&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="table-内嵌-input-调用-focus-方法无效"><a href="#table-内嵌-input-调用-focus-方法无效" class="headerlink" title="table 内嵌 input 调用 focus 方法无效"></a>table 内嵌 input 调用 focus 方法无效</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;名称&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">ref</span>=<span class="string">&quot;inputRef&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 无效</span><br><span class="line">this.$refs[&#x27;inputRef&#x27;].focus()</span><br><span class="line">this.$refs[&#x27;inputRef&#x27;][0].focus()</span><br><span class="line">this.$refs[&#x27;inputRef&#x27;].$el.children[0].focus()</span><br><span class="line"></span><br><span class="line">// 有效</span><br><span class="line"><span class="tag">&lt;<span class="name">el-input</span> <span class="attr">id</span>=<span class="string">&quot;inputRef&quot;</span> /&gt;</span></span><br><span class="line">document.getElementById(&#x27;inputRef&#x27;).focus()</span><br></pre></td></tr></table></figure><hr><h2 id="表格内容超出省略"><a href="#表格内容超出省略" class="headerlink" title="表格内容超出省略"></a>表格内容超出省略</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;customerName&quot;</span> <span class="attr">show-overflow-tooltip</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="el-tree-展开-收起所有节点"><a href="#el-tree-展开-收起所有节点" class="headerlink" title="el-tree 展开/收起所有节点"></a>el-tree 展开/收起所有节点</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-tree</span> <span class="attr">ref</span>=<span class="string">&quot;tree&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-tree</span>&gt;</span></span><br><span class="line"></span><br><span class="line">expandTree(expand = true) &#123;</span><br><span class="line">  const nodes = this.$refs[&#x27;tree&#x27;].store._getAllNodes()</span><br><span class="line">  nodes.forEach(node =&gt; &#123;</span><br><span class="line">    node.expanded = expand</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="修改el-input的高度"><a href="#修改el-input的高度" class="headerlink" title="修改el-input的高度"></a>修改el-input的高度</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 方式一：无效果</span><br><span class="line">&gt;&gt;&gt; <span class="selector-class">.el-input__inner</span> &#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">37px</span> <span class="meta">!important</span>;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">37px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 方式二：页面报错</span><br><span class="line">/deep/ <span class="selector-class">.el-input__inner</span> &#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">37px</span> <span class="meta">!important</span>;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">37px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 方式三：成功</span><br><span class="line">::v-deep .el-input__inner &#123;</span><br><span class="line">height: <span class="number">37px</span> <span class="meta">!important</span>;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">37px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="手动获取el-input焦点"><a href="#手动获取el-input焦点" class="headerlink" title="手动获取el-input焦点"></a>手动获取el-input焦点</h2><ul><li>需求：<blockquote><p>输入框一开始是隐藏的，点击按钮显示输入框并获取焦点。</p></blockquote><div class="tip cogs faa-horizontal animated"><p>把手动获取焦点的那段代码写在$nextTick()中即可。首先给标签加个属性ref=“searchBox”，然后点击按钮把控制显示的字段赋值为true，接着写下这行代码就好了。</p></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.$refs.searchBox.focus()</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="el-table用v-if隐藏显示列和预期不符问题"><a href="#el-table用v-if隐藏显示列和预期不符问题" class="headerlink" title="el-table用v-if隐藏显示列和预期不符问题"></a>el-table用v-if隐藏显示列和预期不符问题</h2><div class="tip success"><p>给<span class='p red'>el-table-column</span>加一个<span class='p red'>key</span>属性，<span class='p red'>:key=Math.random()</span>或者其他的，确保每列的<span class='p red'>key</span>值不同即可。</p></div><hr><h2 id="对表格中的数据做处理"><a href="#对表格中的数据做处理" class="headerlink" title="对表格中的数据做处理"></a>对表格中的数据做处理</h2><blockquote><p>在使用<span class='p red'>el-table</span>的时候有的时候需要对表格中的数据做处理，需要用到<span class='p red'>filter</span>，虽然官方也有提供过滤的方法<span class='p red'>filter-method</span>，但是还是用自定义列，然后用<span class='p red'>filter</span>复用性好一些。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;日期&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;scope.row.date | dateConvert&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="tabs标签中的name属性"><a href="#tabs标签中的name属性" class="headerlink" title="tabs标签中的name属性"></a>tabs标签中的name属性</h2><div class="tip cogs faa-horizontal animated"><p>因为给<span class='p red'>name</span>绑定了数字类型的数据，所以报错。<span class='p red'>name</span>属性要求的是字符串类型。在使用过滤器时，需要使用<span class='p red'>v-bind:name=item.id</span>来实现，使用<span class='p red'>:name=item.id</span>无法实现 </p></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-tabs</span> <span class="attr">v-model</span>=<span class="string">&quot;indexTab&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 注意：indexTab属性也要为字符串。 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 方案一：直接在标签属性上使用.toString() --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- :name=&quot;item.id.toString()&quot; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 方案二：使用过滤器 --&gt;</span></span><br><span class="line">&lt;el-tab-pane</span><br><span class="line">v-for=&quot;item in tabBar&quot;</span><br><span class="line">:key=&quot;item.id&quot;</span><br><span class="line">:label=&quot;item.title&quot;</span><br><span class="line">v-bind:name=&quot;item.id | numToStr&quot;</span><br><span class="line">&gt;</span><br><span class="line">用户管理</span><br><span class="line"><span class="tag">&lt;/<span class="name">el-tab-pane</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-tabs</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">filters: &#123;</span><br><span class="line"><span class="function"><span class="title">numToStr</span>(<span class="params">num</span>)</span> &#123;</span><br><span class="line">num = num.toString();</span><br><span class="line"><span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="引入日期时间的时候遇到英文问题"><a href="#引入日期时间的时候遇到英文问题" class="headerlink" title="引入日期时间的时候遇到英文问题"></a>引入日期时间的时候遇到英文问题</h2><p>需要在main.js配置这句话：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> locale <span class="keyword">from</span> <span class="string">&quot;element-ui/lib/locale/lang/zh-CN&quot;</span>;</span><br><span class="line">Vue.use(ElementUI, &#123;locale&#125;)</span><br></pre></td></tr></table></figure><p>表示全局配置element多语言组件</p><hr><h2 id="选择完成的日期时间结果打印"><a href="#选择完成的日期时间结果打印" class="headerlink" title="选择完成的日期时间结果打印"></a>选择完成的日期时间结果打印</h2><div class="tip cogs faa-horizontal animated"><p>框架返回的时间是这样的：Fri Nov 10 2000 04:01:01 GMT+0800 (中国标准时间)，可以通过以下方式转换成：2021-08-14 10:01:20 </p></div>}<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Day = <span class="keyword">new</span> <span class="built_in">Date</span>(e[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">let</span> Time = Day.getFullYear() +<span class="string">&quot;-&quot;</span> +<span class="built_in">this</span>.double(d.getMonth() + <span class="number">1</span>) + <span class="string">&quot;-&quot;</span> +<span class="built_in">this</span>.double(d.getDate()) + <span class="string">&quot; &quot;</span> +<span class="built_in">this</span>.double(d.getHours())+<span class="string">&quot;:&quot;</span> +<span class="built_in">this</span>.double(d.getMinutes()) +<span class="string">&quot;:&quot;</span> +<span class="built_in">this</span>.double(d.getSeconds());</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">double</span>(<span class="params">num</span>)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (num &lt; <span class="number">10</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;0&quot;</span> + num; <span class="comment">//如果时分秒少于10，则在前面加字符串0</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span> + num; <span class="comment">//否则，直接返回原有数字</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="隐藏的el-scrollbar组件"><a href="#隐藏的el-scrollbar组件" class="headerlink" title="隐藏的el-scrollbar组件"></a>隐藏的el-scrollbar组件</h2><div class="tip cogs faa-horizontal animated"><p>element-ui中有个隐藏的组件官方并未给出文档，他是自带的一个自定义滚动组件，也是非常好用的~ </p></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-scrollbar</span> <span class="attr">wrap-class</span>=<span class="string">&quot;&quot;</span>  <span class="attr">view-class</span>=<span class="string">&quot;&quot;</span> <span class="attr">:native</span>=<span class="string">&quot;false&quot;</span> &gt;</span></span><br><span class="line">......</span><br><span class="line"><span class="tag">&lt;/<span class="name">el-scrollbar</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h2><div class="btns rounded grid5">            <a class="button" href='https://segmentfault.com/a/1190000024479045' title='element-ui之el-table的使用合集'><i class='fas fa-book-open'></i>element-ui之el-table的使用合集</a><a class="button" href='https://segmentfault.com/a/1190000023256421' title='Element-ui使用中遇到的问题总结'><i class='fas fa-book-open'></i>Element-ui使用中遇到的问题总结</a>          </div>]]></content>
      
      
      <categories>
          
          <category> Element-UI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Element-UI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用的一些CSS样式</title>
      <link href="common-css/"/>
      <url>common-css/</url>
      
        <content type="html"><![CDATA[<h2 id="文本溢出隐藏"><a href="#文本溢出隐藏" class="headerlink" title="文本溢出隐藏"></a>文本溢出隐藏</h2><ul><li>单行文本<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line">   <span class="attribute">width</span>:<span class="number">200px</span>;</span><br><span class="line">   <span class="attribute">overflow</span>: hidden;</span><br><span class="line">   <span class="attribute">text-overflow</span>:ellipsis;</span><br><span class="line">   <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>多行文本<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">    -webkit-box-orient: vertical;</span><br><span class="line">    -webkit-line-clamp: <span class="number">3</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="中英文自动换行"><a href="#中英文自动换行" class="headerlink" title="中英文自动换行"></a>中英文自动换行</h2><blockquote><p>word-break:break-all;只对英文起作用，以字母作为换行依据word-wrap:break-word; 只对英文起作用，以单词作为换行依据white-space:pre-wrap; 只对中文起作用，强制换行white-space:nowrap; 强制不换行，都起作用</p></blockquote></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line">  <span class="attribute">word-wrap</span>: break-word;</span><br><span class="line">  <span class="attribute">white-space</span>: normal;</span><br><span class="line">  <span class="attribute">word-break</span>: break-all;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//不换行</span><br><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">  <span class="attribute">white-space</span>:nowrap;</span><br><span class="line">&#125;</span><br><span class="line">//自动换行</span><br><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">  <span class="attribute">word-wrap</span>: break-word;</span><br><span class="line">  <span class="attribute">word-break</span>: normal;</span><br><span class="line">&#125;</span><br><span class="line">//强制换行</span><br><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">  <span class="attribute">word-break</span>:break-all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文字阴影"><a href="#文字阴影" class="headerlink" title="文字阴影"></a>文字阴影</h2><blockquote><p>X-offset:指阴影居于字体水平偏移的位置。<br>Y-offset:指阴影居于字体垂直偏移的位置。<br>Blur:指阴影的模糊值。<br>color:指阴影的颜色。</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line"><span class="attribute">text-shadow</span>: <span class="number">5px</span> <span class="number">5px</span> <span class="number">5px</span> <span class="number">#FF0000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="设置placeholder属性的字体样式"><a href="#设置placeholder属性的字体样式" class="headerlink" title="设置placeholder属性的字体样式"></a>设置placeholder属性的字体样式</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span>::-webkit-input-placeholder &#123; /* Chrome/Opera/Safari */</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">input</span>::-moz-placeholder &#123; /* Firefox <span class="number">19</span>+ */</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">input</span>:-ms-input-placeholder &#123; /* IE <span class="number">10</span>+ */</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">input</span>:-moz-placeholder &#123; /* Firefox <span class="number">18</span>- */</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="IOS页面滑动卡顿"><a href="#IOS页面滑动卡顿" class="headerlink" title="IOS页面滑动卡顿"></a>IOS页面滑动卡顿</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>,<span class="selector-tag">html</span>&#123;</span><br><span class="line">    -webkit-<span class="attribute">overflow</span>-scrolling: touch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="滚动条样式"><a href="#滚动条样式" class="headerlink" title="滚动条样式"></a>滚动条样式</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.test</span>::-webkit-scrollbar&#123;</span><br><span class="line">  /*滚动条整体样式*/</span><br><span class="line">  width : <span class="number">10px</span>;  <span class="comment">/*高宽分别对应横竖滚动条的尺寸*/</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">1px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.test</span>::-webkit-scrollbar-thumb &#123;</span><br><span class="line">  /*滚动条里面小方块*/</span><br><span class="line">  border-radius   : <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: skyblue;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">-webkit-linear-gradient</span>(</span><br><span class="line">      <span class="number">45deg</span>,</span><br><span class="line">      <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>) <span class="number">25%</span>,</span><br><span class="line">      transparent <span class="number">25%</span>,</span><br><span class="line">      transparent <span class="number">50%</span>,</span><br><span class="line">      <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>) <span class="number">50%</span>,</span><br><span class="line">      <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>) <span class="number">75%</span>,</span><br><span class="line">      transparent <span class="number">75%</span>,</span><br><span class="line">      transparent</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.test</span>::-webkit-scrollbar-track &#123;</span><br><span class="line">  /*滚动条里面轨道*/</span><br><span class="line">  box-shadow   : inset <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">  <span class="attribute">background</span>   : <span class="number">#ededed</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">//隐藏滚动条同时支持滚动</span><br><span class="line"><span class="selector-class">.demo</span>::-webkit-scrollbar &#123;</span><br><span class="line">  display: none; <span class="comment">/* Chrome Safari */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.demo</span> &#123;</span><br><span class="line">  scrollbar-<span class="attribute">width</span>: none; <span class="comment">/* firefox */</span></span><br><span class="line">  -ms-<span class="attribute">overflow</span>-style: none; <span class="comment">/* IE 10+ */</span></span><br><span class="line">  <span class="attribute">overflow-x</span>: hidden;</span><br><span class="line">  <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="绘制三角形"><a href="#绘制三角形" class="headerlink" title="绘制三角形"></a>绘制三角形</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">40px</span> <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent transparent red;</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">//带边框</span><br><span class="line">&lt;div id=&quot;blue&quot;&gt;&lt;div&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#blue</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>:relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">40px</span> <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent transparent blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#blue</span>:after &#123;</span><br><span class="line">    content: <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">38px</span>;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">0</span> <span class="number">38px</span> <span class="number">38px</span>;</span><br><span class="line">    <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent transparent yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="table表格边框合并"><a href="#table表格边框合并" class="headerlink" title="table表格边框合并"></a>table表格边框合并</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">table</span>,<span class="selector-tag">tr</span>,<span class="selector-tag">td</span>&#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#666</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">table</span>&#123;</span><br><span class="line">  <span class="attribute">border-collapse</span>: collapse;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="css选取第n个标签元素"><a href="#css选取第n个标签元素" class="headerlink" title="css选取第n个标签元素"></a>css选取第n个标签元素</h2><ul><li>first-child  表示选择列表中的第一个标签</li><li>last-child  表示选择列表中的最后一个标签</li><li>nth-child(3) 表示选择列表中的第 3 个标签</li><li>nth-child(2n) 这个表示选择列表中的偶数标签</li><li>nth-child(2n-1) 这个表示选择列表中的奇数标签</li><li>nth-child(n+3) 这个表示选择列表中的标签从第 3 个开始到最后</li><li>nth-child(-n+3) 这个表示选择列表中的标签从 0 到 3，即小于 3 的标签</li><li>nth-last-child(3) 这个表示选择列表中的倒数第 3 个标签</li></ul><h2 id="onerror-处理图片异常"><a href="#onerror-处理图片异常" class="headerlink" title="onerror 处理图片异常"></a>onerror 处理图片异常</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">onerror</span>=<span class="string">&quot;this.src=&#x27;url;this.onerror=null&#x27;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h2 id="文字间距"><a href="#文字间距" class="headerlink" title="文字间距"></a>文字间距</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line">  <span class="attribute">text-indent</span>：<span class="number">10px</span>；//单词抬头距离</span><br><span class="line">  <span class="attribute">letter-spacing</span>：<span class="number">10px</span>；//间距</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="元素占满整个屏幕"><a href="#元素占满整个屏幕" class="headerlink" title="元素占满整个屏幕"></a>元素占满整个屏幕</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.dom</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">100vh</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文本两端对齐"><a href="#文本两端对齐" class="headerlink" title="文本两端对齐"></a>文本两端对齐</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: justify;</span><br><span class="line">    text-justify: distribute-all-lines;  //ie6-<span class="number">8</span></span><br><span class="line">    <span class="attribute">text-align-last</span>: justify;  //一个块或行的最后一行对齐方式</span><br><span class="line">    -moz-<span class="attribute">text-align-last</span>: justify;</span><br><span class="line">    -webkit-<span class="attribute">text-align-last</span>: justify;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文字竖向排版"><a href="#文字竖向排版" class="headerlink" title="文字竖向排版"></a>文字竖向排版</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// 单列展示时</span><br><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">height</span>: auto;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">8px</span> <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">word-wrap</span>: break-word;<span class="comment">/*英文的时候需要加上这句，自动换行*/</span> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 多列展示时</span><br><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">210px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: justify;</span><br><span class="line">    writing-mode: vertical-lr;  //从左向右    </span><br><span class="line">    writing-mode: tb-lr;        //IE从左向右</span><br><span class="line">    //writing-mode: vertical-rl;  -- 从右向左</span><br><span class="line">    //writing-mode: tb-rl;        -- 从右向左</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="禁止用户选择"><a href="#禁止用户选择" class="headerlink" title="禁止用户选择"></a>禁止用户选择</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">  -webkit-touch-callout: none;</span><br><span class="line">  -webkit-user-select: none;</span><br><span class="line">  -khtml-user-select: none;</span><br><span class="line">  -moz-user-select: none;</span><br><span class="line">  -ms-user-select: none;</span><br><span class="line">  user-select: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="页面动画出现闪烁问题"><a href="#页面动画出现闪烁问题" class="headerlink" title="页面动画出现闪烁问题"></a>页面动画出现闪烁问题</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.cube</span> &#123;</span><br><span class="line">   -webkit-<span class="attribute">backface-visibility</span>: hidden;</span><br><span class="line">   <span class="attribute">backface-visibility</span>: hidden;</span><br><span class="line"> </span><br><span class="line">   -webkit-<span class="attribute">perspective</span>: <span class="number">1000</span>;</span><br><span class="line">   <span class="attribute">perspective</span>: <span class="number">1000</span>;</span><br><span class="line">   <span class="comment">/* Other transform properties here */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------</span><br><span class="line"><span class="selector-class">.cube</span> &#123;</span><br><span class="line">   -webkit-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">   <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">/* Other transform properties here */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="字母大小写转换"><a href="#字母大小写转换" class="headerlink" title="字母大小写转换"></a>字母大小写转换</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">text-transform</span>: uppercase&#125;  // 将所有字母变成大写字母</span><br><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">text-transform</span>: lowercase&#125;  // 将所有字母变成小写字母</span><br><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">text-transform</span>: capitalize&#125; // 首字母大写</span><br><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">font-variant</span>: small-caps&#125;   // 将字体变成小型的大写字母</span><br></pre></td></tr></table></figure><h2 id="将容器设置为透明"><a href="#将容器设置为透明" class="headerlink" title="将容器设置为透明"></a>将容器设置为透明</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrap</span> &#123; </span><br><span class="line">  <span class="attribute">filter</span>:<span class="built_in">alpha</span>(opacity=<span class="number">50</span>); </span><br><span class="line">  -moz-<span class="attribute">opacity</span>:<span class="number">0.5</span>; </span><br><span class="line">  -khtml-<span class="attribute">opacity</span>: <span class="number">0.5</span>; </span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.5</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="transition闪屏问题"><a href="#transition闪屏问题" class="headerlink" title="transition闪屏问题"></a>transition闪屏问题</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d;</span><br><span class="line">    -webkit-<span class="attribute">backface-visibility</span>: hidden;</span><br><span class="line">    -webkit-<span class="attribute">perspective</span>: <span class="number">1000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="识别字符串里的-‘-n’-并换行"><a href="#识别字符串里的-‘-n’-并换行" class="headerlink" title="识别字符串里的 ‘\n’ 并换行"></a>识别字符串里的 ‘\n’ 并换行</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">   <span class="attribute">white-space</span>: pre-line;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="移除a标签被点链接的边框"><a href="#移除a标签被点链接的边框" class="headerlink" title="移除a标签被点链接的边框"></a>移除a标签被点链接的边框</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">outline</span>: none；//或者outline: <span class="number">0</span></span><br><span class="line">  text-decoration:none; //取消默认下划线</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="显示链接之后的URL"><a href="#显示链接之后的URL" class="headerlink" title="显示链接之后的URL"></a>显示链接之后的URL</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span>&gt;</span>百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-tag">a</span>:after &#123;content: <span class="string">&quot; (&quot;</span> <span class="built_in">attr</span>(href) <span class="string">&quot;)&quot;</span>;&#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="select内容居中显示、下拉内容右对齐"><a href="#select内容居中显示、下拉内容右对齐" class="headerlink" title="select内容居中显示、下拉内容右对齐"></a>select内容居中显示、下拉内容右对齐</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select&#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">text-align-last</span>: center;</span><br><span class="line">&#125;</span><br><span class="line">select option &#123;</span><br><span class="line">    <span class="attribute">direction</span>: rtl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="修改input输入框中光标的颜色不改变字体的颜色"><a href="#修改input输入框中光标的颜色不改变字体的颜色" class="headerlink" title="修改input输入框中光标的颜色不改变字体的颜色"></a>修改input输入框中光标的颜色不改变字体的颜色</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>:  <span class="number">#fff</span>;</span><br><span class="line">    caret-<span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="子元素固定宽度-父元素宽度被撑开"><a href="#子元素固定宽度-父元素宽度被撑开" class="headerlink" title="子元素固定宽度 父元素宽度被撑开"></a>子元素固定宽度 父元素宽度被撑开</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 父元素下的子元素是行内元素</span><br><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">&#125;</span><br><span class="line">// 若父元素下的子元素是块级元素</span><br><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;  // 子元素不被换行</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="div里的图片和文字上下居中"><a href="#div里的图片和文字上下居中" class="headerlink" title="div里的图片和文字上下居中"></a>div里的图片和文字上下居中</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrap</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100</span>,</span><br><span class="line">  line-height: <span class="number">100</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">  vertival-align：middle</span><br><span class="line">&#125;</span><br><span class="line">// <span class="attribute">vertical-align</span> css的属性<span class="attribute">vertical-align</span>用来指定行内元素（inline）或表格单元格（<span class="selector-tag">table</span>-cell）元素的垂直对齐方式。</span><br><span class="line">只对行内元素、表格单元格元素生效，不能用它垂直对齐块级元素</span><br><span class="line">// <span class="attribute">vertical-align</span>：baseline/<span class="attribute">top</span>/middle/<span class="attribute">bottom</span>/sub/text-<span class="attribute">top</span>;</span><br></pre></td></tr></table></figure><h2 id="宽高等比例自适应矩形"><a href="#宽高等比例自适应矩形" class="headerlink" title="宽高等比例自适应矩形"></a>宽高等比例自适应矩形</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">.scale &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  padding-bottom: 56.25%;</span><br><span class="line">  height: 0;</span><br><span class="line">  position: relative; </span><br><span class="line">&#125;</span><br><span class="line">.item &#123;</span><br><span class="line">  position: absolute; </span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-color: #499e56;</span><br><span class="line">&#125;    </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scale&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">         这里是所有子元素的容器</span><br><span class="line">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="css3动画"><a href="#css3动画" class="headerlink" title="css3动画"></a>css3动画</h2><h3 id="旋转动画"><a href="#旋转动画" class="headerlink" title="旋转动画"></a>旋转动画</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;loader&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">.loader &#123;</span><br><span class="line"><span class="css">  <span class="attribute">border</span>: <span class="number">16px</span> solid <span class="number">#f3f3f3</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-top</span>: <span class="number">16px</span> solid <span class="number">#3498db</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">width</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="css">  -webkit-<span class="attribute">animation</span>: spin <span class="number">2s</span> linear infinite;</span></span><br><span class="line"><span class="css">  <span class="attribute">animation</span>: spin <span class="number">2s</span> linear infinite;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@-webkit-keyframes</span> spin &#123;</span></span><br><span class="line"><span class="css">  <span class="number">0%</span> &#123; -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>); &#125;</span></span><br><span class="line"><span class="css">  <span class="number">100%</span> &#123; -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>); &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="css"><span class="keyword">@keyframes</span> spin &#123;</span></span><br><span class="line"><span class="css">  <span class="number">0%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>); &#125;</span></span><br><span class="line"><span class="css">  <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>); &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">### 文字/背景渐变</span><br><span class="line">```html</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text_signature &quot;</span> &gt;</span>前端css动画<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">.text_signature &#123;</span><br><span class="line"><span class="css">    -webkit-<span class="attribute">background-clip</span>: text;</span></span><br><span class="line"><span class="css">    -webkit-text-fill-<span class="attribute">color</span>: transparent;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#ec2239</span>, <span class="number">#40a4e2</span>,<span class="number">#ea96f5</span>);</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">320px</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">-----------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">// 背景渐变色</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text_gradient&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span> </span><br><span class="line">.text_gradient&#123;</span><br><span class="line"><span class="css">  <span class="attribute">width</span>:<span class="number">500px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>:<span class="number">100px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">25deg</span>, <span class="built_in">rgb</span>(<span class="number">79</span>, <span class="number">107</span>, <span class="number">208</span>), <span class="built_in">rgb</span>(<span class="number">98</span>, <span class="number">141</span>, <span class="number">185</span>), <span class="built_in">rgb</span>(<span class="number">102</span>, <span class="number">175</span>, <span class="number">161</span>), <span class="built_in">rgb</span>(<span class="number">92</span>, <span class="number">210</span>, <span class="number">133</span>)) <span class="built_in">rgb</span>(<span class="number">182</span>, <span class="number">228</span>, <span class="number">253</span>);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="边框阴影"><a href="#边框阴影" class="headerlink" title="边框阴影"></a>边框阴影</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text_shadow&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span> </span><br><span class="line">.text_shadow&#123;</span><br><span class="line"><span class="css">  <span class="attribute">width</span>:<span class="number">500px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>:<span class="number">100px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">13px</span> <span class="number">1px</span> <span class="built_in">rgba</span>(<span class="number">51</span>, <span class="number">51</span>, <span class="number">51</span>, <span class="number">0.1</span>);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="文字立体效果"><a href="#文字立体效果" class="headerlink" title="文字立体效果"></a>文字立体效果</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text_solid&quot;</span>&gt;</span>文字立体效果<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span> </span><br><span class="line">.text_solid&#123;</span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">32px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>:<span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-transform</span>:uppercase;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>:<span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-shadow</span>:</span></span><br><span class="line">    0px 1px 0px #c0c0c0,</span><br><span class="line">    0px 2px 0px #b0b0b0,</span><br><span class="line">    0px 3px 0px #a0a0a0,</span><br><span class="line">    0px 4px 0px #909090,</span><br><span class="line">    0px 5px 10px rgba(0, 0, 0, 0.6);</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="全屏背景图"><a href="#全屏背景图" class="headerlink" title="全屏背景图"></a>全屏背景图</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.swper</span>&#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">./img/bg.jpg</span>);</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">100%</span>;//父级高不为<span class="number">100%</span>请使用<span class="number">100vh</span></span><br><span class="line">  zoom: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">  -webkit-<span class="attribute">background-size</span>: cover;</span><br><span class="line">  -o-<span class="attribute">background-size</span>: cover;</span><br><span class="line">  <span class="attribute">background-position</span>: center <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文字描边"><a href="#文字描边" class="headerlink" title="文字描边"></a>文字描边</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.stroke</span> &#123;</span><br><span class="line">      -webkit-text-stroke: <span class="number">1px</span> greenyellow;</span><br><span class="line">     text-stroke: <span class="number">1px</span> greenyellow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.stroke</span> &#123;</span><br><span class="line">  <span class="attribute">text-shadow</span>:<span class="number">#000</span> <span class="number">1px</span> <span class="number">0</span> <span class="number">0</span>,<span class="number">#000</span> <span class="number">0</span> <span class="number">1px</span> <span class="number">0</span>,<span class="number">#000</span> -<span class="number">1px</span> <span class="number">0</span> <span class="number">0</span>,<span class="number">#000</span> <span class="number">0</span> -<span class="number">1px</span> <span class="number">0</span>;</span><br><span class="line">  -webkit-<span class="attribute">text-shadow</span>:<span class="number">#000</span> <span class="number">1px</span> <span class="number">0</span> <span class="number">0</span>,<span class="number">#000</span> <span class="number">0</span> <span class="number">1px</span> <span class="number">0</span>,<span class="number">#000</span> -<span class="number">1px</span> <span class="number">0</span> <span class="number">0</span>,<span class="number">#000</span> <span class="number">0</span> -<span class="number">1px</span> <span class="number">0</span>;</span><br><span class="line">  -moz-<span class="attribute">text-shadow</span>:<span class="number">#000</span> <span class="number">1px</span> <span class="number">0</span> <span class="number">0</span>,<span class="number">#000</span> <span class="number">0</span> <span class="number">1px</span> <span class="number">0</span>,<span class="number">#000</span> -<span class="number">1px</span> <span class="number">0</span> <span class="number">0</span>,<span class="number">#000</span> <span class="number">0</span> -<span class="number">1px</span> <span class="number">0</span>;</span><br><span class="line">  *<span class="attribute">filter</span>: <span class="built_in">Glow</span>(color=<span class="number">#000</span>, strength=<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="解决1px边框变粗问题"><a href="#解决1px边框变粗问题" class="headerlink" title="解决1px边框变粗问题"></a>解决1px边框变粗问题</h2><p>比如在2倍屏时1px的像素实际对应2个物理像素</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.dom</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#dbdbdb</span>;</span><br><span class="line">  <span class="attribute">transform</span>:<span class="built_in">scaleY</span>(<span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="css不同单位运算"><a href="#css不同单位运算" class="headerlink" title="css不同单位运算"></a>css不同单位运算</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.div</span>&#123; </span><br><span class="line">   <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">50px</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="文字模糊效果"><a href="#文字模糊效果" class="headerlink" title="文字模糊效果"></a>文字模糊效果</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.vague_text</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: transparent; </span><br><span class="line">  <span class="attribute">text-shadow</span>: <span class="number">#111</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="通过滤镜让图标变灰"><a href="#通过滤镜让图标变灰" class="headerlink" title="通过滤镜让图标变灰"></a>通过滤镜让图标变灰</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;&#x27;</span> <span class="attr">class</span>=<span class="string">&#x27;icon&#x27;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;01.jpg&#x27;</span> /&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">.icon&#123;</span><br><span class="line"><span class="css">  -webkit-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);</span></span><br><span class="line"><span class="css">  -moz-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);</span></span><br><span class="line"><span class="css">  -ms-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);</span></span><br><span class="line"><span class="css">  -o-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);   </span></span><br><span class="line"><span class="css">  <span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>);</span></span><br><span class="line"><span class="css">  <span class="attribute">filter</span>: gray;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.icon</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">filter</span>: none;</span></span><br><span class="line"><span class="css">  -webkit-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">0%</span>);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>css水平垂直居中</title>
      <link href="gqs30l/"/>
      <url>gqs30l/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>这是一个很常见的样式布局，网上也有很多的实现方式，本文主要是针对一些比较常用到的方法做一下总结，记录一下。</em></p></blockquote><p>现有实现方式大致的思路归纳为以下几种：</p><ul><li>固定宽高居中<ul><li>absolute + margin auto</li><li>absolute + 负 margin</li><li>absolute + calc</li></ul></li><li>不定宽高居中<ul><li>​ lineheight</li><li>​flex</li><li>absolute + transform</li><li>​grid</li><li>table-cell</li></ul></li></ul><p>公共代码（后面代码都基于这里）</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;out&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner&quot;</span>&gt;</span>水平垂直居中<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>实现的效果：<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/center.png"></p><hr><h2 id="absolute-margin-auto"><a href="#absolute-margin-auto" class="headerlink" title="absolute + margin auto"></a>absolute + margin auto</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.out</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blueviolet;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="absolute-负-margin"><a href="#absolute-负-margin" class="headerlink" title="absolute + 负 margin"></a>absolute + 负 margin</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.out</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blueviolet;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">150px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="absolute-calc"><a href="#absolute-calc" class="headerlink" title="absolute + calc"></a>absolute + calc</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.out</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blueviolet;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">150px</span>);</span><br><span class="line">  <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">150px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="lineheight"><a href="#lineheight" class="headerlink" title="lineheight"></a>lineheight</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.out</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: blueviolet;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">line-height</span>: initial;</span><br><span class="line">  <span class="comment">/* 若需要设置元素的宽高时 */</span></span><br><span class="line">  <span class="comment">/* width: 300px;</span></span><br><span class="line"><span class="comment">    height: 300px; */</span></span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="flex"><a href="#flex" class="headerlink" title="flex"></a>flex</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.out</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blueviolet;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="absolute-transform"><a href="#absolute-transform" class="headerlink" title="absolute + transform"></a>absolute + transform</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.out</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blueviolet;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="grid"><a href="#grid" class="headerlink" title="grid"></a>grid</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.out</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blueviolet;</span><br><span class="line">  <span class="attribute">align-self</span>: center;</span><br><span class="line">  justify-self: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="table-cell"><a href="#table-cell" class="headerlink" title="table-cell"></a>table-cell</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.out</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blueviolet;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><em>好了，基本上就这些了；还有些不怎么用到的就没去整理了。</em></p><blockquote><ul><li><em>PC 端：考虑兼容性的话推荐使用 absolute+负 margin 和</em>​<em>table-cell; 否则直接 flex。</em></li><li><em>移动端：首推</em>​<em>flex。</em></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>js if/else 语句优化策略</title>
      <link href="sp8d6i/"/>
      <url>sp8d6i/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><ul><li>在项目当中，都会遇到需要做大量分支判断的情况，最常用到的就是用 if/else；但是用起来并不是很美观；所以当遇到大量分支判断嵌套在一起时，就会显得很难阅读。就要对应地做出一些优化。</li></ul><h2 id="简单逻辑判断"><a href="#简单逻辑判断" class="headerlink" title="简单逻辑判断"></a>简单逻辑判断</h2><h3 id="提前-return"><a href="#提前-return" class="headerlink" title="提前 return"></a>提前 return</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (a) &#123;</span><br><span class="line">  a = <span class="number">2</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写成</span></span><br><span class="line"><span class="keyword">if</span> (!a) &#123;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">a = <span class="number">2</span>;</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title="||"></a>||</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (a) &#123;</span><br><span class="line">  a = <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  a = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改为</span></span><br><span class="line">a = a || <span class="number">0</span>;</span><br></pre></td></tr></table></figure><h3 id="三元表达式"><a href="#三元表达式" class="headerlink" title="三元表达式"></a>三元表达式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>,</span><br><span class="line">  b = <span class="number">2</span>,</span><br><span class="line">  c = <span class="number">3</span>,</span><br><span class="line">  d = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a === b) &#123;</span><br><span class="line">  a = d;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  a = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改为</span></span><br><span class="line">a = a === b ? d : c;</span><br></pre></td></tr></table></figure><h3 id="按位异或运算符"><a href="#按位异或运算符" class="headerlink" title="按位异或运算符^"></a>按位异或运算符^</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a =<span class="number">1</span>,b=<span class="number">2</span>,c=<span class="number">1</span>,</span><br><span class="line"><span class="keyword">if</span>(a === c)&#123;</span><br><span class="line">  c = b</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(b === c)&#123;</span><br><span class="line">  c = a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//写成</span></span><br><span class="line">a = a^b^c</span><br></pre></td></tr></table></figure><h2 id="复杂逻辑判断"><a href="#复杂逻辑判断" class="headerlink" title="复杂逻辑判断"></a>复杂逻辑判断</h2><h3 id="if-逻辑优化"><a href="#if-逻辑优化" class="headerlink" title="if 逻辑优化"></a>if 逻辑优化</h3><p>人们考虑的东西到时候，都会把最可能发生的情况先做好准备。优化 if 逻辑的时候也可以这样想：把最可能出现的条件放在前面，把最不可能出现的条件放在后面，这样程序执行时总会按照写的逻辑的先后顺序逐一检测所有的条件，知道发现匹配的条件才会停止继续检测。</p><ul><li>if 的优化目标：最小化找到分支之前所判断条件体的数量。</li><li>if 优化的方法：将最常见的条件放在首位。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(a &lt; <span class="number">10</span>)&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(a &gt; <span class="number">10</span> &amp;&amp; a &lt; <span class="number">100</span>)&#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="switch-case"><a href="#switch-case" class="headerlink" title="switch/case"></a>switch/case</h3><p>switch 在性能上和 if/else 区别不是很大，在大量分支判断时会比 if/else 看上去整洁。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatData</span>(<span class="params">time, format</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> t = <span class="keyword">new</span> <span class="built_in">Date</span>(time);</span><br><span class="line">  <span class="keyword">var</span> tf = <span class="function"><span class="keyword">function</span> (<span class="params">i</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (i &lt; <span class="number">10</span> ? <span class="string">&quot;0&quot;</span> : <span class="string">&quot;&quot;</span>) + i;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> format.replace(<span class="regexp">/yyyy|MM|dd|HH|mm|ss/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (a) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;yyyy&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getFullYear());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;MM&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getMonth() + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;mm&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getMinutes());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;dd&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getDate());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;HH&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getHours());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;ss&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getSeconds());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="利用-Object-重构"><a href="#利用-Object-重构" class="headerlink" title="利用 Object 重构"></a>利用 Object 重构</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (type === <span class="string">&quot;type_1&quot;</span>) &#123;</span><br><span class="line">  a = <span class="number">10</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">&quot;type_2&quot;</span>) &#123;</span><br><span class="line">  a = <span class="number">20</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">&quot;type_3&quot;</span>) &#123;</span><br><span class="line">  a = <span class="number">30</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 改成</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  type_1: <span class="number">10</span>,</span><br><span class="line">  type_2: <span class="number">20</span>,</span><br><span class="line">  type_3: <span class="number">30</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj[type]);</span><br></pre></td></tr></table></figure><h3 id="利用-Map"><a href="#利用-Map" class="headerlink" title="利用 Map"></a>利用 Map</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (type === <span class="string">&quot;type_1&quot;</span>) &#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">type1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    a = <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">&quot;type_2&quot;</span>) &#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">type2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    a = <span class="number">20</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">&quot;type_3&quot;</span>) &#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">type3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    a = <span class="number">30</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> action = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">  [</span><br><span class="line">    <span class="string">&quot;type_1&quot;</span>,</span><br><span class="line">    () =&gt; &#123;</span><br><span class="line">      a = <span class="number">10</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  [</span><br><span class="line">    <span class="string">&quot;type_2&quot;</span>,</span><br><span class="line">    () =&gt; &#123;</span><br><span class="line">      a = <span class="number">20</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  [</span><br><span class="line">    <span class="string">&quot;type_3&quot;</span>,</span><br><span class="line">    () =&gt; &#123;</span><br><span class="line">      a = <span class="number">30</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data = action.get(type);</span><br><span class="line"><span class="built_in">console</span>.log(data());</span><br></pre></td></tr></table></figure><p>相关文章：<a href="https://blog.csdn.net/qq_40259641/article/details/83866457?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-0&spm=1001.2101.3001.4242">JavaScript 复杂判断(if else / switch)的更优雅写法 优化冗余</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数组对象求和</title>
      <link href="pt9g3x/"/>
      <url>pt9g3x/</url>
      
        <content type="html"><![CDATA[<blockquote><p>数组对象求和问题，在项目中有时会遇到列表求和的情况，这里记录一下。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> list = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">value1</span>: <span class="number">5</span>, <span class="attr">value2</span>: <span class="number">10</span>, <span class="attr">value3</span>: <span class="number">20</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">value1</span>: <span class="number">15</span>, <span class="attr">value2</span>: <span class="number">10</span>, <span class="attr">value3</span>: <span class="number">50</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">value1</span>: <span class="number">40</span>, <span class="attr">value2</span>: <span class="number">20</span>, <span class="attr">value3</span>: <span class="number">20</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="利用-reduce-和-Object-keys"><a href="#利用-reduce-和-Object-keys" class="headerlink" title="利用 reduce()和 Object.keys()"></a>利用 reduce()和 Object.keys()</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeArr</span>(<span class="params">arr, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> result = arr.reduce(<span class="function">(<span class="params">acc, cur</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">Object</span>.keys(acc).forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> (acc[item] += cur[item]));</span><br><span class="line">    <span class="keyword">return</span> acc;</span><br><span class="line">  &#125;, data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = &#123; <span class="attr">value1</span>: <span class="number">0</span>, <span class="attr">value2</span>: <span class="number">0</span>, <span class="attr">value3</span>: <span class="number">0</span> &#125;;</span><br><span class="line">mergeArr(list, data); <span class="comment">// &#123;value1: 60, value2: 40, value3: 90&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>js对象排序</title>
      <link href="sortObj/"/>
      <url>sortObj/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote><p>记录一次在项目开发中遇到的情况。后台返回一个排好序的对象作为折线图的数据，按要求根据日期顺序进行展示。首先要清楚一点是js对象是无序的，即使后台排好了序，还是会错乱，所以需要在前端渲染前做一遍排序操作。</p></blockquote><hr><h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><ul><li>js对象是没办法直接进行排序的，可以针对对象的某个属性或键值来排序，最后将对应的value取出来。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line"><span class="number">20210601</span>:&#123;<span class="attr">date</span>:<span class="number">20210601</span>,<span class="attr">name</span>:<span class="string">&#x27;a&#x27;</span>,<span class="attr">age</span>:<span class="number">22</span>&#125;，</span><br><span class="line"><span class="number">20210604</span>:&#123;<span class="attr">date</span>:<span class="number">20210604</span>,<span class="attr">name</span>:<span class="string">&#x27;b&#x27;</span>,<span class="attr">age</span>:<span class="number">20</span>&#125;,</span><br><span class="line"><span class="number">20210602</span>:&#123;<span class="attr">date</span>:<span class="number">20210602</span>,<span class="attr">name</span>:<span class="string">&#x27;c&#x27;</span>,<span class="attr">age</span>:<span class="number">18</span>&#125;,</span><br><span class="line"><span class="number">20210603</span>:&#123;<span class="attr">date</span>:<span class="number">20210603</span>,<span class="attr">name</span>:<span class="string">&#x27;d&#x27;</span>,<span class="attr">age</span>:<span class="number">26</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = []</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将key值排序</span></span><br><span class="line"><span class="keyword">let</span> sortKeys = <span class="built_in">Object</span>.keys(obj).sort(<span class="function">(<span class="params">a,b</span>)=&gt;</span>&#123;</span><br><span class="line"><span class="keyword">return</span> obj[a] - obj[b]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(sortKeys)   <span class="comment">//  [&quot;20210601&quot;, &quot;20210602&quot;, &quot;20210603&quot;, &quot;20210604&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 循环排列好的 key, 组成一个新的数组</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> index <span class="keyword">in</span> sortKeys) &#123;</span><br><span class="line">      arr.push(obj[sortKeys[index]])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr) </span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1630034850000.png"></p><hr>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript 数组去重</title>
      <link href="rs7zqd/"/>
      <url>rs7zqd/</url>
      
        <content type="html"><![CDATA[<blockquote><p>主要记录一下前端数组去重的几种方法，也方便后面查看。</p></blockquote><h2 id="ES6-new-Set-…-Array-from"><a href="#ES6-new-Set-…-Array-from" class="headerlink" title="ES6 new Set() + … || Array.from"></a>ES6 new Set() + … || Array.from</h2><p>ES6 提供了新的数据结构 Set。类似于数组，但是成员的值都是唯一的，没有重复的值。<br>Set 本身是一个构造函数，可以接受一个具有 iterable 接口数据结构作为参数（如数组，字符串），用来初始化。</p><div class="note info modern"><p>不考虑兼容性，这种去重的方法代码最少。这种方法还无法去掉“{}”空对象</p></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> newArr = [...new <span class="built_in">Set</span>(arr)]; <span class="comment">// [1, 2, 3, null, &quot;a&quot;, &quot;b&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> newArr1 = <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(arr)); <span class="comment">// [1, 2, 3, null, &quot;a&quot;, &quot;b&quot;]</span></span><br></pre></td></tr></table></figure><h2 id="ES6-new-Map"><a href="#ES6-new-Map" class="headerlink" title="ES6 new Map()"></a>ES6 new Map()</h2><p>ES6 提供了新的数据结构 Map 。类似于对象，也是键值对的集合，但是“键”的范围不限于字符串，各种类型的值（包括对象）都可以当作键。</p><ul><li>set 方法设置键名 key 对应的键值为 value，然后返回整个 Map 结构。如果 key 已经有值，则键值会被更新，否则就新生成该键。</li><li>get 方法读取 key 对应的键值，如果找不到 key，返回 undefined。</li><li>has 方法返回一个布尔值，表示某个键是否在当前 Map 对象之中。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"><span class="keyword">let</span> newArr = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!map.has(arr[i])) &#123;</span><br><span class="line">    map.set(arr[i], <span class="literal">true</span>);</span><br><span class="line">    newArr.push(arr[i]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(newArr); <span class="comment">//  [1, 2, 3, null, &quot;a&quot;, &quot;b&quot;]</span></span><br></pre></td></tr></table></figure><h2 id="Array-includes"><a href="#Array-includes" class="headerlink" title="Array.includes()"></a>Array.includes()</h2><p>includes()方法：用来判断一个数组是否包含一个指定的值，如果是返回 true，否则 false。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> newArr = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!newArr.includes(arr[i])) newArr.push(arr[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// forEach</span></span><br><span class="line">arr.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> (!newArr.includes(item) ? newArr.push(item) : <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(newArr); <span class="comment">// [1, 2, 3, null, &quot;a&quot;, &quot;b&quot;]</span></span><br></pre></td></tr></table></figure><h2 id="Array-indexOf"><a href="#Array-indexOf" class="headerlink" title="Array.indexOf()"></a>Array.indexOf()</h2><p>indexOf()方法：返回数组中某个指定元素的位置。该方法遍历数组，查找有无对应元素并返回元素第一次出现的索引，若未找到指定元素则返回-1。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> newArr = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (newArr.indexOf(arr[i]) === -<span class="number">1</span>) newArr.push(arr[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//等同于使用forEach遍历</span></span><br><span class="line">arr.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> (newArr.indexOf(item) === -<span class="number">1</span> ? newArr.push(item) : <span class="string">&quot;&quot;</span>));</span><br></pre></td></tr></table></figure><h2 id="Array-reduce-Array-includes"><a href="#Array-reduce-Array-includes" class="headerlink" title="Array.reduce + Array.includes"></a>Array.reduce + Array.includes</h2><p>reduce()方法：接收一个函数作为累加器，数组中的每个值从左到右开始计算，最终计算为一个值。</p><blockquote><p>语法：arr.reduce(function(total, currValue, currIndex, arr), initValue) &gt; reduce()对于空数组是不会执行回调函数的。</p></blockquote><ul><li>total：必需。初始值, 或者计算结束后的返回值</li><li>currValue：必需。当前元素</li><li>currIndex：可选。当前元素的索引</li><li>arr ：可选。当前数组对象。</li><li>initValue：可选。累加器初始值</li></ul><p>一个空数组调用 reduce()方法且沒有提供初始值，会报错。<br>一个空数组调用 reduce()方法且提供了初始值，将直接返回该初始值，不會调用 callback 函数。<br>非空数组调用 reduce()提供初始值，则 total 将会等于初始值，且 currValue 从第一个元素开始；若沒有提供初始值，则 total 会等于的第一个元素值，且 currValue 将会从第二个元素开始。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> newArr = arr.reduce(<span class="function">(<span class="params">acc, cur</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> acc.includes(cur) ? acc : acc.concat(cur); <span class="comment">// 1. 拼接方法</span></span><br><span class="line">  <span class="comment">// return acc.includes(cur) ? acc : [...acc, cur]; // 2. 扩展运算</span></span><br><span class="line">&#125;, []);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(newArr); <span class="comment">// [1, 2, 3, null, &quot;a&quot;, &quot;b&quot;]</span></span><br></pre></td></tr></table></figure><h2 id="Array-filter-Array-indexOf"><a href="#Array-filter-Array-indexOf" class="headerlink" title="Array.filter + Array.indexOf"></a>Array.filter + Array.indexOf</h2><p>filter()方法：创建一个新数组，新数组中的元素是指定数组中符合某种条件的所有元素。如果没有符合条件的元素则返回空数组。</p><blockquote><p>语法：array.filter(function(item,index,arr))</p></blockquote><p>filter()不会对空数组进行检测。<br>filter()不会改变原始数组。</p><ul><li>原理：返回 item 第一次出现的位置等于当前的 index 的元素</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> newArr = arr.filter(<span class="function">(<span class="params">item, index</span>) =&gt;</span> arr.indexOf(item) === index);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(newArr); <span class="comment">// [1, 2, 3, null, &quot;a&quot;, &quot;b&quot;]</span></span><br></pre></td></tr></table></figure><h2 id="Array-filter-Object-hasOwnProperty"><a href="#Array-filter-Object-hasOwnProperty" class="headerlink" title="Array.filter + Object.hasOwnProperty"></a>Array.filter + Object.hasOwnProperty</h2><p>hasOwnProperty()方法：返回一个布尔值，表示对象自身属性中是否具有指定的属性</p><ul><li>原理：利用对象的键名不可重复的特点。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">arr.filter(<span class="function">(<span class="params">item</span>) =&gt;</span></span><br><span class="line">  obj.hasOwnProperty(<span class="keyword">typeof</span> item + item)</span><br><span class="line">    ? <span class="literal">false</span></span><br><span class="line">    : (obj[<span class="keyword">typeof</span> item + item] = <span class="literal">true</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// [1, 2, 3, null, &quot;a&quot;, &quot;b&quot;]</span></span><br></pre></td></tr></table></figure><h2 id="利用对象的-key-唯一"><a href="#利用对象的-key-唯一" class="headerlink" title="利用对象的 key 唯一"></a>利用对象的 key 唯一</h2><p>对象的 key 不可重复，否则后者将覆盖前者。利用该特性，实现数组去重，遍历数组，将数组的每一项做为对象的 key 值。</p><p>若当前元素重复，则与数组最后一位元素交换位置，i–再次进行判断即可，同时 length–,操作数组的长度实现删除数组的最后一个元素，这样便不会影响到数组中其他元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">null</span>, <span class="string">&quot;a&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">  <span class="keyword">let</span> item = arr[i];</span><br><span class="line">  <span class="keyword">if</span> (obj[item] !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">    arr[i] = arr[arr.length - <span class="number">1</span>];</span><br><span class="line">    arr.length--;</span><br><span class="line">    i--;</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  obj[item] = item;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// [1, 2, 3, null, &quot;a&quot;, &quot;b&quot;]</span></span><br></pre></td></tr></table></figure><h2 id="利用-sort"><a href="#利用-sort" class="headerlink" title="利用 sort()"></a>利用 sort()</h2><p>利用 sort()排序方法，然后根据排序后的结果进行遍历及相邻元素比对。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;type error!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  arr = arr.sort();</span><br><span class="line">  <span class="keyword">var</span> arrry = [arr[<span class="number">0</span>]];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr[i] !== arr[i - <span class="number">1</span>]) &#123;</span><br><span class="line">      arrry.push(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arrry;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [</span><br><span class="line">  <span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,</span><br><span class="line">  <span class="string">&quot;true&quot;</span>,</span><br><span class="line">  <span class="string">&quot;true&quot;</span>,</span><br><span class="line">  <span class="literal">true</span>,</span><br><span class="line">  <span class="literal">true</span>,</span><br><span class="line">  <span class="number">20</span>,</span><br><span class="line">  <span class="number">20</span>,</span><br><span class="line">  <span class="literal">false</span>,</span><br><span class="line">  <span class="literal">false</span>,</span><br><span class="line">  <span class="literal">undefined</span>,</span><br><span class="line">  <span class="literal">undefined</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="literal">NaN</span>,</span><br><span class="line">  <span class="literal">NaN</span>,</span><br><span class="line">  <span class="string">&quot;NaN&quot;</span>,</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;a&quot;</span>,</span><br><span class="line">  <span class="string">&quot;a&quot;</span>,</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">];</span><br><span class="line"><span class="built_in">console</span>.log(unique(arr));</span><br><span class="line"><span class="comment">// [0, 1, 20, &quot;NaN&quot;, NaN, NaN, &#123;…&#125;, &#123;…&#125;, &quot;a&quot;, false, null, true, &quot;true&quot;, undefined]      //NaN、&#123;&#125;没有去重</span></span><br></pre></td></tr></table></figure><h2 id="双层-for-循环，splice-去重（ES5）"><a href="#双层-for-循环，splice-去重（ES5）" class="headerlink" title="双层 for 循环，splice 去重（ES5）"></a>双层 for 循环，splice 去重（ES5）</h2><p>双层循环，外层循环元素，内层循环时比较值。值相同时，则删去这个值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = i + <span class="number">1</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[i] == arr[j]) &#123;</span><br><span class="line">        <span class="comment">//第一个等同于第二个，splice方法删除第二个</span></span><br><span class="line">        arr.splice(j, <span class="number">1</span>);</span><br><span class="line">        j--;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [</span><br><span class="line">  <span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,</span><br><span class="line">  <span class="string">&quot;true&quot;</span>,</span><br><span class="line">  <span class="string">&quot;true&quot;</span>,</span><br><span class="line">  <span class="literal">true</span>,</span><br><span class="line">  <span class="literal">true</span>,</span><br><span class="line">  <span class="number">15</span>,</span><br><span class="line">  <span class="number">15</span>,</span><br><span class="line">  <span class="literal">false</span>,</span><br><span class="line">  <span class="literal">false</span>,</span><br><span class="line">  <span class="literal">undefined</span>,</span><br><span class="line">  <span class="literal">undefined</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="literal">NaN</span>,</span><br><span class="line">  <span class="literal">NaN</span>,</span><br><span class="line">  <span class="string">&quot;NaN&quot;</span>,</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;a&quot;</span>,</span><br><span class="line">  <span class="string">&quot;a&quot;</span>,</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">];</span><br><span class="line"><span class="built_in">console</span>.log(unique(arr));</span><br><span class="line"><span class="comment">//[1, &quot;true&quot;, 15, false, undefined, NaN, NaN, &quot;NaN&quot;, &quot;a&quot;, &#123;…&#125;, &#123;…&#125;]     //NaN和&#123;&#125;没有去重，两个null直接消失了</span></span><br></pre></td></tr></table></figure><h2 id="递归去重"><a href="#递归去重" class="headerlink" title="递归去重"></a>递归去重</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> array = arr;</span><br><span class="line">  <span class="keyword">var</span> len = array.length;</span><br><span class="line">  array.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//排序后更加方便去重</span></span><br><span class="line">    <span class="keyword">return</span> a - b;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">loop</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (array[index] === array[index - <span class="number">1</span>]) &#123;</span><br><span class="line">        array.splice(index, <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      loop(index - <span class="number">1</span>); <span class="comment">//递归loop，然后数组去重</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  loop(len - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [</span><br><span class="line">  <span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,</span><br><span class="line">  <span class="string">&quot;true&quot;</span>,</span><br><span class="line">  <span class="string">&quot;true&quot;</span>,</span><br><span class="line">  <span class="literal">true</span>,</span><br><span class="line">  <span class="literal">true</span>,</span><br><span class="line">  <span class="number">15</span>,</span><br><span class="line">  <span class="number">15</span>,</span><br><span class="line">  <span class="literal">false</span>,</span><br><span class="line">  <span class="literal">false</span>,</span><br><span class="line">  <span class="literal">undefined</span>,</span><br><span class="line">  <span class="literal">undefined</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="literal">NaN</span>,</span><br><span class="line">  <span class="literal">NaN</span>,</span><br><span class="line">  <span class="string">&quot;NaN&quot;</span>,</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;a&quot;</span>,</span><br><span class="line">  <span class="string">&quot;a&quot;</span>,</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">];</span><br><span class="line"><span class="built_in">console</span>.log(unique(arr));</span><br><span class="line"><span class="comment">//[1, &quot;a&quot;, &quot;true&quot;, true, 15, false, 1, &#123;…&#125;, null, NaN, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;…&#125;, undefined]</span></span><br></pre></td></tr></table></figure><h2 id="根据数组中对象的某个属性值进行去重"><a href="#根据数组中对象的某个属性值进行去重" class="headerlink" title="根据数组中对象的某个属性值进行去重"></a>根据数组中对象的某个属性值进行去重</h2><blockquote><p>Map + filter</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [&#123;<span class="attr">name</span>:<span class="string">&#x27;张三&#x27;</span>，age:<span class="number">20</span>&#125;,&#123;<span class="attr">name</span>:<span class="string">&#x27;张三&#x27;</span>，age:<span class="number">22</span>&#125;,&#123;<span class="attr">name</span>:<span class="string">&#x27;李四&#x27;</span>，age:<span class="number">24</span>&#125;]</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">  <span class="keyword">return</span> arr.filter(<span class="function">(<span class="params">a</span>) =&gt;</span> !res.has(a.name) &amp;&amp; res.set(a.name, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">unique(arr)    <span class="comment">// [&#123;name:&#x27;张三&#x27;，age:20&#125;,&#123;name:&#x27;李四&#x27;，age:24&#125;]</span></span><br></pre></td></tr></table></figure><ul><li>更多实现方式：<a href="https://blog.csdn.net/JxufeCarol/article/details/117766099">js 数组对象根据对象中的指定属性去重</a></li></ul><hr>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6-ES12 特性</title>
      <link href="eya8ra/"/>
      <url>eya8ra/</url>
      
        <content type="html"><![CDATA[<p>本文集合了 ES6 至 ES11 常用到的特性，包括还在规划的 ES12。</p><h2 id="ES6（2015）"><a href="#ES6（2015）" class="headerlink" title="ES6（2015）"></a>ES6（2015）</h2><h3 id="类（class）"><a href="#类（class）" class="headerlink" title="类（class）"></a>类（class）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&quot;a&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">console</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> people = <span class="keyword">new</span> People(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">people.console(); <span class="comment">// a</span></span><br></pre></td></tr></table></figure><h3 id="模块化（ES-Module）"><a href="#模块化（ES-Module）" class="headerlink" title="模块化（ES Module）"></a>模块化（ES Module）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A.js 导出一个方法</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> addNum = <span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b;</span><br><span class="line"></span><br><span class="line"><span class="comment">// B.js 导入并使用</span></span><br><span class="line"><span class="keyword">import</span> &#123; addNum &#125; <span class="keyword">from</span> <span class="string">&quot;./A.js&quot;</span>;</span><br><span class="line">addNum(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> addNum = <span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b;</span><br><span class="line">addNum(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><h3 id="函数参数默认值"><a href="#函数参数默认值" class="headerlink" title="函数参数默认值"></a>函数参数默认值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">val = <span class="number">10</span>,list= []</span>)</span>&#123;...&#125;</span><br></pre></td></tr></table></figure><h3 id="字符串模板"><a href="#字符串模板" class="headerlink" title="字符串模板"></a>字符串模板</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&quot;张三&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> text = <span class="string">`this is <span class="subst">$&#123;name&#125;</span>`</span>;</span><br></pre></td></tr></table></figure><h3 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">22</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> &#123; name, age &#125; = obj; <span class="comment">// &quot;张三&quot;  22</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>,</span><br><span class="line">  b = <span class="number">2</span>;</span><br><span class="line">[a, b] = [b, a]; <span class="comment">// a 2    b 1</span></span><br></pre></td></tr></table></figure><h3 id="展开运算符"><a href="#展开运算符" class="headerlink" title="展开运算符"></a>展开运算符</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = [...<span class="string">&quot;hello&quot;</span>]; <span class="comment">// [&#x27;h&#x27;,&#x27;e&#x27;,&#x27;l&#x27;,&#x27;l&#x27;,&#x27;o&#x27;]</span></span><br></pre></td></tr></table></figure><h3 id="对象属性简写"><a href="#对象属性简写" class="headerlink" title="对象属性简写"></a>对象属性简写</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  age = <span class="number">22</span>;</span><br><span class="line"><span class="keyword">const</span> obj = &#123; name, age &#125;; <span class="comment">// 张三 22  等同于const obj = &#123;name:name,age:age&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// 先打印 1 ，再打印 2</span></span><br></pre></td></tr></table></figure><h3 id="let-const"><a href="#let-const" class="headerlink" title="let/const"></a>let/const</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> b = &#123;&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="ES7（2016）"><a href="#ES7（2016）" class="headerlink" title="ES7（2016）"></a>ES7（2016）</h2><h3 id="Array-prototype-includes"><a href="#Array-prototype-includes" class="headerlink" title="Array.prototype.includes()"></a>Array.prototype.includes()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3 id="指数操作符"><a href="#指数操作符" class="headerlink" title="指数操作符"></a>指数操作符</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> ** <span class="number">10</span>; <span class="comment">// 1024</span></span><br></pre></td></tr></table></figure><hr><h2 id="ES8-（2017）"><a href="#ES8-（2017）" class="headerlink" title="ES8 （2017）"></a>ES8 （2017）</h2><h3 id="async-await"><a href="#async-await" class="headerlink" title="async/await"></a>async/await</h3><blockquote><p>异步解决方案</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">Async</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Object-values"><a href="#Object-values" class="headerlink" title="Object.values()"></a>Object.values()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.values(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;); <span class="comment">// [1,2,3]</span></span><br></pre></td></tr></table></figure><h3 id="Object-entries"><a href="#Object-entries" class="headerlink" title="Object.entries()"></a>Object.entries()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.entries(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;); <span class="comment">// [[&quot;a&quot;, 1], [&quot;b&quot;, 2], [&quot;c&quot;, 3]]</span></span><br></pre></td></tr></table></figure><h3 id="String-padding"><a href="#String-padding" class="headerlink" title="String padding"></a>String padding</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// padStart</span></span><br><span class="line"><span class="string">&quot;hello&quot;</span>.padStart(<span class="number">10</span>); <span class="comment">// &quot;     hello&quot;</span></span><br><span class="line"><span class="comment">// padEnd</span></span><br><span class="line"><span class="string">&quot;hello&quot;</span>.padEnd(<span class="number">10</span>); <span class="comment">//&quot;hello     &quot;</span></span><br></pre></td></tr></table></figure><h3 id="Object-getOwnPropertyDescriptors"><a href="#Object-getOwnPropertyDescriptors" class="headerlink" title="Object.getOwnPropertyDescriptors()"></a>Object.getOwnPropertyDescriptors()</h3><blockquote><p>获取一个对象的所有自身属性的描述符,如果没有任何自身属性，则返回空对象。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span>, <span class="attr">age</span>: <span class="number">22</span>, <span class="attr">todo</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125; &#125;;</span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptors(obj);</span><br><span class="line"><span class="comment">//age: &#123;value: 22, writable: true, enumerable: true, configurable: true&#125;</span></span><br><span class="line"><span class="comment">//name: &#123;value: &quot;张三&quot;, writable: true, enumerable: true, configurable: true&#125;</span></span><br><span class="line"><span class="comment">//todo: &#123;writable: true, enumerable: true, configurable: true, value: ƒ&#125;</span></span><br><span class="line"><span class="comment">//__proto__: Object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptors(obj1); <span class="comment">// &#123;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="SharedArrayBuffer-对象"><a href="#SharedArrayBuffer-对象" class="headerlink" title="SharedArrayBuffer 对象"></a>SharedArrayBuffer 对象</h3><blockquote><p>SharedArrayBuffer 对象用来表示一个通用的，固定长度的原始二进制数据缓冲区</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>length 所创建的数组缓冲区的大小，以字节(byte)为单位。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;SharedArrayBuffer&#125;</span> </span>一个大小指定的新 SharedArrayBuffer 对象。其内容被初始化为 0。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">new</span> SharedArrayBuffer(<span class="number">10</span>);</span><br></pre></td></tr></table></figure><hr><h2 id="ES9（2018）"><a href="#ES9（2018）" class="headerlink" title="ES9（2018）"></a>ES9（2018）</h2><h3 id="异步迭代"><a href="#异步迭代" class="headerlink" title="异步迭代"></a>异步迭代</h3><blockquote><p>await 可以和 for…of 循环一起使用，以串行的方式运行异步操作</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">proess</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">let</span> i <span class="keyword">of</span> array) &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Promise-finally"><a href="#Promise-finally" class="headerlink" title="Promise.finally()"></a>Promise.finally()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve()</span><br><span class="line">  .then()</span><br><span class="line">  .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> e)</span><br><span class="line">  .finally();</span><br></pre></td></tr></table></figure><h3 id="正则表达式命名捕获组"><a href="#正则表达式命名捕获组" class="headerlink" title="正则表达式命名捕获组"></a>正则表达式命名捕获组</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reg = <span class="regexp">/(?&lt;year&gt;[0-9]&#123;4&#125;)-(?&lt;month&gt;[0-9]&#123;2&#125;)-(?&lt;day&gt;[0-9]&#123;2&#125;)/</span>;</span><br><span class="line"><span class="keyword">const</span> match = reg.exec(<span class="string">&quot;2021-05-31&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/exec.png"></p><h3 id="正则表达式-dotAll-模式"><a href="#正则表达式-dotAll-模式" class="headerlink" title="正则表达式 dotAll 模式"></a>正则表达式 dotAll 模式</h3><blockquote><p>正则表达式中点.匹配除回车外的任何单字符，标记 s 改变这种行为，允许行终止符的出现</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/hello.world/.test(<span class="string">&quot;hello\nworld&quot;</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><hr><h2 id="ES10（2019）"><a href="#ES10（2019）" class="headerlink" title="ES10（2019）"></a>ES10（2019）</h2><h3 id="Array-flat-Array-flatMap"><a href="#Array-flat-Array-flatMap" class="headerlink" title="Array.flat()/Array.flatMap()"></a>Array.flat()/Array.flatMap()</h3><ul><li>flat()</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]].flat(<span class="literal">Infinity</span>); <span class="comment">// [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure><ul><li>flatMap()</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>].flatMap(<span class="function">(<span class="params">a</span>) =&gt;</span> [a ** <span class="number">2</span>]); <span class="comment">// [1, 4, 9, 16]</span></span><br></pre></td></tr></table></figure><h3 id="String-trimStart-String-trimEnd"><a href="#String-trimStart-String-trimEnd" class="headerlink" title="String.trimStart()/String.trimEnd()"></a>String.trimStart()/String.trimEnd()</h3><blockquote><p>去除字符串首尾空白字符</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// trimStart()</span></span><br><span class="line"><span class="string">&quot;   hello&quot;</span>.trimStart(); <span class="comment">// &quot;hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//trimEnd()</span></span><br><span class="line"><span class="string">&quot;hello   &quot;</span>.trimEnd(); <span class="comment">// &quot;hello&quot;</span></span><br></pre></td></tr></table></figure><h3 id="String-prototype-matchAll"><a href="#String-prototype-matchAll" class="headerlink" title="String.prototype.matchAll"></a>String.prototype.matchAll</h3><blockquote><p>matchAll()为所有匹配的匹配对象返回一个迭代器</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> raw_arr = <span class="string">&quot;test1  test2  test3&quot;</span>.matchAll(<span class="regexp">/t(e)(st(\d?))/g</span>);</span><br><span class="line"><span class="keyword">const</span> arr = [...raw_arr];</span><br></pre></td></tr></table></figure><h3 id="Symbol-prototype-description"><a href="#Symbol-prototype-description" class="headerlink" title="Symbol.prototype.description"></a>Symbol.prototype.description</h3><blockquote><p>只读属性，返回 Symbol 对象的可选描述的字符串。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Symbol</span>(<span class="string">&quot;hello&quot;</span>).description; <span class="comment">// &quot;hello&quot;</span></span><br></pre></td></tr></table></figure><h3 id="Object-fromEntries"><a href="#Object-fromEntries" class="headerlink" title="Object.fromEntries()"></a>Object.fromEntries()</h3><blockquote><p>返回一个给定对象自身可枚举属性的键值对数组</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过 Object.fromEntries， 可以将 Map 转化为 Object:</span></span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">  [<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>],</span><br><span class="line">  [<span class="string">&quot;baz&quot;</span>, <span class="number">42</span>],</span><br><span class="line">]);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.fromEntries(map)); <span class="comment">// &#123; foo: &quot;bar&quot;, baz: 42 &#125;</span></span><br></pre></td></tr></table></figure><hr><h2 id="ES11（2020）"><a href="#ES11（2020）" class="headerlink" title="ES11（2020）"></a>ES11（2020）</h2><h3 id="Nullish-coalescing-Operator-空值处理"><a href="#Nullish-coalescing-Operator-空值处理" class="headerlink" title="Nullish coalescing Operator(空值处理)"></a>Nullish coalescing Operator(空值处理)</h3><blockquote><p>表达式在 ?? 的左侧运算符求值为 undefined 或 null，返回其右侧。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> user = &#123;</span><br><span class="line">  u1: <span class="number">0</span>,</span><br><span class="line">  u2: <span class="literal">false</span>,</span><br><span class="line">  u3: <span class="literal">null</span>,</span><br><span class="line">  u4: <span class="literal">undefined</span>,</span><br><span class="line">  u5: <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> u2 = user.u2 ?? <span class="string">&quot;用户2&quot;</span>; <span class="comment">// false</span></span><br><span class="line"><span class="keyword">let</span> u3 = user.u3 ?? <span class="string">&quot;用户3&quot;</span>; <span class="comment">// 用户3</span></span><br><span class="line"><span class="keyword">let</span> u4 = user.u4 ?? <span class="string">&quot;用户4&quot;</span>; <span class="comment">// 用户4</span></span><br><span class="line"><span class="keyword">let</span> u5 = user.u5 ?? <span class="string">&quot;用户5&quot;</span>; <span class="comment">// &#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="Optional-chaining（可选链）"><a href="#Optional-chaining（可选链）" class="headerlink" title="Optional chaining（可选链）"></a>Optional chaining（可选链）</h3><blockquote><p>?.用户检测不确定的中间节点</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> u1 = user.childer.name; <span class="comment">// TypeError: Cannot read property &#x27;name&#x27; of undefined</span></span><br><span class="line"><span class="keyword">let</span> u1 = user.childer?.name; <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><h3 id="Promise-allSettled"><a href="#Promise-allSettled" class="headerlink" title="Promise.allSettled"></a>Promise.allSettled</h3><blockquote><p>返回一个在所有给定的 promise 已被决议或被拒绝后决议的 promise，并带有一个对象数组，每个对象表示对应的 promise 结果</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise1 = <span class="built_in">Promise</span>.resolve(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">const</span> promise2 = <span class="number">4</span>;</span><br><span class="line"><span class="keyword">const</span> promise3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span></span><br><span class="line">  reject(<span class="string">&quot;我是失败的Promise_1&quot;</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> promise4 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span></span><br><span class="line">  reject(<span class="string">&quot;我是失败的Promise_2&quot;</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> promiseList = [promise1, promise2, promise3, promise4];</span><br><span class="line"><span class="built_in">Promise</span>.allSettled(promiseList).then(<span class="function">(<span class="params">values</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(values);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.nlark.com/yuque/0/2021/png/13014187/1626774777942-7184998d-822e-4c4f-a41a-cbf1f6df1b1e.png#id=AM8Iw&originHeight=935&originWidth=1388&originalType=binary&ratio=1&status=done&style=none"></p><h3 id="import"><a href="#import" class="headerlink" title="import()"></a>import()</h3><blockquote><p>按需导入</p></blockquote><h3 id="新基本数据类型-BigInt"><a href="#新基本数据类型-BigInt" class="headerlink" title="新基本数据类型 BigInt"></a>新基本数据类型 BigInt</h3><blockquote><p>任意精度的整数</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BigInt</span>(<span class="number">12</span>); <span class="comment">// 12n</span></span><br></pre></td></tr></table></figure><h3 id="globalThis"><a href="#globalThis" class="headerlink" title="globalThis"></a>globalThis</h3><ul><li>浏览器：window</li><li>worker：self</li><li>node：global</li></ul><hr><h2 id="ES12（2021）"><a href="#ES12（2021）" class="headerlink" title="ES12（2021）"></a>ES12（2021）</h2><h3 id="replaceAll"><a href="#replaceAll" class="headerlink" title="replaceAll"></a>replaceAll</h3><blockquote><p>返回一个全新的字符串，所有符合匹配规则的字符都将被替换掉</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">str.replaceAll(<span class="string">&quot;l&quot;</span>, <span class="string">&quot;&quot;</span>); <span class="comment">// &quot;heo word&quot;</span></span><br></pre></td></tr></table></figure><h3 id="Promise-any"><a href="#Promise-any" class="headerlink" title="Promise.any"></a>Promise.any</h3><blockquote><p>Promise.any() 接收一个 Promise 可迭代对象，只要其中的一个 promise 成功，就返回那个已经成功的 promise 。如果可迭代对象中没有一个 promise 成功（即所有的 promises 都失败/拒绝），就返回一个失败的 promise</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span></span><br><span class="line">  reject(<span class="string">&quot;我是失败的Promise_1&quot;</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> promise2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span></span><br><span class="line">  reject(<span class="string">&quot;我是失败的Promise_2&quot;</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> promiseList = [promise1, promise2];</span><br><span class="line"><span class="built_in">Promise</span>.any(promiseList)</span><br><span class="line">  .then(<span class="function">(<span class="params">values</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(values);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise &#123;&lt;fulfilled&gt;: undefined&#125;</span></span><br><span class="line"><span class="comment">// __proto__: Promise</span></span><br><span class="line"><span class="comment">// [[PromiseState]]: &quot;fulfilled&quot;</span></span><br><span class="line"><span class="comment">// [[PromiseResult]]: undefined</span></span><br></pre></td></tr></table></figure><h3 id="逻辑运算符和赋值表达式"><a href="#逻辑运算符和赋值表达式" class="headerlink" title="逻辑运算符和赋值表达式"></a>逻辑运算符和赋值表达式</h3><blockquote><p>逻辑运算符和赋值表达式，新特性结合了逻辑运算符（&amp;&amp;，||，??）和赋值表达式而 JavaScript 已存在的 复合赋值运算符有：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a ||= b;</span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line">a = a || (a = b);</span><br><span class="line"></span><br><span class="line">a &amp;&amp;= b;</span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line">a = a &amp;&amp; (a = b);</span><br><span class="line"></span><br><span class="line">a ??= b;</span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line">a = a ?? (a = b);</span><br></pre></td></tr></table></figure><h3 id="数字分隔符"><a href="#数字分隔符" class="headerlink" title="数字分隔符"></a>数字分隔符</h3><blockquote><p>数字分隔符，可以在数字之间创建可视化分隔符，通过_下划线来分割数字，使数字更具可读性</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> money = <span class="number">1_000_000_000</span>;</span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line"><span class="keyword">const</span> money = <span class="number">1000000000</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">1_000_000_000</span> === <span class="number">1000000000</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ES6 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>js笛卡尔积算法</title>
      <link href="Cartesian-product/"/>
      <url>Cartesian-product/</url>
      
        <content type="html"><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><blockquote><p>在数学中的解释是，两个集合X和Y的<a href="https://baike.baidu.com/item/%E7%AC%9B%E5%8D%A1%E5%B0%94%E4%B9%98%E7%A7%AF/6323173?fromtitle=%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF&fromid=1434391&fr=aladdin">笛卡尓积（Cartesian product）</a>，又称直积，表示为X × Y，第一个对象是X的成员而第二个对象是Y的所有可能有序对的其中一个成员。</p></blockquote><p>假设集合A={a, b}，集合B={0, 1, 2}，则两个集合的笛卡尔积为{(a, 0), (a, 1), (a, 2), (b, 0), (b, 1), (b, 2)}。</p><div class="tip cogs"><p>简单来说就是多组数据的排列组合</p></div><hr><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><ol><li>在电商项目中，常用于商品SKU的订单组合；根据商品的子类型和不同颜色尺寸生成n种可能的组合</li><li>MySql的多表查询</li><li>生成坐标<br>…….</li></ol><hr><h2 id="js代码"><a href="#js代码" class="headerlink" title="js代码"></a>js代码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cartesianProduct</span> (<span class="params">array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (array.length &lt; <span class="number">2</span>) <span class="keyword">return</span> array[<span class="number">0</span>] || [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [].reduce.call(array, <span class="function"><span class="keyword">function</span> (<span class="params">col, set</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> res = [];</span><br><span class="line"></span><br><span class="line">        col.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">c</span>) </span>&#123;</span><br><span class="line">            set.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> t = [].concat(<span class="built_in">Array</span>.isArray(c) ? c : [c]);</span><br><span class="line">                t.push(s);</span><br><span class="line">                res.push(t);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cartesianProduct ([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>],[<span class="string">&quot;张三&quot;</span>,<span class="string">&quot;李四&quot;</span>,<span class="string">&quot;王五&quot;</span>]]) </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>得到的结果：<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/1629962811000.png"></p><hr><h2 id="其它实现方法"><a href="#其它实现方法" class="headerlink" title="其它实现方法"></a>其它实现方法</h2><div class="btns rounded grid5">            <a class="button" href='https://blog.csdn.net/h785160953/article/details/104418306?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-4.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-4.control' title='笛卡尔积实现-JavaScript版'><i class='fas fa-book-open'></i>笛卡尔积实现-JavaScript版</a><a class="button" href='https://www.cnblogs.com/52fhy/p/5823934.html' title='飞鸿影的博客-笛卡尔积'><i class='fas fa-book-open'></i>飞鸿影的博客-笛卡尔积</a>          </div><hr>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chrome Extension（扩展程序）开发</title>
      <link href="lomf3x/"/>
      <url>lomf3x/</url>
      
        <content type="html"><![CDATA[<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><h3 id="chrome-扩展是什么？"><a href="#chrome-扩展是什么？" class="headerlink" title="chrome 扩展是什么？"></a>chrome 扩展是什么？</h3><p>一个应用（扩展）其实是压缩（.crx 后缀）在一起的一组文件，包括 HTML，CSS，Javascript 脚本，图片文件，还有其它任何需要的文件。 应用（扩展）本质上来说就是 web 页面，它们可以使用所有的浏览器提供的 API，从 XMLHttpRequest 到 JSON 到 HTML5 全都有。</p><p>应用（扩展）可以与 Web 页面交互，或者通过 content script 或 cross-origin XMLHttpRequests 与服务器交互。应用（扩展）还可以访问浏览器提供的内部功能，例如标签或书签等。</p><h3 id="chrome-扩展用处"><a href="#chrome-扩展用处" class="headerlink" title="chrome 扩展用处"></a>chrome 扩展用处</h3><p>增强浏览器的功能，可以向页面注入 js 脚本作一些操作，实现属于自己的“定制版”浏览器。<br>提供了很多 API 供我们来使用：</p><ul><li><a href="http://open.chrome.360.cn/extension_dev/tabs.html">标签</a></li><li><a href="http://open.chrome.360.cn/extension_dev/bookmarks.html">书签</a></li><li><a href="http://open.chrome.360.cn/extension_dev/cookies.html">Cookies</a></li><li><a href="http://open.chrome.360.cn/extension_dev/evnets.html">Events</a></li><li><a href="http://open.chrome.360.cn/extension_dev/devtools.html">开发者工具</a></li><li><a href="http://open.chrome.360.cn/extension_dev/history.html">历史记录</a></li><li><a href="http://open.chrome.360.cn/extension_dev/management.html">插件管理</a></li><li><a href="http://open.chrome.360.cn/extension_dev/windows.html">视窗</a><br>等等…</li></ul><hr><h2 id="开发与调试"><a href="#开发与调试" class="headerlink" title="开发与调试"></a>开发与调试</h2><p>Chrome 插件没有严格的项目结构要求，只要保证本目录有一个 manifest.json 即可，也不需要专门的 IDE，普通的 web 开发工具即可。<br>从右上角菜单-&gt;更多工具-&gt;扩展程序可以进入插件管理页面，也可以直接在地址栏输入 chrome://extensions 访问。</p><div class="note info modern"><p>勾选开发者模式即可以文件夹的形式直接加载插件，否则只能安装.crx 格式的文件。Chrome 要求插件必须从它的 Chrome 应用商店安装，其它任何网站下载的都无法直接安装，所以，其实我们可以把 crx 文件解压，然后通过开发者模式直接加载。</p><p>开发中，代码有任何改动都必须重新加载插件，只需要在插件管理页按下 Ctrl+R 即可，以防万一最好还把页面刷新一下。</p></div><h3 id="核心结构"><a href="#核心结构" class="headerlink" title="核心结构"></a>核心结构</h3><div class="tabs" id="核心结构"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#核心结构-1">manifest.json</button></li><li class="tab"><button type="button" data-href="#核心结构-2">content-scripts</button></li><li class="tab"><button type="button" data-href="#核心结构-3">backgroud</button></li><li class="tab"><button type="button" data-href="#核心结构-4">popup</button></li><li class="tab"><button type="button" data-href="#核心结构-5">inject-script</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="核心结构-1"><p>这是一个 Chrome 插件最重要也是必不可少的文件，用来配置所有和插件相关的配置，必须放在根目录。<br>字段说明：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;manifest_version&quot;</span>: <span class="number">2</span>, <span class="comment">// 清单文件的版本，这个必须写，而且必须是2</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;demo&quot;</span>, <span class="comment">// 插件的名称</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>, <span class="comment">// 插件的版本</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Chrome扩展demo&quot;</span>, <span class="comment">// 插件描述</span></span><br><span class="line">  <span class="comment">// 图标，一般偷懒全部用一个尺寸的也没问题</span></span><br><span class="line">  <span class="attr">&quot;icons&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;16&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;48&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;128&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 会一直常驻的后台JS或后台页面</span></span><br><span class="line">  <span class="attr">&quot;background&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// 2种指定方式，如果指定JS，那么会自动生成一个背景页</span></span><br><span class="line">    <span class="attr">&quot;page&quot;</span>: <span class="string">&quot;background.html&quot;</span> <span class="comment">//&quot;scripts&quot;: [&quot;js/background.js&quot;]</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 浏览器右上角图标设置，browser_action、page_action、app必须三选一</span></span><br><span class="line">  <span class="attr">&quot;browser_action&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;default_icon&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;default_title&quot;</span>: <span class="string">&quot;这是一个Chrome插件&quot;</span>, <span class="comment">// 图标悬停时的标题，可选</span></span><br><span class="line">    <span class="attr">&quot;default_popup&quot;</span>: <span class="string">&quot;popup.html&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/*&quot;page_action&quot;: </span></span><br><span class="line"><span class="comment"> &#123;</span></span><br><span class="line"><span class="comment">  &quot;default_icon&quot;: &quot;img/icon.png&quot;, // 当某些特定页面打开才显示的图标</span></span><br><span class="line"><span class="comment">  &quot;default_title&quot;: &quot;我是pageAction&quot;,</span></span><br><span class="line"><span class="comment">  &quot;default_popup&quot;: &quot;popup.html&quot;</span></span><br><span class="line"><span class="comment"> &#125;,*/</span> <span class="comment">// 需要直接注入页面的JS</span></span><br><span class="line">  <span class="attr">&quot;content_scripts&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//&quot;matches&quot;: [&quot;http://*/*&quot;, &quot;https://*/*&quot;],</span></span><br><span class="line">      <span class="comment">// &quot;&lt;all_urls&gt;&quot; 表示匹配所有地址</span></span><br><span class="line">      <span class="attr">&quot;matches&quot;</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>], <span class="comment">// 多个JS按顺序注入</span></span><br><span class="line">      <span class="attr">&quot;js&quot;</span>: [<span class="string">&quot;js/jquery-1.8.3.js&quot;</span>, <span class="string">&quot;js/content-script.js&quot;</span>], <span class="comment">// JS的注入可以随便一点，但是CSS的注意就要千万小心了，因为一不小心就可能影响全局样式</span></span><br><span class="line">      <span class="attr">&quot;css&quot;</span>: [<span class="string">&quot;css/custom.css&quot;</span>], <span class="comment">// 代码注入的时间，可选值： &quot;document_start&quot;, &quot;document_end&quot;, or &quot;document_idle&quot;，最后一个表示页面空闲时，默认document_idle</span></span><br><span class="line">      <span class="attr">&quot;run_at&quot;</span>: <span class="string">&quot;document_start&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 这里仅仅是为了演示content-script可以配置多个规则</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;matches&quot;</span>: [<span class="string">&quot;*://*/*.png&quot;</span>, <span class="string">&quot;*://*/*.jpg&quot;</span>, <span class="string">&quot;*://*/*.gif&quot;</span>, <span class="string">&quot;*://*/*.bmp&quot;</span>],</span><br><span class="line">      <span class="attr">&quot;js&quot;</span>: [<span class="string">&quot;js/show-image-content-size.js&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 权限申请</span></span><br><span class="line">  <span class="attr">&quot;permissions&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;contextMenus&quot;</span>, <span class="comment">// 右键菜单</span></span><br><span class="line">    <span class="string">&quot;tabs&quot;</span>, <span class="comment">// 标签</span></span><br><span class="line">    <span class="string">&quot;notifications&quot;</span>, <span class="comment">// 通知</span></span><br><span class="line">    <span class="string">&quot;webRequest&quot;</span>, <span class="comment">// web请求</span></span><br><span class="line">    <span class="string">&quot;webRequestBlocking&quot;</span>,</span><br><span class="line">    <span class="string">&quot;storage&quot;</span>, <span class="comment">// 插件本地存储</span></span><br><span class="line">    <span class="string">&quot;http://*/*&quot;</span>, <span class="comment">// 可以通过executeScript或者insertCSS访问的网站</span></span><br><span class="line">    <span class="string">&quot;https://*/*&quot;</span> <span class="comment">// 可以通过executeScript或者insertCSS访问的网站</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的</span></span><br><span class="line">  <span class="attr">&quot;web_accessible_resources&quot;</span>: [<span class="string">&quot;js/inject.js&quot;</span>], <span class="comment">// 插件主页，这个很重要，不要浪费了这个免费广告位</span></span><br><span class="line">  <span class="attr">&quot;homepage_url&quot;</span>: <span class="string">&quot;https://www.baidu.com&quot;</span>, <span class="comment">// 覆盖浏览器默认页面</span></span><br><span class="line">  <span class="attr">&quot;chrome_url_overrides&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// 覆盖浏览器默认的新标签页</span></span><br><span class="line">    <span class="attr">&quot;newtab&quot;</span>: <span class="string">&quot;newtab.html&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// Chrome40以前的插件配置页写法</span></span><br><span class="line">  <span class="attr">&quot;options_page&quot;</span>: <span class="string">&quot;options.html&quot;</span>,</span><br><span class="line">  <span class="comment">// Chrome40以后的插件配置页写法，如果2个都写，新版Chrome只认后面这一个</span></span><br><span class="line">  <span class="attr">&quot;options_ui&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;page&quot;</span>: <span class="string">&quot;options.html&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;chrome_style&quot;</span>: <span class="literal">true</span> <span class="comment">// 添加一些默认的样式，推荐使用</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;omnibox&quot;</span>: &#123; <span class="attr">&quot;keyword&quot;</span>: <span class="string">&quot;go&quot;</span> &#125;, <span class="comment">// 向地址栏注册一个关键字以提供搜索建议，只能设置一个关键字</span></span><br><span class="line">  <span class="attr">&quot;default_locale&quot;</span>: <span class="string">&quot;zh_CN&quot;</span>, <span class="comment">// 默认语言</span></span><br><span class="line">  <span class="comment">// devtools页面入口，注意只能指向一个HTML文件，不能是JS文件</span></span><br><span class="line">  <span class="attr">&quot;devtools_page&quot;</span>: <span class="string">&quot;devtools.html&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="核心结构-2"><p>content-scripts，是 Chrome 插件中向页面注入脚本的一种形式（虽然名为 script，其实还可以包括 css 的），借助 content-scripts 我们可以实现通过配置的方式轻松向指定页面注入 JS 和 CSS，最常见的比如：广告屏蔽、页面 CSS 定制，等等。</p><p>配置 🌰：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 需要直接注入页面的JS</span></span><br><span class="line">  <span class="attr">&quot;content_scripts&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//&quot;matches&quot;: [&quot;http://*/*&quot;, &quot;https://*/*&quot;],</span></span><br><span class="line">      <span class="comment">// &quot;&lt;all_urls&gt;&quot; 表示匹配所有地址</span></span><br><span class="line">      <span class="attr">&quot;matches&quot;</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>], <span class="comment">// 多个JS按顺序注入</span></span><br><span class="line">      <span class="attr">&quot;js&quot;</span>: [<span class="string">&quot;js/jquery-1.8.3.js&quot;</span>, <span class="string">&quot;js/content-script.js&quot;</span>], <span class="comment">// JS的注入可以随便一点，但是CSS的注意就要千万小心了，因为一不小心就可能影响全局样式</span></span><br><span class="line">      <span class="attr">&quot;css&quot;</span>: [<span class="string">&quot;css/custom.css&quot;</span>], <span class="comment">// 代码注入的时间，可选值： &quot;document_start&quot;, &quot;document_end&quot;, or &quot;document_idle&quot;，最后一个表示页面空闲时，默认document_idle</span></span><br><span class="line">      <span class="attr">&quot;run_at&quot;</span>: <span class="string">&quot;document_start&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>content-scripts 和原始页面共享 DOM，但是不共享 JS，如要访问页面 JS（例如某个 JS 变量），只能通过 injected js 来实现。content-scripts 不能访问绝大部分 chrome.xxx.api，除了下面这 4 种：</p><ul><li>chrome.extension(getURL , inIncognitoContext , lastError , onRequest , sendRequest)</li><li>chrome.i18n</li><li>chrome.runtime(connect , getManifest , getURL , id , onConnect , onMessage , sendMessage)</li><li>chrome.storage</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="核心结构-3"><p>背景页，是一个常驻的页面，它的生命周期是插件中所有类型页面中最长的，它随着浏览器的打开而打开，随着浏览器的关闭而关闭，所以通常把需要一直运行的、启动就运行的、全局的代码放在 background 里面。</p><blockquote><p>background 的权限非常高，几乎可以调用所有的 Chrome 扩展 API（除了 devtools），而且它可以无限制跨域，也就是可以跨域访问任何网站而无需要求对方设置 CORS。不止是 background，所有的直接通过 chrome-extension://id/xx.html 这种方式打开的网页都可以无限制跨域。</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 会一直常驻的后台JS或后台页面</span></span><br><span class="line">  <span class="attr">&quot;background&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// 2种指定方式，如果指定JS，那么会自动生成一个背景页</span></span><br><span class="line">    <span class="attr">&quot;page&quot;</span>: <span class="string">&quot;background.html&quot;</span> <span class="comment">//&quot;scripts&quot;: [&quot;js/background.js&quot;]</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note info modern"><p>需要特别说明的是，虽然可以通过 chrome-extension://xxx/background.html 直接打开后台页，但是打开的后台页和真正一直在后台运行的那个页面不是同一个，换句话说，可以打开无数个 background.html，但是真正在后台常驻的只有一个，而且永远看不到它的界面，只能调试它的代码。</p></div><ul><li>event-pages<br>鉴于 background 生命周期太长，长时间挂载后台可能会影响性能，所以 Google 又弄一个 event-pages，在配置文件上，它与 background 的唯一区别就是多了一个 persistent 参数。</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;background&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span>: [<span class="string">&quot;event-page.js&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;persistent&quot;</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>它的生命周期是：在被需要时加载，在空闲时被关闭，什么叫被需要时呢？比如第一次安装、插件更新、有 content-script 向它发送消息，等等。<br>除了配置文件的变化，代码上也有一些细微变化，这个简单了解一下就行了，一般情况下 background 也不会很消耗性能的。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="核心结构-4"><p>popup 是点击 browser_action 或者 page_action 图标时打开的一个小窗口网页，焦点离开网页就立即关闭，一般用来做一些临时性的交互。</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/popup.png"></p><p>popup 可以包含任意你想要的 HTML 内容，并且会自适应大小。可以通过 default_popup 字段来指定 popup 页面，也可以调用 setPopup()方法。<br>配置 🌰：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;browser_action&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;default_icon&quot;</span>: <span class="string">&quot;img/icon.png&quot;</span>, <span class="comment">// 图标悬停时的标题，可选</span></span><br><span class="line">    <span class="attr">&quot;default_title&quot;</span>: <span class="string">&quot;这是一个Chrome插件&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;default_popup&quot;</span>: <span class="string">&quot;popup.html&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note info modern"><p>需要特别注意的是，由于单击图标打开 popup，焦点离开又立即关闭，所以 popup 页面的生命周期一般很短，需要长时间运行的代码千万不要写在 popup 里面。</p><p>在权限上，它和 background 非常类似，它们之间最大的不同是生命周期的不同，popup 中可以直接通过 chrome.extension.getBackgroundPage()获取 background 的 window 对象。</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="核心结构-5"><p>这里的 inject-script 是我给它取的，指的是通过 DOM 操作的方式向页面注入的一种 JS。为什么要把这种 JS 单独拿出来讨论呢？又或者说为什么需要通过这种方式注入 JS 呢？<br>这是因为 content-script 有一个很大的“缺陷”，也就是无法访问页面中的 JS，虽然它可以操作 DOM，但是 DOM 却不能调用它，也就是无法在 DOM 中通过绑定事件的方式调用 content-script 中的代码（包括直接写 onclick 和 addEventListener 两种方式都不行），但是，“在页面上添加一个按钮并调用插件的扩展 API”是一个很常见的需求，那该怎么办呢？其实这就是本小节要讲的。</p><p>在 content-script 中通过 DOM 方式向页面注入 inject-script 代码示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向页面注入JS</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">injectCustomJs</span>(<span class="params">jsPath</span>) </span>&#123;</span><br><span class="line">  jsPath = jsPath || <span class="string">&quot;js/inject.js&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> temp = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">  temp.setAttribute(<span class="string">&quot;type&quot;</span>, <span class="string">&quot;text/javascript&quot;</span>); <span class="comment">// 获得的地址类似：chrome-extension://ihcokhadfjfchaeagdoclpnjdiokfakg/js/inject.js</span></span><br><span class="line">  temp.src = chrome.extension.getURL(jsPath);</span><br><span class="line">  temp.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 放在页面不好看，执行完后移除掉</span></span><br><span class="line">    <span class="built_in">this</span>.parentNode.removeChild(<span class="built_in">this</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="built_in">document</span>.head.appendChild(temp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 web 中直接访问插件中的资源的话必须显示声明才行，配置文件中增加如下</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 普通页面能够直接访问的插件资源列表，如果不设置是无法直接访问的</span></span><br><span class="line">  <span class="attr">&quot;web_accessible_resources&quot;</span>: [<span class="string">&quot;js/inject.js&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="展现形式"><a href="#展现形式" class="headerlink" title="展现形式"></a>展现形式</h3><div class="tabs" id="展现形式"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#展现形式-1">browserAction</button></li><li class="tab"><button type="button" data-href="#展现形式-2">pageAction</button></li><li class="tab"><button type="button" data-href="#展现形式-3">右键菜单</button></li><li class="tab"><button type="button" data-href="#展现形式-4">override</button></li><li class="tab"><button type="button" data-href="#展现形式-5">devtools</button></li><li class="tab"><button type="button" data-href="#展现形式-6">option</button></li><li class="tab"><button type="button" data-href="#展现形式-7">onmnibox</button></li><li class="tab"><button type="button" data-href="#展现形式-8">notification</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="展现形式-1"><p>通过配置 browser_action 可以在浏览器的右上角增加一个图标，一个 browser_action 可以拥有一个图标，一个 tooltip，一个 badge 和一个 popup。</p><ul><li>icon(图标)<br>browser_action 图标推荐使用宽高都为 19 像素的图片，更大的图标会被缩小，格式随意，一般推荐 png，可以通过 manifest 中 default_icon 字段配置，也可以调用 setIcon()方法。</li><li>tooltip<br>修改 browser_action 的 manifest 中 default_title 字段，或者调用 setTitle()方法。</li></ul><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/tooltip.png"></p><ul><li>badge<br>所谓 badge 就是在图标上显示一些文本，可以用来更新一些小的扩展状态提示信息。因为 badge 空间有限，所以只支持 4 个以下的字符（英文 4 个，中文 2 个）。badge 无法通过配置文件来指定，必须通过代码实现，设置 badge 文字和颜色可以分别使用 setBadgeText()和 setBadgeBackgroundColor()。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chrome.browserAction.setBadgeText(&#123; <span class="attr">text</span>: <span class="string">&quot;new&quot;</span> &#125;);</span><br><span class="line">chrome.browserAction.setBadgeBackgroundColor(&#123; <span class="attr">color</span>: [<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>] &#125;);</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/badge.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="展现形式-2"><p>所谓 pageAction，指的是只有当某些特定页面打开才显示的图标，它和 browserAction 最大的区别是一个始终都显示，一个只在特定情况才显示。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="展现形式-3"><p>通过开发 Chrome 插件可以自定义浏览器的右键菜单，主要是通过 chrome.contextMenusAPI 实现，右键菜单可以出现在不同的上下文，比如普通页面、选中的文字、图片、链接，等等，如果有同一个插件里面定义了多个菜单，Chrome 会自动组合放到以插件名字命名的二级菜单里，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// manifest.json</span></span><br><span class="line">&#123;<span class="string">&quot;permissions&quot;</span>: [<span class="string">&quot;contextMenus&quot;</span>]&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// background.js</span></span><br><span class="line">chrome.contextMenus.create(&#123;</span><br><span class="line"> title: <span class="string">&quot;测试右键菜单&quot;</span>,</span><br><span class="line"> onclick: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;alert(<span class="string">&#x27;您点击了右键菜单！&#x27;</span>);&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/click.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="展现形式-4"><p>使用 override 页可以将 Chrome 默认的一些特定页面替换掉，改为使用扩展提供的页面。<br>扩展可以替代如下页面：</p><ul><li>历史记录：从工具菜单上点击历史记录时访问的页面，或者从地址栏直接输入 chrome://history</li><li>新标签页：当创建新标签的时候访问的页面，或者从地址栏直接输入 chrome://newtab</li><li>书签：浏览器的书签，或者直接输入 chrome://bookmarks<div class="note warning modern"><p>  注意：</p><ul><li>一个扩展只能替代一个页面；</li><li>不能替代隐身窗口的新标签页；</li><li>网页必须设置 title，否则用户可能会看到网页的 URL，造成困扰；</li></ul></div></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;chrome_url_overrides&quot;:</span><br><span class="line">&#123;</span><br><span class="line"> <span class="attr">&quot;newtab&quot;</span>: <span class="string">&quot;newtab.html&quot;</span>,</span><br><span class="line"> <span class="attr">&quot;history&quot;</span>: <span class="string">&quot;history.html&quot;</span>,</span><br><span class="line"> <span class="attr">&quot;bookmarks&quot;</span>: <span class="string">&quot;bookmarks.html&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/override.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="展现形式-5"><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/vue.png"></p><p>Chrome 允许插件在开发者工具(devtools)上动手脚，主要表现在：</p><ul><li>自定义一个和多个和 Elements、Console、Sources 等同级别的面板；</li><li>自定义侧边栏(sidebar)，目前只能自定义 Elements 面板的侧边栏；</li><li>devtools 扩展介绍</li></ul><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/devtools.png"></p><ul><li>每打开一个开发者工具窗口，都会创建 devtools 页面的实例，F12 窗口关闭，页面也随着关闭，所以 devtools 页面的生命周期和 devtools 窗口是一致的。devtools 页面可以访问一组特有的 DevTools API 以及有限的扩展 API，这组特有的 DevTools API 只有 devtools 页面才可以访问，background 都无权访问，这些 API 包括：</li><li>chrome.devtools.panels：面板相关；</li><li>chrome.devtools.inspectedWindow：获取被审查窗口的有关信息；</li><li>chrome.devtools.network：获取有关网络请求的信息；<br>options 页，就是插件的设置页面，有 2 个入口，一个是右键图标有一个“选项”菜单，还有一个在插件管理页面：<blockquote><p>大部分扩展 API 都无法直接被 DevTools 页面调用，但它可以像 content-script 一样直接调用 chrome.extension 和 chrome.runtimeAPI，同时它也可以像 content-script 一样使用 Message 交互的方式与 background 页面进行通信。</p></blockquote></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="展现形式-6"><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;options_ui&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;page&quot;</span>: <span class="string">&quot;options.html&quot;</span>, <span class="comment">// 添加一些默认的样式，推荐使用</span></span><br><span class="line">    <span class="attr">&quot;chrome_style&quot;</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/option.png"></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/option1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="展现形式-7"><p>omnibox 是向用户提供搜索建议的一种方式。</p><blockquote><p>omnibox 应用程序界面允许向 Google Chrome 的地址栏注册一个关键字，地址栏也叫 omnibox。<br>当用户输入你的扩展关键字，用户开始与你的扩展交互。每个击键都会发送给你的扩展，扩展提供建议作为相应的响应。<br>建议可以被格式化多种方式。当用户接受建议，你的扩展被通知可以执行动作。</p></blockquote><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/go.gif"></p><blockquote><p>配置字段：</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 向地址栏注册一个关键字以提供搜索建议，只能设置一个关键字</span></span><br><span class="line">  <span class="attr">&quot;omnibox&quot;</span>: &#123; <span class="attr">&quot;keyword&quot;</span>: <span class="string">&quot;go&quot;</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 background.js 注册监听事件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">chrome.omnibox.onInputChanged.addListener(<span class="function">(<span class="params">text, suggest</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;inputChanged: &quot;</span> + text);</span><br><span class="line">  <span class="keyword">if</span> (!text) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span> (text == <span class="string">&quot;微博&quot;</span>) &#123;</span><br><span class="line">    suggest([</span><br><span class="line">      &#123; <span class="attr">content</span>: <span class="string">&quot;新浪&quot;</span> + text, <span class="attr">description</span>: <span class="string">&quot;新浪&quot;</span> + text &#125;,</span><br><span class="line">      &#123; <span class="attr">content</span>: <span class="string">&quot;腾讯&quot;</span> + text, <span class="attr">description</span>: <span class="string">&quot;腾讯&quot;</span> + text &#125;,</span><br><span class="line">      &#123; <span class="attr">content</span>: <span class="string">&quot;搜狐&quot;</span> + text, <span class="attr">description</span>: <span class="string">&quot;搜索&quot;</span> + text &#125;,</span><br><span class="line">    ]);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    suggest([</span><br><span class="line">      &#123; <span class="attr">content</span>: <span class="string">&quot;百度搜索 &quot;</span> + text, <span class="attr">description</span>: <span class="string">&quot;百度搜索 &quot;</span> + text &#125;,</span><br><span class="line">      &#123; <span class="attr">content</span>: <span class="string">&quot;谷歌搜索 &quot;</span> + text, <span class="attr">description</span>: <span class="string">&quot;谷歌搜索 &quot;</span> + text &#125;,</span><br><span class="line">    ]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当用户接收关键字建议时触发</span></span><br><span class="line">chrome.omnibox.onInputEntered.addListener(<span class="function">(<span class="params">text</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;inputEntered: &quot;</span> + text);</span><br><span class="line">  <span class="keyword">if</span> (!text) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">var</span> href = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span> (text.endsWith(<span class="string">&quot;微博&quot;</span>))</span><br><span class="line">    href =</span><br><span class="line">      <span class="string">&quot;http://image.baidu.com/search/index?tn=baiduimage&amp;ie=utf-8&amp;word=&quot;</span> + text;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (text.startsWith(<span class="string">&quot;百度搜索&quot;</span>))</span><br><span class="line">    href =</span><br><span class="line">      <span class="string">&quot;https://www.baidu.com/s?ie=UTF-8&amp;wd=&quot;</span> + text.replace(<span class="string">&quot;百度搜索 &quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (text.startsWith(<span class="string">&quot;谷歌搜索&quot;</span>))</span><br><span class="line">    href =</span><br><span class="line">      <span class="string">&quot;https://www.google.com.tw/search?q=&quot;</span> + text.replace(<span class="string">&quot;谷歌搜索 &quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span> href = <span class="string">&quot;https://www.baidu.com/s?ie=UTF-8&amp;wd=&quot;</span> + text;</span><br><span class="line">  openUrlCurrentTab(href);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 获取当前选项卡ID</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentTabId</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  chrome.tabs.query(&#123; <span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">currentWindow</span>: <span class="literal">true</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">tabs</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (callback) callback(tabs.length ? tabs[<span class="number">0</span>].id : <span class="literal">null</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当前标签打开某个链接</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openUrlCurrentTab</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  getCurrentTabId(<span class="function">(<span class="params">tabId</span>) =&gt;</span> &#123;</span><br><span class="line">    chrome.tabs.update(tabId, &#123; <span class="attr">url</span>: url &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="展现形式-8"><p>通知用户发生了一些重要的事情。桌面通知会显示在浏览器窗口之外。<br>Chrome 提供了一个 chrome.notificationsAPI 以便插件推送桌面通知，暂未找到 chrome.notifications 和 HTML5 自带的 Notification 的显著区别及优势。</p><p>在后台 JS 中，无论是使用 chrome.notifications 还是 Notification 都不需要申请权限（HTML5 方式需要申请权限），直接使用即可。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h2 id="五类-JS-文件区别"><a href="#五类-JS-文件区别" class="headerlink" title="五类 JS 文件区别"></a>五类 JS 文件区别</h2><table><thead><tr><th>js 类型</th><th>可访问的 API</th><th>DOM 访问情况</th><th>js 访问情况</th><th>跨域</th><th>调试方式</th></tr></thead><tbody><tr><td>content script</td><td>只能访问 extension、runtime 等部分 API</td><td>✔</td><td>×</td><td>×</td><td>打开 Console,如图切换<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/tiaoshi.png" alt="tiaoshi.png"></td></tr><tr><td>popup js</td><td>可访问绝大部分 API，除了 devtools 系列</td><td>不可以直接访问</td><td>×</td><td>✔</td><td>popup 页面右键选择“审查弹出内容”</td></tr><tr><td>background js</td><td>可访问绝大部分 API，除了 devtools 系列</td><td>不可以直接访问</td><td>×</td><td>✔</td><td>插件管理页面点击背景页<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/background.png" alt="background.png"></td></tr><tr><td>devtools js</td><td>只能访问 devtools、extension、runtime 等部分 API</td><td>✔</td><td>✔</td><td>×</td><td>暂时没有找到有效的调试方法</td></tr><tr><td>injected script</td><td>和普通 JS 无任何差别，不能访问任何扩展 API</td><td>✔</td><td>✔</td><td>×</td><td>直接普通的 F12 即可</td></tr></tbody></table><hr><h2 id="消息通信"><a href="#消息通信" class="headerlink" title="消息通信"></a>消息通信</h2><h3 id="通信方式概览"><a href="#通信方式概览" class="headerlink" title="通信方式概览"></a>通信方式概览</h3><table><thead><tr><th>-</th><th>injected-script</th><th>content-script</th><th>popup-js</th><th>background-js</th></tr></thead><tbody><tr><td>injected-script</td><td>–</td><td>window.postMessage</td><td>–</td><td>–</td></tr><tr><td>content-script</td><td>window.postMessage</td><td>–</td><td>chrome.runtime.sendMessage chrome.runtime.connect</td><td>chrome.runtime.sendMessage chrome.runtime.connect</td></tr><tr><td>popup-js</td><td>–</td><td>chrome.tabs.sendMessage chrome.tabs.connect</td><td>–</td><td>chrome.extension.getBackgroundPage()</td></tr><tr><td>background-js</td><td>–</td><td>chrome.tabs.sendMessage chrome.tabs.connect</td><td>chrome.extension.getViews</td><td>–</td></tr><tr><td>devtools-js</td><td>chrome.devtools. inspectedWindow.eval</td><td>–</td><td>chrome.runtime.sendMessage</td><td>chrome.runtime.sendMessage</td></tr></tbody></table><h3 id="popup-amp-amp-background"><a href="#popup-amp-amp-background" class="headerlink" title="popup&amp;&amp;background"></a>popup&amp;&amp;background</h3><ul><li>popup 访问 background<blockquote><p>popup 可以直接调用 background 的 JS 方法，并且可以直接访问 background 的 DOM</p></blockquote></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// background.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">&quot;我是background！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// popup.js</span></span><br><span class="line"><span class="keyword">var</span> bg = chrome.extension.getBackgroundPage();</span><br><span class="line">bg.test(); <span class="comment">// 访问bg的函数</span></span><br><span class="line">alert(bg.document.body.innerHTML); <span class="comment">// 访问bg的DOM</span></span><br></pre></td></tr></table></figure><ul><li>background 访问 popup<div class="note info modern"><p>注意：前提是 popup 已经打开时</p></div></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> views = chrome.extension.getViews(&#123; <span class="attr">type</span>: <span class="string">&quot;popup&quot;</span> &#125;);</span><br><span class="line"><span class="keyword">if</span> (views.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(views[<span class="number">0</span>].location.href);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="popup-background-amp-amp-content-script"><a href="#popup-background-amp-amp-content-script" class="headerlink" title="(popup/background)&amp;&amp;content-script"></a>(popup/background)&amp;&amp;content-script</h3><ul><li>popup.js/background.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendMessageToContentScript</span>(<span class="params">message, callback</span>) </span>&#123;</span><br><span class="line">  chrome.tabs.query(&#123; <span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">currentWindow</span>: <span class="literal">true</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">tabs</span>) </span>&#123;</span><br><span class="line">    chrome.tabs.sendMessage(tabs[<span class="number">0</span>].id, message, <span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (callback) callback(response);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">sendMessageToContentScript(</span><br><span class="line">  &#123; <span class="attr">cmd</span>: <span class="string">&quot;test&quot;</span>, <span class="attr">value</span>: <span class="string">&quot;你好，我是popup！&quot;</span> &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;来自content的回复：&quot;</span> + response);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>content-script 接收消息</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chrome.runtime.onMessage.addListener(<span class="function"><span class="keyword">function</span> (<span class="params">request, sender, sendResponse</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// console.log(sender.tab ?&quot;from a content script:&quot; + sender.tab.url :&quot;from the extension&quot;);</span></span><br><span class="line">  <span class="keyword">if</span> (request.cmd == <span class="string">&quot;test&quot;</span>) alert(request.value);</span><br><span class="line">  sendResponse(<span class="string">&quot;我收到了你的消息！&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>双方通信直接发送的都是 JSON 对象，不是 JSON 字符串，所以无需解析，很方便（当然也可以直接发送字符串）。</p></blockquote><h3 id="content-script-amp-amp-background-popup"><a href="#content-script-amp-amp-background-popup" class="headerlink" title="content-script&amp;&amp;(background/popup)"></a>content-script&amp;&amp;(background/popup)</h3><ul><li>content-script.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chrome.runtime.sendMessage(</span><br><span class="line">  &#123; <span class="attr">greeting</span>: <span class="string">&quot;你好，我是content-script，主动发消息给后台！&quot;</span> &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;收到来自后台的回复：&quot;</span> + response);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>background.js/popup.js 接收消息</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 监听来自content-script的消息</span></span><br><span class="line">chrome.runtime.onMessage.addListener(<span class="function"><span class="keyword">function</span> (<span class="params">request, sender, sendResponse</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;收到来自content-script的消息：&quot;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(request, sender, sendResponse);</span><br><span class="line">  sendResponse(<span class="string">&quot;我是后台，我已收到你的消息：&quot;</span> + <span class="built_in">JSON</span>.stringify(request));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><div class="note warning modern"><ul><li>content_script 向 popup 主动发消息的前提是 popup 必须打开！否则需要利用 background 作中转。</li><li>如果 background 和 popup 同时监听，那么它们都可以同时收到消息，但是只有一个可以 sendResponse，一个先发送了，那么另外一个再发送就无效。</li></ul></div><h3 id="inject-script-amp-amp-content-script"><a href="#inject-script-amp-amp-content-script" class="headerlink" title="inject-script&amp;&amp;content-script"></a>inject-script&amp;&amp;content-script</h3><p>content-script 和页面内的脚本（injected-script 自然也属于页面内的脚本）之间唯一共享的东西就是页面的 DOM 元素，有 2 种方法可以实现二者通讯：</p><ul><li>1.可以通过 window.postMessage 和 window.addEventListener 来实现二者消息通讯(推荐)</li><li>inject-script:</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.postMessage(&#123; <span class="attr">test</span>: <span class="string">&quot;Hello,Content&quot;</span> &#125;, <span class="string">&quot;*&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>content-script:</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(</span><br><span class="line">  <span class="string">&quot;message&quot;</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e.data);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>2.通过自定义 DOM 事件来实现</li><li>inject-script:</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> customEvent = <span class="built_in">document</span>.createEvent(<span class="string">&quot;Event&quot;</span>);</span><br><span class="line">customEvent.initEvent(<span class="string">&quot;myCustomEvent&quot;</span>, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fireCustomEvent</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  hiddenDiv = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myCustomEventDiv&quot;</span>);</span><br><span class="line">  hiddenDiv.innerText = data;</span><br><span class="line">  hiddenDiv.dispatchEvent(customEvent);</span><br><span class="line">&#125;</span><br><span class="line">fireCustomEvent(<span class="string">&quot;Hello! I’m Injected&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>content-script:</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hiddenDiv = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myCustomEventDiv&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!hiddenDiv) &#123;</span><br><span class="line">  hiddenDiv = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">  hiddenDiv.style.display = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(hiddenDiv);</span><br><span class="line">&#125;</span><br><span class="line">hiddenDiv.addEventListener(<span class="string">&quot;myCustomEvent&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> eventData = <span class="built_in">document</span>.getElementById(<span class="string">&quot;myCustomEventDiv&quot;</span>).innerText;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;收到自定义事件消息：&quot;</span> + eventData);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><hr><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><h3 id="动态注入-JS、CSS"><a href="#动态注入-JS、CSS" class="headerlink" title="动态注入 JS、CSS"></a>动态注入 JS、CSS</h3><blockquote><p>虽然在 background 和 popup 中无法直接访问页面 DOM，但是可以通过 chrome.tabs.executeScript 来执行脚本，从而实现访问 web 页面的 DOM（注意，这种方式也不能直接访问页面 JS）。</p></blockquote><p>manifest.json 配置 🌰：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;动态注入JS/CSS&quot;</span>,</span><br><span class="line"> ...</span><br><span class="line"> &quot;permissions&quot;: [</span><br><span class="line">  &quot;tabs&quot;, &quot;http://*/*&quot;, &quot;https://*/*&quot;</span><br><span class="line"> ],</span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动态执行JS代码</span></span><br><span class="line">chrome.tabs.executeScript(tabId, &#123;</span><br><span class="line">  code: <span class="string">&#x27;document.body.style.backgroundColor=&quot;red&quot;&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 动态执行JS文件</span></span><br><span class="line">chrome.tabs.executeScript(tabId, &#123; <span class="attr">file</span>: <span class="string">&quot;some-script.js&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 动态执行CSS代码</span></span><br><span class="line">chrome.tabs.insertCSS(tabId, &#123; <span class="attr">code</span>: <span class="string">&quot;xxx&quot;</span> &#125;);</span><br><span class="line"><span class="comment">// 动态执行CSS文件</span></span><br><span class="line">chrome.tabs.insertCSS(tabId, &#123; <span class="attr">file</span>: <span class="string">&quot;some-style.css&quot;</span> &#125;);</span><br></pre></td></tr></table></figure><h3 id="获取当前窗口-ID"><a href="#获取当前窗口-ID" class="headerlink" title="获取当前窗口 ID"></a>获取当前窗口 ID</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chrome.windows.getCurrent(<span class="function"><span class="keyword">function</span> (<span class="params">currentWindow</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;当前窗口ID：&quot;</span> + currentWindow.id);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="获取当前标签页-ID"><a href="#获取当前标签页-ID" class="headerlink" title="获取当前标签页 ID"></a>获取当前标签页 ID</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前选项卡ID</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentTabId</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  chrome.tabs.query(&#123; <span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">currentWindow</span>: <span class="literal">true</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">tabs</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (callback) callback(tabs.length ? tabs[<span class="number">0</span>].id : <span class="literal">null</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="本地存储"><a href="#本地存储" class="headerlink" title="本地存储"></a>本地存储</h3><p>本地存储建议用 chrome.storage 而不是普通的 localStorage，区别有好几点，最重要的 2 点区别是：</p><ul><li>chrome.storage 是针对插件全局的，即使你在 background 中保存的数据，在 content-script 也能获取到。</li><li>chrome.storage.sync 可以跟随当前登录用户自动同步，这台电脑修改的设置会自动同步到其它电脑，很方便，如果没有登录或者未联网则先保存到本地，等登录了再同步至网络。</li></ul><blockquote><p>需要声明 storage 权限，有 chrome.storage.sync 和 chrome.storage.local2 种方式可供选择，使用示例 🌰 如下：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取数据，第一个参数是指定要读取的key以及设置默认值</span></span><br><span class="line">chrome.storage.sync.get(&#123; <span class="attr">color</span>: <span class="string">&quot;red&quot;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">items</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(items.color, items.age);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 保存数据</span></span><br><span class="line">chrome.storage.sync.set(&#123; <span class="attr">color</span>: <span class="string">&quot;blue&quot;</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;保存成功！&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="webRequest"><a href="#webRequest" class="headerlink" title="webRequest"></a>webRequest</h3><p>通过 webRequest 系列 API 可以对 HTTP 请求进行任性地修改、定制。<br>生命周期图：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/webRequest.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//manifest.json</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="comment">// 权限申请</span></span><br><span class="line"> <span class="string">&quot;permissions&quot;</span>:</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&quot;webRequest&quot;</span>, <span class="comment">// web请求</span></span><br><span class="line">  <span class="string">&quot;webRequestBlocking&quot;</span>, <span class="comment">// 阻塞式web请求</span></span><br><span class="line">  <span class="string">&quot;storage&quot;</span>, <span class="comment">// 插件本地存储</span></span><br><span class="line">  <span class="string">&quot;http://*/*&quot;</span>, <span class="comment">// 可以通过executeScript或者insertCSS访问的网站</span></span><br><span class="line">  <span class="string">&quot;https://*/*&quot;</span> <span class="comment">// 可以通过executeScript或者insertCSS访问的网站</span></span><br><span class="line"> ],</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// background.js</span></span><br><span class="line"><span class="comment">// 是否显示图片</span></span><br><span class="line"><span class="keyword">var</span> showImage;</span><br><span class="line">chrome.storage.sync.get(&#123;<span class="attr">showImage</span>: <span class="literal">true</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">items</span>) </span>&#123;</span><br><span class="line"> showImage = items.showImage;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// web请求监听，最后一个参数表示阻塞式，需单独声明权限：webRequestBlocking</span></span><br><span class="line">chrome.webRequest.onBeforeRequest.addListener(<span class="function"><span class="params">details</span> =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">// cancel 表示取消本次请求</span></span><br><span class="line"> <span class="keyword">if</span>(!showImage &amp;&amp; details.type == <span class="string">&#x27;image&#x27;</span>) <span class="keyword">return</span> &#123;<span class="attr">cancel</span>: <span class="literal">true</span>&#125;;</span><br><span class="line"> <span class="comment">// 简单的音视频检测</span></span><br><span class="line"> <span class="comment">// 大部分网站视频的type并不是media，且视频做了防下载处理，所以这里仅仅是为了演示效果，无实际意义</span></span><br><span class="line"> <span class="keyword">if</span>(details.type == <span class="string">&#x27;media&#x27;</span>) &#123;</span><br><span class="line">  chrome.notifications.create(<span class="literal">null</span>, &#123;</span><br><span class="line">   type: <span class="string">&#x27;basic&#x27;</span>,</span><br><span class="line">   iconUrl: <span class="string">&#x27;img/icon48.png&#x27;</span>,</span><br><span class="line">   title: <span class="string">&#x27;检测到音视频&#x27;</span>,</span><br><span class="line">   message: <span class="string">&#x27;音视频地址：&#x27;</span> + details.url,</span><br><span class="line">  &#125;);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;, &#123;<span class="attr">urls</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>]&#125;, [<span class="string">&quot;blocking&quot;</span>]);</span><br></pre></td></tr></table></figure><p>示例 🌰：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 每次请求前触发，可以拿到 requestBody 数据，同时可以对本次请求作出干预修改</span></span><br><span class="line">chrome.webRequest.onBeforeRequest.addListener(</span><br><span class="line">  (details) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;onBeforeRequest&quot;</span>, details);</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">urls</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>] &#125;,</span><br><span class="line">  [<span class="string">&quot;blocking&quot;</span>, <span class="string">&quot;extraHeaders&quot;</span>, <span class="string">&quot;requestBody&quot;</span>]</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发送header之前触发，可以拿到请求headers，也可以添加、修改、删除headers</span></span><br><span class="line"><span class="comment">// 但使用有一定限制，一些特殊头部可能拿不到或者存在特殊情况，详见官网文档</span></span><br><span class="line">chrome.webRequest.onBeforeSendHeaders.addListener(</span><br><span class="line">  (details) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;onBeforeSendHeaders&quot;</span>, details);</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">urls</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>] &#125;,</span><br><span class="line">  [<span class="string">&quot;blocking&quot;</span>, <span class="string">&quot;extraHeaders&quot;</span>, <span class="string">&quot;requestHeaders&quot;</span>]</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始响应触发，可以拿到服务端返回的headers</span></span><br><span class="line">chrome.webRequest.onResponseStarted.addListener(</span><br><span class="line">  (details) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;onResponseStarted&quot;</span>, details);</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">urls</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>] &#125;,</span><br><span class="line">  [<span class="string">&quot;extraHeaders&quot;</span>, <span class="string">&quot;responseHeaders&quot;</span>]</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求完成触发，能拿到的数据和onResponseStarted一样，注意无法拿到responseBody</span></span><br><span class="line">chrome.webRequest.onCompleted.addListener(</span><br><span class="line">  (details) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;onCompleted&quot;</span>, details);</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">urls</span>: [<span class="string">&quot;&lt;all_urls&gt;&quot;</span>] &#125;,</span><br><span class="line">  [<span class="string">&quot;extraHeaders&quot;</span>, <span class="string">&quot;responseHeaders&quot;</span>]</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>上面示例中提到，使用 webRequestAPI 是无法拿到 responseBody 的，想要拿到的话只能采取一些变通方法，例如：</p><ul><li>重写 XmlHttpRequest 和 fetch，增加自定义拦截事件，缺点是实现方式可能有点脏，重写不好的话可能影响正常页面。</li><li>devtools 的 chrome.devtools.network.onRequestFinishedAPI 可以拿到返回的 body，缺点是必须打开开发者面板。</li><li>使用 chrome.debugger.sendCommand 发送 Network.getResponseBody 命令来获取 body 内容，缺点也很明显，会有一个恼人的提示。</li></ul><blockquote><p>具体的实现方式可以查看<a href="https://stackoverflow.com/questions/18534771/chrome-extension-how-to-get-http-response-body">https://stackoverflow.com/questions/18534771/chrome-extension-how-to-get-http-response-body</a></p></blockquote><h3 id="国际化"><a href="#国际化" class="headerlink" title="国际化"></a>国际化</h3><p>插件根目录新建一个名为_locales 的文件夹，再在下面新建一些语言的文件夹，如 en、zh_CN、zh_TW，然后再在每个文件夹放入一个 messages.json，同时必须在清单文件中设置 default_locale。</p><ul><li>_locales\en\messages.json：</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;pluginDesc&quot;</span>: &#123; <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;A chrome extension demo&quot;</span> &#125;,</span><br><span class="line">  <span class="attr">&quot;helloWorld&quot;</span>: &#123; <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;Hello World!&quot;</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>_locales\zh_CN\messages.json:</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;pluginDesc&quot;</span>: &#123; <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;一个Chrome插件demo&quot;</span> &#125;,</span><br><span class="line">  <span class="attr">&quot;helloWorld&quot;</span>: &#123; <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;你好，世界！&quot;</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>在 manifest.json 和 CSS 文件中通过<strong>MSG_messagename</strong>引入，如：</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;__MSG_pluginDesc__&quot;</span>,</span><br><span class="line">  <span class="comment">// 默认语言</span></span><br><span class="line">  <span class="attr">&quot;default_locale&quot;</span>: <span class="string">&quot;zh_CN&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>在 JS 中则直接 chrome.i18n.getMessage(“helloWorld”)。</li><li>测试时，通过给 chrome 建立一个不同的快捷方式 chrome.exe –lang=en 来切换语言</li></ul><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/i18n.png"></p><h2 id="常见的-API"><a href="#常见的-API" class="headerlink" title="常见的 API"></a>常见的 API</h2><p>所有的 Chrome API 都是以 chrome 对象开头，🌰 如：chrome.tabs</p><ul><li>bookmarks 操纵书签的 API</li><li>browserAction 获取扩展图标、标题、文字、弹出页等</li><li>browsingData 控制浏览器的浏览数据，从本地文件</li><li>commands 给扩展添加快捷键</li><li>contextMenus 添加选项到右键弹出菜单</li><li>cookies 控制 cookies</li><li>desktopCapture 捕获屏幕、个人窗口或标签内容</li><li>downloads 下载控制</li><li>events 事件相关 API</li><li>extension 获取扩展的各部分，也能与各部分交换信息</li><li>extensionTypes 扩展的类型声明</li><li>gcm 启用 google 云消息服务，收发消息</li><li>history 历史记录控制</li><li>i18n 多语言国际化支持</li><li>idle 取得机器闲置状态</li><li>management 管理扩展与应用</li><li>notifications 通知控制</li><li>pageAction 具体的页面下控制扩展图标、标题、文字、弹出页等相关内容</li><li>permissions 获取拥有的权限</li><li>power 请求系统常亮</li><li>runtime 获取运行时相关信息，包括后台页、manifest 等等</li><li>sessions 查询或恢复浏览会话</li><li>storage 存储相关</li><li>tabs 与标签页交互</li><li>vpnProvider 实现 vpn 客户端需要使用的东西</li><li>webRequest 拦截、修改、阻塞请求</li><li>windows 创建、修改、重排窗口</li></ul><hr><h2 id="踩坑"><a href="#踩坑" class="headerlink" title="踩坑"></a>踩坑</h2><h3 id="查看已安装插件路径"><a href="#查看已安装插件路径" class="headerlink" title="查看已安装插件路径"></a>查看已安装插件路径</h3><p>查看本地已安装的插件源码路径 C:\Users\用户名\AppData\Local\Google\Chrome\User Data\Default\Extensions，每一个插件被放在以插件 ID 为名的文件夹里面，想要学习某个插件的某个功能是如何实现的，看人家的源码是最好的方法了。</p><blockquote><p>Mac 系统插件本地缓存位于：/Users/用户名/Library/Application Support/Google/Chrome/Default/Extensions 文件夹</p></blockquote><p>如何查看某个插件的 ID？进入 chrome://extensions ，然后勾选开发者模式即可看到了。</p><h3 id="background-的报错"><a href="#background-的报错" class="headerlink" title="background 的报错"></a>background 的报错</h3><p>很多时候你发现你的代码会莫名其妙的失效，找来找去又找不到原因，这时打开 background 的控制台才发现原来某个地方写错了导致代码没生效，这是由于 background 报错的隐蔽性(需要主动打开对应的控制台才能看到错误)</p><h3 id="如何让-popup-页面不关闭"><a href="#如何让-popup-页面不关闭" class="headerlink" title="如何让 popup 页面不关闭"></a>如何让 popup 页面不关闭</h3><p>在对 popup 页面审查元素的时候 popup 会被强制打开无法关闭，只有控制台关闭了才可以关闭 popup，原因很简单：如果 popup 关闭了控制台就没用了。这种方法在某些情况下很实用！</p><h3 id="不支持内联-JavaScript-的执行"><a href="#不支持内联-JavaScript-的执行" class="headerlink" title="不支持内联 JavaScript 的执行"></a>不支持内联 JavaScript 的执行</h3><p>就是不支持将 js 直接写在 html 中，例如 🌰：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;按钮&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;handleBtn()&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">// 报错 // Refused to execute inline event handler because it violates the</span><br><span class="line">following Content Security Policy directive: &quot;script-src &#x27;self&#x27; blob:</span><br><span class="line">filesystem: chrome-extension-resource:&quot;. Either the &#x27;unsafe-inline&#x27; keyword, a</span><br><span class="line">hash (&#x27;sha256-...&#x27;), or a nonce (&#x27;nonce-...&#x27;) is required to enable inline</span><br><span class="line">execution.</span><br></pre></td></tr></table></figure><p>只能通过 js 绑定事件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#btn&quot;</span>).on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">&quot;测试&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>另外，对于 A 标签，这样写 href=”javascript:;”然后用 JS 绑定事件虽然控制台会报错，但是不受影响，当然强迫症患者受不了的话只能写成 href=”#”了。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;get_res&quot;</span>&gt;</span>请求<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 报错 // Refused to execute JavaScript URL because it violates the following</span><br><span class="line">Content Security Policy directive: &quot;script-src &#x27;self&#x27; blob: filesystem:</span><br><span class="line">chrome-extension-resource:&quot;. Either the &#x27;unsafe-inline&#x27; keyword, a hash</span><br><span class="line">(&#x27;sha256-...&#x27;), or a nonce (&#x27;nonce-...&#x27;) is required to enable inline execution.</span><br></pre></td></tr></table></figure><h3 id="注入-CSS"><a href="#注入-CSS" class="headerlink" title="注入 CSS"></a>注入 CSS</h3><p>由于通过 content_scripts 注入的 CSS 优先级非常高，几乎仅次于浏览器默认样式，稍不注意可能就会影响一些网站的展示效果，所以尽量不要写一些影响全局的样式。</p><blockquote><p>之所以强调这个，是因为这个带来的问题非常隐蔽，不太容易找到，可能你正在写某个网页，昨天样式还是好好的，怎么今天就突然不行了？然后你辛辛苦苦找来找去，找了半天才发现竟然是因为插件里面的一个样式影响的！</p></blockquote><hr><p>原文：<a href="http://blog.haoji.me/chrome-plugin-develop.html#dong-tai-zhu-ru-huo-zhi-xing-JS">http://blog.haoji.me/chrome-plugin-develop.html#dong-tai-zhu-ru-huo-zhi-xing-JS</a></p><h2 id="相关资料："><a href="#相关资料：" class="headerlink" title="相关资料："></a>相关资料：</h2><div class="btns rounded grid5">            <a class="button" href='http://open.se.360.cn/open/extension_dev/overview.html' title='360安全浏览器开发文档（推荐）'><i class='fas fa-book-open'></i>360安全浏览器开发文档（推荐）</a><a class="button" href='http://open.chrome.360.cn/extension_dev/overview.html' title='360极速浏览器Chrome扩展开发文档'><i class='fas fa-book-open'></i>360极速浏览器Chrome扩展开发文档</a><a class="button" href='https://www.cnblogs.com/champagne/p/' title='Chrome扩展开发极客'><i class='fas fa-book-open'></i>Chrome扩展开发极客</a><a class="button" href='https://developer.chrome.com/extensions' title='chrome扩展开发官方文档（需要翻墙）'><i class='fas fa-book-open'></i>chrome扩展开发官方文档（需要翻墙）</a><a class="button" href='https://developer.chrome.com/extensions/api_index' title='chrome API支持（需要翻墙）'><i class='fas fa-book-open'></i>chrome API支持（需要翻墙）</a>          </div>]]></content>
      
      
      <categories>
          
          <category> Chrome </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
            <tag> Chrome </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>async/await</title>
      <link href="ilr5wg/"/>
      <url>ilr5wg/</url>
      
        <content type="html"><![CDATA[<p>JavaScript 中的 async/await 是 AsyncFunction 特性 中的关键字。目前为止，除了 IE 之外，常用浏览器和 Node (v7.6+) 都已经支持该特性。具体支持情况可以在<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncFunction#Browser_compatibility">这里</a>查看。</p><h2 id="async-和-await-在干什么"><a href="#async-和-await-在干什么" class="headerlink" title="async 和 await 在干什么"></a>async 和 await 在干什么</h2><p>任意一个名称都是有意义的，先从字面意思来理解。async 是“异步”的简写，而 await 可以认为是 async wait 的简写。所以应该很好理解 async 用于申明一个 function 是异步的，而 await 用于等待一个异步方法执行完成。</p><p>另外还有一个很有意思的语法规定，await 只能出现在 async 函数中。然后细心的朋友会产生一个疑问，如果 await 只能出现在 async 函数中，那这个 async 函数应该怎么调用？</p><p>如果需要通过 await 来调用一个 async 函数，那这个调用的外面必须得再包一个 async 函数，然后……进入死循环，永无出头之日……</p><p>如果 async 函数不需要 await 来调用，那 async 到底起个啥作用？</p><h3 id="async-起什么作用"><a href="#async-起什么作用" class="headerlink" title="async 起什么作用"></a>async 起什么作用</h3><p>这个问题的关键在于，async 函数是怎么处理它的返回值的！</p><p>我们当然希望它能直接通过 return 语句返回我们想要的值，但是如果真是这样，似乎就没 await 什么事了。所以，写段代码来试试，看它到底会返回什么：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">testAsync</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;hello async&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = testAsync();</span><br><span class="line"><span class="built_in">console</span>.log(result);</span><br></pre></td></tr></table></figure><p>看到输出就恍然大悟了——输出的是一个 Promise 对象。</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/async_log.png"></p><p>所以，async 函数返回的是一个 Promise 对象。从<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/async_function">文档</a>中也可以得到这个信息。async 函数（包含函数语句、函数表达式、Lambda 表达式）会返回一个 Promise 对象，如果在函数中 return 一个直接量，async 会把这个直接量通过 Promise.resolve() 封装成 Promise 对象。</p><p>Promise.resolve(x)可以看作是 new Promise(resolve =&gt; resolve(x))的简写，可以用于快速封装字面量对象或其他对象，将其封装成 Promise 实例。</p><p>async 函数返回的是一个 Promise 对象，所以在最外层不能用 await 获取其返回值的情况下，我们当然应该用原来的方式：then()链来处理这个 Promise 对象，就像这样</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">testAsync().then(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(v); <span class="comment">// 输出 hello async</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>现在回过头来想下，如果 async 函数没有返回值，又该如何？很容易想到，它会返回 Promise.resolve(undefined)。</p><p>联想一下 Promise 的特点——无等待，所以在没有 await 的情况下执行 async 函数，它会立即执行，返回一个 Promise 对象，并且，绝不会阻塞后面的语句。这和普通返回 Promise 对象的函数并无二致。</p><p>那么下一个关键点就在于 await 关键字了。</p><h3 id="await-到底在等啥"><a href="#await-到底在等啥" class="headerlink" title="await 到底在等啥"></a>await 到底在等啥</h3><p>一般来说，都认为 await 是在等待一个 async 函数完成。不过按语法说明，await 等待的是一个表达式，这个表达式的计算结果是 Promise 对象或者其它值（换句话说，就是没有特殊限定）。</p><p>因为 async 函数返回一个 Promise 对象，所以 await 可以用于等待一个 async 函数的返回值——这也可以说是 await 在等 async 函数，但要清楚，它等的实际是一个返回值。注意到 await 不仅仅用于等 Promise 对象，它可以等任意表达式的结果，所以，await 后面实际是可以接普通函数调用或者直接量的。所以下面这个示例完全可以正确运行</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSomething</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;something&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">testAsync</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(<span class="string">&quot;hello async&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> v1 = <span class="keyword">await</span> getSomething();</span><br><span class="line">  <span class="keyword">const</span> v2 = <span class="keyword">await</span> testAsync();</span><br><span class="line">  <span class="built_in">console</span>.log(v1, v2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br></pre></td></tr></table></figure><h3 id="await-等到了要等的，然后呢"><a href="#await-等到了要等的，然后呢" class="headerlink" title="await 等到了要等的，然后呢"></a>await 等到了要等的，然后呢</h3><p>await 等到了它要等的东西，一个 Promise 对象，或者其它值，然后呢？我不得不先说，await 是个运算符，用于组成表达式，await 表达式的运算结果取决于它等的东西。</p><p>如果它等到的不是一个 Promise 对象，那 await 表达式的运算结果就是它等到的东西。</p><p>如果它等到的是一个 Promise 对象，await 就忙起来了，它会阻塞后面的代码，等着 Promise 对象 resolve，然后得到 resolve 的值，作为 await 表达式的运算结果。</p><p>看到上面的阻塞一词，心慌了吧……放心，这就是 await 必须用在 async 函数中的原因。async 函数调用不会造成阻塞，它内部所有的阻塞都被封装在一个 Promise 对象中异步执行。</p><hr><h2 id="async-await-帮我们干了啥"><a href="#async-await-帮我们干了啥" class="headerlink" title="async/await 帮我们干了啥"></a>async/await 帮我们干了啥</h2><h3 id="作个简单的比较"><a href="#作个简单的比较" class="headerlink" title="作个简单的比较"></a>作个简单的比较</h3><p>上面已经说明了 async 会将其后的函数（函数表达式或 Lambda）的返回值封装成一个 Promise 对象，而 await 会等待这个 Promise 完成，并将其 resolve 的结果返回出来。</p><p>现在举例 🌰，用 setTimeout 模拟耗时的异步操作，先来看看不用 async/await 会怎么写</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">takeLongTime</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(<span class="string">&quot;long_time_value&quot;</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">takeLongTime().then(<span class="function">(<span class="params">v</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;got&quot;</span>, v);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>如果改用 async/await 呢，会是这样</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">takeLongTime</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(<span class="string">&quot;long_time_value&quot;</span>), <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> v = <span class="keyword">await</span> takeLongTime();</span><br><span class="line">  <span class="built_in">console</span>.log(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br></pre></td></tr></table></figure><p>眼尖的同学已经发现 takeLongTime() 没有申明为 async。实际上，takeLongTime() 本身就是返回的 Promise 对象，加不加 async 结果都一样，如果没明白，请回过头再去看看上面的“async 起什么作用”。</p><p>又一个疑问产生了，这两段代码，两种方式对异步调用的处理（实际就是对 Promise 对象的处理）差别并不明显，甚至使用 async/await 还需要多写一些代码，那它的优势到底在哪？</p><h3 id="async-await-的优势在于处理-then-链"><a href="#async-await-的优势在于处理-then-链" class="headerlink" title="async/await 的优势在于处理 then 链"></a>async/await 的优势在于处理 then 链</h3><p>单一的 Promise 链并不能发现 async/await 的优势，但是，如果需要处理由多个 Promise 组成的 then 链的时候，优势就能体现出来了（很有意思，Promise 通过 then 链来解决多层回调的问题，现在又用 async/await 来进一步优化它）。</p><p>假设一个业务，分多个步骤完成，每个步骤都是异步的，而且依赖于上一个步骤的结果。我们仍然用 setTimeout 来模拟异步操作：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 传入参数 n，表示这个函数执行的时间（毫秒）</span></span><br><span class="line"><span class="comment"> * 执行的结果是 n + 200，这个值将用于下一步骤</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">takeLongTime</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(n + <span class="number">200</span>), n);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step1</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`step1 with <span class="subst">$&#123;n&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">return</span> takeLongTime(n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step2</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`step2 with <span class="subst">$&#123;n&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">return</span> takeLongTime(n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step3</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`step3 with <span class="subst">$&#123;n&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">return</span> takeLongTime(n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>现在用 Promise 方式来实现这三个步骤的处理</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doIt</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> time1 = <span class="number">300</span>;</span><br><span class="line">  step1(time1)</span><br><span class="line">    .then(<span class="function">(<span class="params">time2</span>) =&gt;</span> step2(time2))</span><br><span class="line">    .then(<span class="function">(<span class="params">time3</span>) =&gt;</span> step3(time3))</span><br><span class="line">    .then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`result is <span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">      <span class="built_in">console</span>.timeEnd(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">doIt();</span><br><span class="line"></span><br><span class="line"><span class="comment">// c:\var\test&gt;node --harmony_async_await .</span></span><br><span class="line"><span class="comment">// step1 with 300</span></span><br><span class="line"><span class="comment">// step2 with 500</span></span><br><span class="line"><span class="comment">// step3 with 700</span></span><br><span class="line"><span class="comment">// result is 900</span></span><br><span class="line"><span class="comment">// doIt: 1507.251ms</span></span><br></pre></td></tr></table></figure><p>输出结果 result 是 step3()的参数 700 + 200 = 900。doIt()顺序执行了三个步骤，一共用了 300 + 500 + 700 = 1500 毫秒，和 console.time()/console.timeEnd()计算的结果一致。</p><p>如果用 async/await 来实现呢，会是这样</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">doIt</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> time1 = <span class="number">300</span>;</span><br><span class="line">  <span class="keyword">const</span> time2 = <span class="keyword">await</span> step1(time1);</span><br><span class="line">  <span class="keyword">const</span> time3 = <span class="keyword">await</span> step2(time2);</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> step3(time3);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`result is <span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">  <span class="built_in">console</span>.timeEnd(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">doIt();</span><br></pre></td></tr></table></figure><p>结果和之前的 Promise 实现是一样的，但是这个代码看起来是不是清晰得多，几乎跟同步代码一样</p><h3 id="还有更酷的"><a href="#还有更酷的" class="headerlink" title="还有更酷的"></a>还有更酷的</h3><p>现在把业务要求改一下，仍然是三个步骤，但每一个步骤都需要之前每个步骤的结果。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step1</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`step1 with <span class="subst">$&#123;n&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">return</span> takeLongTime(n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step2</span>(<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`step2 with <span class="subst">$&#123;m&#125;</span> and <span class="subst">$&#123;n&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">return</span> takeLongTime(m + n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step3</span>(<span class="params">k, m, n</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`step3 with <span class="subst">$&#123;k&#125;</span>, <span class="subst">$&#123;m&#125;</span> and <span class="subst">$&#123;n&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">return</span> takeLongTime(k + m + n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这回先用 async/await 来写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">doIt</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> time1 = <span class="number">300</span>;</span><br><span class="line">  <span class="keyword">const</span> time2 = <span class="keyword">await</span> step1(time1);</span><br><span class="line">  <span class="keyword">const</span> time3 = <span class="keyword">await</span> step2(time1, time2);</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> step3(time1, time2, time3);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`result is <span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">  <span class="built_in">console</span>.timeEnd(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">doIt();</span><br><span class="line"></span><br><span class="line"><span class="comment">// c:\var\test&gt;node --harmony_async_await .</span></span><br><span class="line"><span class="comment">// step1 with 300</span></span><br><span class="line"><span class="comment">// step2 with 800 = 300 + 500</span></span><br><span class="line"><span class="comment">// step3 with 1800 = 300 + 500 + 1000</span></span><br><span class="line"><span class="comment">// result is 2000</span></span><br><span class="line"><span class="comment">// doIt: 2907.387ms</span></span><br></pre></td></tr></table></figure><p>除了觉得执行时间变长了之外，似乎和之前的示例没啥区别啊！别急，认真想想如果把它写成 Promise 方式实现会是什么样子？</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doIt</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> time1 = <span class="number">300</span>;</span><br><span class="line">  step1(time1)</span><br><span class="line">    .then(<span class="function">(<span class="params">time2</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> step2(time1, time2).then(<span class="function">(<span class="params">time3</span>) =&gt;</span> [time1, time2, time3]);</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="function">(<span class="params">times</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> [time1, time2, time3] = times;</span><br><span class="line">      <span class="keyword">return</span> step3(time1, time2, time3);</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`result is <span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">      <span class="built_in">console</span>.timeEnd(<span class="string">&quot;doIt&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">doIt();</span><br></pre></td></tr></table></figure><p>转载自：<a href="https://segmentfault.com/u/jamesfancy">边城</a>的<a href="https://segmentfault.com/a/1190000007535316">理解 JavaScript 的 async/await</a><br>相关文章：<br><a href="https://segmentfault.com/a/1190000021966277">在微信小程序中使用 async/await</a><br><a href="https://segmentfault.com/a/1190000022349639">代码审查，异步调用的常见问题剖析</a><br><a href="https://segmentfault.com/a/1190000022315137">Proxy 封装微信小程序的异步调用</a><br><a href="https://segmentfault.com/a/1190000022467002">改进异步封装：处理带返回值的异步调用</a><br><a href="https://segmentfault.com/a/1190000011802045">从不用 try-catch 实现的 async/await 语法说错误处理</a></p>]]></content>
      
      
      <categories>
          
          <category> ES6 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Axios 封装</title>
      <link href="zw2gqe/"/>
      <url>zw2gqe/</url>
      
        <content type="html"><![CDATA[<h2 id="axios-的封装"><a href="#axios-的封装" class="headerlink" title="axios 的封装"></a>axios 的封装</h2><p>在 vue 项目中，和后台交互获取数据这块，我们通常使用的是 axios 库，它是基于 promise 的 http 库，可运行在浏览器端和 node.js 中。他有很多优秀的特性，例如拦截请求和响应、取消请求、转换 json、客户端防御 XSRF 等。所以我们的尤大大也是果断放弃了对其官方库<a href="https://www.runoob.com/vue2/vuejs-ajax.html">vue-resource</a>的维护，直接推荐我们使用 axios 库。如果还对 axios 不了解的，可以移步<a href="http://www.axios-js.com/">axios 文档</a>。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios; <span class="comment">// 安装axios</span></span><br></pre></td></tr></table></figure><h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><p>在项目的 src 目录中，新建一个 request 文件夹，然后在里面新建一个 http.js 和一个 api.js 文件。http.js 文件用来封装我们的 axios，api.js 用来统一管理我们的接口。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在http.js中引入axios</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>; <span class="comment">// 引入axios</span></span><br><span class="line"><span class="keyword">import</span> QS <span class="keyword">from</span> <span class="string">&quot;qs&quot;</span>; <span class="comment">// 引入qs模块，用来序列化post类型的数据</span></span><br><span class="line"><span class="comment">// element的message提示框组件，可根据自己的ui组件更改。</span></span><br><span class="line"><span class="keyword">import</span> &#123; Message &#125; <span class="keyword">from</span> <span class="string">&quot;element-ui&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="环境的切换"><a href="#环境的切换" class="headerlink" title="环境的切换"></a>环境的切换</h3><p>项目环境可能有开发环境、测试环境和生产环境。需要通过 node 的环境变量来匹配默认的接口 url 前缀。axios.defaults.baseURL 可以设置 axios 的默认请求地址。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 环境的切换</span></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">&quot;development&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// 生产环境</span></span><br><span class="line">  axios.defaults.baseURL = <span class="string">&quot;https://www.baidu.com&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">&quot;test&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// 测试环境</span></span><br><span class="line">  axios.defaults.baseURL = <span class="string">&quot;https://www.ceshi.com&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// 正式环境</span></span><br><span class="line">  axios.defaults.baseURL = <span class="string">&quot;https://www.production.com&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="设置请求超时"><a href="#设置请求超时" class="headerlink" title="设置请求超时"></a>设置请求超时</h3><p>通过 axios.defaults.timeout 设置默认的请求超时时间。例如超过了 5s，就会告知用户当前请求超时，请刷新等。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.timeout = <span class="number">5000</span>;</span><br></pre></td></tr></table></figure><h3 id="post-请求头的设置"><a href="#post-请求头的设置" class="headerlink" title="post 请求头的设置"></a>post 请求头的设置</h3><p>post 请求的时候，我们需要加上一个请求头，所以可以在这里进行一个默认的设置，即设置 post 的请求头为 application/x-www-form-urlencoded;charset=UTF-8</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.headers.post[<span class="string">&quot;Content-Type&quot;</span>] =</span><br><span class="line">  <span class="string">&quot;application/x-www-form-urlencoded;charset=UTF-8&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="请求拦截器"><a href="#请求拦截器" class="headerlink" title="请求拦截器"></a>请求拦截器</h3><p>我们在发送请求前可以进行一个请求的拦截，为什么要拦截呢，我们拦截请求是用来做什么的呢？比如，有些请求是需要用户登录之后才能访问的，或者 post 请求的时候，我们需要序列化我们提交的数据。这时候，我们可以在请求被发送之前进行一个拦截，从而进行我们想要的操作。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 先导入vuex,因为我们要使用到里面的状态对象</span></span><br><span class="line"><span class="comment">// vuex的路径根据自己的路径去写</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@/store/index&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求拦截器</span></span><br><span class="line">axios.interceptors.request.use(</span><br><span class="line">  (config) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 每次发送请求之前判断vuex中是否存在token</span></span><br><span class="line">    <span class="comment">// 如果存在，则统一在http请求的header都加上token，这样后台根据token判断你的登录情况</span></span><br><span class="line">    <span class="comment">// 即使本地存在token，也有可能token是过期的，所以在响应拦截器中要对返回状态进行判断</span></span><br><span class="line">    <span class="keyword">const</span> token = store.state.token;</span><br><span class="line">    token &amp;&amp; (config.headers.Authorization = token);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  (error) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.error(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><div class="note info modern"><p>这里说一下 token，一般是在登录完成之后，将用户的 token 通过 localStorage 或者 cookie 存在本地，然后用户每次在进入页面的时候（即在 main.js 中），会首先从本地存储中读取 token，如果 token 存在说明用户已经登陆过，则更新 vuex 中的 token 状态。然后，在每次请求接口的时候，都会在请求的 header 中携带 token，后台人员就可以根据你携带的 token 来判断你的登录是否过期，如果没有携带，则说明没有登录过。</p></div><h3 id="响应拦截器"><a href="#响应拦截器" class="headerlink" title="响应拦截器"></a>响应拦截器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">axios.interceptors.response.use(</span><br><span class="line">    response =&gt; &#123;</span><br><span class="line">        <span class="comment">// 如果返回的状态码为200，说明接口请求成功，可以正常拿到数据</span></span><br><span class="line">        <span class="comment">// 否则的话抛出错误</span></span><br><span class="line">        <span class="keyword">if</span> (response.status === <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(response);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 服务器状态码不是2开头的的情况</span></span><br><span class="line">    <span class="comment">// 这里可以跟你们的后台开发人员协商好统一的错误状态码</span></span><br><span class="line">    <span class="comment">// 然后根据返回的状态码进行一些操作，例如登录过期提示，错误提示等等</span></span><br><span class="line">    error =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (error.response.status) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (error.response.status) &#123;</span><br><span class="line">                <span class="comment">// 401: 未登录</span></span><br><span class="line">                <span class="comment">// 未登录则跳转登录页面，并携带当前页面的路径</span></span><br><span class="line">                <span class="comment">// 在登录成功后返回当前页面，这一步需要在登录页操作。</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">                    router.replace(&#123;</span><br><span class="line">                        path: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">                        query: &#123;</span><br><span class="line">                            redirect: router.currentRoute.fullPath</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 403 token过期</span></span><br><span class="line">                <span class="comment">// 登录过期对用户进行提示</span></span><br><span class="line">                <span class="comment">// 清除本地token和清空vuex中token对象</span></span><br><span class="line">                <span class="comment">// 跳转登录页面</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">                     Message(&#123;</span><br><span class="line">                        message: <span class="string">&#x27;登录过期，请重新登录&#x27;</span>,</span><br><span class="line">                        type:<span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">                        duration: <span class="number">1000</span>,</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="comment">// 清除token</span></span><br><span class="line">                    <span class="built_in">localStorage</span>.removeItem(<span class="string">&#x27;token&#x27;</span>);</span><br><span class="line">                    store.commit(<span class="string">&#x27;loginSuccess&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">                    <span class="comment">// 跳转登录页面，并将要浏览的页面fullPath传过去，登录成功后跳转需要访问的页面</span></span><br><span class="line">                    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        router.replace(&#123;</span><br><span class="line">                            path: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">                            query: &#123;</span><br><span class="line">                                redirect: router.currentRoute.fullPath</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;, <span class="number">1000</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 404请求不存在</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">                    Message(&#123;</span><br><span class="line">                        message: <span class="string">&#x27;网络请求不存在&#x27;</span>,</span><br><span class="line">                        type:<span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">                        duration: <span class="number">1500</span>,</span><br><span class="line"></span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">// 其他错误，直接抛出错误提示</span></span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    Message(&#123;</span><br><span class="line">                        message: error.response.data.message,</span><br><span class="line">                        type: <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">                        duration: <span class="number">1500</span></span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error.response);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>响应拦截器很好理解，就是服务器返回给我们的数据，我们在拿到之前可以对他进行一些处理。例如上面的思想：如果后台返回的状态码是 200，则正常返回数据，否则的根据错误的状态码类型进行一些我们需要的错误，其实这里主要就是进行了错误的统一处理和没登录或登录过期后调整登录页的一个操作。</p><h3 id="封装-get-方法和-post-方法"><a href="#封装-get-方法和-post-方法" class="headerlink" title="封装 get 方法和 post 方法"></a>封装 get 方法和 post 方法</h3><p>我们常用的 ajax 请求方法有 get、post、put 等方法。axios 对应的也有很多类似的方法，不清楚的可以看下文档。但是为了简化我们的代码，我们还是要对其进行一个简单的封装。下面我们主要封装两个方法：get 和 post。</p><ul><li>get 方法：<br>我们通过定义一个 get 函数，get 函数有两个参数，第一个参数表示我们要请求的 url 地址，第二个参数是我们要携带的请求参数。get 函数返回一个 promise 对象，当 axios 其请求成功时 resolve 服务器返回 值，请求失败时 reject 错误值。最后通过 export 抛出 get 函数。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * get方法，对应get请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>url [请求的url地址]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>params [请求时携带的参数]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">url, params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios</span><br><span class="line">      .get(url, &#123;</span><br><span class="line">        params: params,</span><br><span class="line">      &#125;)</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(res.data);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        reject(err.data);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>post 方法：<br>原理同 get 基本一样，但是要注意的是，post 方法必须要使用对提交从参数对象进行序列化的操作，所以这里我们通过 node 的 qs 模块来序列化我们的参数。这个很重要，如果没有序列化操作，后台是拿不到你提交的数据的。这就是文章开头我们 import QS from ‘qs’的原因。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * post方法，对应post请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>url [请求的url地址]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>params [请求时携带的参数]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">post</span>(<span class="params">url, params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios</span><br><span class="line">      .post(url, QS.stringify(params))</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(res.data);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        reject(err.data);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>这里有个小细节说下，axios.get()方法和 axios.post()在提交数据时参数的书写方式还是有区别的。区别就是，get 的第二个参数是一个{}，然后这个对象的 params 属性值是一个参数对象的。而 post 的第二个参数就是一个参数对象。</p></blockquote><h3 id="api-接口统一管理"><a href="#api-接口统一管理" class="headerlink" title="api 接口统一管理"></a>api 接口统一管理</h3><p>在 api.js 中引入封装的 get 和 post 方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * api接口统一管理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> &#123; get, post &#125; <span class="keyword">from</span> <span class="string">&quot;./http&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Login = <span class="function">(<span class="params">data</span>) =&gt;</span> post(<span class="string">&quot;api/v1/login&quot;</span>, data);</span><br></pre></td></tr></table></figure><p>我们定义了一个 Login 方法，这个方法有一个参数 data，data 是我们请求接口时携带的参数对象。而后调用了我们封装的 post 方法，post 方法的第一个参数是我们的接口地址，第二个参数是 Login 的 data 参数，即请求接口时携带的参数对象。最后通过 export 导出 Login。</p><p>然后在我们的页面中可以这样调用我们的 api 接口：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; apiAddress &#125; <span class="keyword">from</span> <span class="string">&quot;@/request/api&quot;</span>; <span class="comment">// 导入我们的api接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">&quot;Address&quot;</span>,</span><br><span class="line">  <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.onLoad();</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="comment">// 获取数据</span></span><br><span class="line">    <span class="function"><span class="title">onLoad</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="comment">// 调用api接口，并且提供了两个参数</span></span><br><span class="line">      Login(&#123;</span><br><span class="line">        userName: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">        password: <span class="number">123456</span>,</span><br><span class="line">      &#125;).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 获取数据成功后的其他操作</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>api 接口管理的一个好处就是，我们把 api 统一集中起来，如果后期需要修改接口，我们就直接在 api.js 中找到对应的修改就好了，而不用去每一个页面查找我们的接口然后再修改会很麻烦。还有就是如果直接在我们的业务代码修改接口，一不小心还容易动到我们的业务代码造成不必要的麻烦。</p><hr><h2 id="完整-axios-封装代码"><a href="#完整-axios-封装代码" class="headerlink" title="完整 axios 封装代码"></a>完整 axios 封装代码</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**axios封装</span></span><br><span class="line"><span class="comment"> * 请求拦截、相应拦截、错误统一处理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> QS <span class="keyword">from</span> <span class="string">&quot;qs&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Message &#125; <span class="keyword">from</span> <span class="string">&quot;element-ui&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;../store/index&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 环境的切换</span></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">&quot;development&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// 生产环境</span></span><br><span class="line">  axios.defaults.baseURL = <span class="string">&quot;https://www.baidu.com&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">&quot;test&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// 测试环境</span></span><br><span class="line">  axios.defaults.baseURL = <span class="string">&quot;https://www.ceshi.com&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV == <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">  <span class="comment">// 正式环境</span></span><br><span class="line">  axios.defaults.baseURL = <span class="string">&quot;https://www.production.com&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求超时时间</span></span><br><span class="line">axios.defaults.timeout = <span class="number">5000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// post请求头</span></span><br><span class="line">axios.defaults.headers.post[<span class="string">&quot;Content-Type&quot;</span>] =</span><br><span class="line">  <span class="string">&quot;application/x-www-form-urlencoded;charset=UTF-8&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求拦截器</span></span><br><span class="line">axios.interceptors.request.use(</span><br><span class="line">  (config) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 每次发送请求之前判断是否存在token，如果存在，则统一在http请求的header都加上token，不用每次请求都手动添加了</span></span><br><span class="line">    <span class="comment">// 即使本地存在token，也有可能token是过期的，所以在响应拦截器中要对返回状态进行判断</span></span><br><span class="line">    <span class="keyword">const</span> token = store.state.token;</span><br><span class="line">    token &amp;&amp; (config.headers.Authorization = token);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  (error) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.error(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">axios.interceptors.response.use(</span><br><span class="line">  (response) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (response.status === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(response);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 服务器状态码不是200的情况</span></span><br><span class="line">  (error) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (error.response.status) &#123;</span><br><span class="line">      <span class="keyword">switch</span> (error.response.status) &#123;</span><br><span class="line">        <span class="comment">// 401: 未登录</span></span><br><span class="line">        <span class="comment">// 未登录则跳转登录页面，并携带当前页面的路径</span></span><br><span class="line">        <span class="comment">// 在登录成功后返回当前页面，这一步需要在登录页操作。</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">          router.replace(&#123;</span><br><span class="line">            path: <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">            query: &#123; <span class="attr">redirect</span>: router.currentRoute.fullPath &#125;,</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// 403 token过期</span></span><br><span class="line">        <span class="comment">// 登录过期对用户进行提示</span></span><br><span class="line">        <span class="comment">// 清除本地token和清空vuex中token对象</span></span><br><span class="line">        <span class="comment">// 跳转登录页面</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">          Message(&#123;</span><br><span class="line">            message: <span class="string">&quot;登录过期，请重新登录&quot;</span>,</span><br><span class="line">            type: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">            duration: <span class="number">1000</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="comment">// 清除token</span></span><br><span class="line">          <span class="built_in">localStorage</span>.removeItem(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">          store.commit(<span class="string">&quot;loginSuccess&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">          <span class="comment">// 跳转登录页面，并将要浏览的页面fullPath传过去，登录成功后跳转需要访问的页面</span></span><br><span class="line">          <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            router.replace(&#123;</span><br><span class="line">              path: <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">              query: &#123;</span><br><span class="line">                redirect: router.currentRoute.fullPath,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;, <span class="number">1000</span>);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// 404请求不存在</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">          Message(&#123;</span><br><span class="line">            message: <span class="string">&quot;网络请求不存在&quot;</span>,</span><br><span class="line">            type: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">            duration: <span class="number">1500</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// 其他错误，直接抛出错误提示</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          Message(&#123;</span><br><span class="line">            message: error.response.data.message,</span><br><span class="line">            type: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">            duration: <span class="number">1500</span>,</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error.response);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * get方法，对应get请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>url [请求的url地址]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>params [请求时携带的参数]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">url, params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios</span><br><span class="line">      .get(url, &#123;</span><br><span class="line">        params: params,</span><br><span class="line">      &#125;)</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(res.data);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        reject(err.data);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * post方法，对应post请求</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>url [请求的url地址]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>params [请求时携带的参数]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">post</span>(<span class="params">url, params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios</span><br><span class="line">      .post(url, QS.stringify(params))</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(res.data);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">        reject(err.data);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="根据需求不同作优化"><a href="#根据需求不同作优化" class="headerlink" title="根据需求不同作优化"></a>根据需求不同作优化</h2><ol><li> 优化 axios 封装，去掉之前的 get 和 post</li><li> 断网情况处理</li><li> 更加模块化的 api 管理</li><li> 接口域名有多个的情况</li><li> api 挂载到 vue.prototype 上省去引入的步骤</li></ol><p>http.js 中 axios 封装的优化，先直接贴代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * axios封装</span></span><br><span class="line"><span class="comment"> * 请求拦截、响应拦截、错误统一处理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;../router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;../store/index&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Message &#125; <span class="keyword">from</span> <span class="string">&quot;element-ui&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 提示函数</span></span><br><span class="line"><span class="comment"> * 禁止点击蒙层、显示一秒后关闭</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> tip = <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">  Message(&#123;</span><br><span class="line">    message: msg,</span><br><span class="line">    type: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">    duration: <span class="number">1000</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 跳转登录页</span></span><br><span class="line"><span class="comment"> * 携带当前页面路由，在登录页面完成登录后返回当前页面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> toLogin = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  router.replace(&#123;</span><br><span class="line">    path: <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">    query: &#123;</span><br><span class="line">      redirect: router.currentRoute.fullPath,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求失败后的错误统一处理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Number&#125;</span> </span>status 请求失败的状态码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> errorHandle = <span class="function">(<span class="params">status, other</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 状态码判断</span></span><br><span class="line">  <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">    <span class="comment">// 401: 未登录状态，跳转登录页</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">      toLogin();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">// 403 token过期</span></span><br><span class="line">    <span class="comment">// 清除token并跳转登录页</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">      tip(<span class="string">&quot;登录过期，请重新登录&quot;</span>);</span><br><span class="line">      <span class="built_in">localStorage</span>.removeItem(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">      store.commit(<span class="string">&quot;loginSuccess&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        toLogin();</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">// 404请求不存在</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">      tip(<span class="string">&quot;请求的资源不存在&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="built_in">console</span>.log(other);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建axios实例</span></span><br><span class="line"><span class="keyword">var</span> instance = axios.create(&#123; <span class="attr">timeout</span>: <span class="number">5000</span> &#125;);</span><br><span class="line"><span class="comment">// 设置post请求头</span></span><br><span class="line">instance.defaults.headers.post[<span class="string">&quot;Content-Type&quot;</span>] =</span><br><span class="line">  <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求拦截器</span></span><br><span class="line"><span class="comment"> * 每次请求前，如果存在token则在请求头中携带token</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">instance.interceptors.request.use(</span><br><span class="line">  (config) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 登录流程控制中，根据本地是否存在token判断用户的登录情况</span></span><br><span class="line">    <span class="comment">// 但是即使token存在，也有可能token是过期的，所以在每次的请求头中携带token</span></span><br><span class="line">    <span class="comment">// 后台根据携带的token判断用户的登录情况，并返回给我们对应的状态码</span></span><br><span class="line">    <span class="comment">// 而后我们可以在响应拦截器中，根据状态码进行一些统一的操作。</span></span><br><span class="line">    <span class="keyword">const</span> token = store.state.token;</span><br><span class="line">    token &amp;&amp; (config.headers.Authorization = token);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  (error) =&gt; <span class="built_in">Promise</span>.error(error)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">instance.interceptors.response.use(</span><br><span class="line">  <span class="comment">// 请求成功</span></span><br><span class="line">  (res) =&gt; (res.status === <span class="number">200</span> ? <span class="built_in">Promise</span>.resolve(res) : <span class="built_in">Promise</span>.reject(res)),</span><br><span class="line">  <span class="comment">// 请求失败</span></span><br><span class="line">  (error) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; response &#125; = error;</span><br><span class="line">    <span class="keyword">if</span> (response) &#123;</span><br><span class="line">      <span class="comment">// 请求已发出，但是不在2xx的范围</span></span><br><span class="line">      errorHandle(response.status, response.data.message);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 处理断网的情况</span></span><br><span class="line">      <span class="comment">// eg:请求超时或断网时，更新state的network状态</span></span><br><span class="line">      <span class="comment">// network状态在app.vue中控制着一个全局的断网提示组件的显示隐藏</span></span><br><span class="line">      <span class="comment">// 关于断网组件中的刷新重新获取数据，会在断网组件中说明</span></span><br><span class="line">      <span class="keyword">if</span> (!<span class="built_in">window</span>.navigator.onLine) &#123;</span><br><span class="line">        store.commit(<span class="string">&quot;changeNetwork&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance;</span><br></pre></td></tr></table></figure><div class="note primary modern"><p>如下几点改变：</p><ol><li>去掉了之前 get 和 post 方法的封装，通过创建一个 axios 实例然后 export default 方法导出，这样使用起来更灵活一些。</li><li>去掉了通过环境变量控制 baseUrl 的值。考虑到接口会有多个不同域名的情况，所以准备通过 js 变量来控制接口域名。这点具体在 api 里会介绍。</li><li>增加了请求超时，即断网状态的处理。<br>当断网时，通过更新 vuex 中 network 的状态来控制断网提示组件的显示隐藏。断网提示一般会有重新加载数据的操作。</li><li>公用函数进行抽出，简化代码，尽量保证单一职责原则。</li></ol></div><p>   下面说下 api 这块，考虑到以下需求：<br>5. 更加模块化<br>6. 更方便多人开发，有效减少解决命名冲突<br>7. 处理接口域名有多个情况</p><p>这里新建了一个 api 文件夹，里面有一个 index.js 和一个 base.js，以及多个根据模块划分的接口 js 文件。index.js 是一个 api 的出口，base.js 管理接口域名，其他 js 则用来管理各个模块的接口。</p><p>先放 index.js 代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * api接口的统一出口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 文章模块接口</span></span><br><span class="line"><span class="keyword">import</span> article <span class="keyword">from</span> <span class="string">&quot;@/api/article&quot;</span>;</span><br><span class="line"><span class="comment">// 其他模块的接口……</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  article,</span><br><span class="line">  <span class="comment">// ……</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>index.js 是一个 api 接口的出口，这样就可以把 api 接口根据功能划分为多个模块，利于多人协作开发，比如一个人只负责一个模块的开发等，还能方便每个模块中接口的命名。</p><p>base.js:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 接口域名的管理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> base = &#123;</span><br><span class="line">  sq: <span class="string">&quot;https://xxxx111111.com/api/v1&quot;</span>,</span><br><span class="line">  bd: <span class="string">&quot;http://xxxxx22222.com/api&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> base;</span><br></pre></td></tr></table></figure><p>通过 base.js 来管理我们的接口域名，不管有多少个都可以通过这里进行接口的定义。即使修改起来，也是很方便的。<br>最后就是接口模块的说明，例如上面的 article.js:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * article模块接口列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base <span class="keyword">from</span> <span class="string">&quot;./base&quot;</span>; <span class="comment">// 导入接口域名列表</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;@/utils/http&quot;</span>; <span class="comment">// 导入http中创建的axios实例</span></span><br><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&quot;qs&quot;</span>; <span class="comment">// 根据需求是否导入qs模块</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> article = &#123;</span><br><span class="line">  <span class="comment">// 新闻列表</span></span><br><span class="line">  <span class="function"><span class="title">articleList</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> axios.get(<span class="string">`<span class="subst">$&#123;base.sq&#125;</span>/topics`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 新闻详情,演示</span></span><br><span class="line">  <span class="function"><span class="title">articleDetail</span>(<span class="params">id, params</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> axios.get(<span class="string">`<span class="subst">$&#123;base.sq&#125;</span>/topic/<span class="subst">$&#123;id&#125;</span>`</span>, &#123;</span><br><span class="line">      params: params,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// post提交</span></span><br><span class="line">  <span class="function"><span class="title">login</span>(<span class="params">params</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> axios.post(<span class="string">`<span class="subst">$&#123;base.sq&#125;</span>/accesstoken`</span>, qs.stringify(params));</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 其他接口…………</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> article;</span><br></pre></td></tr></table></figure><div class="note success modern"><ol><li>通过直接引入我们封装好的 axios 实例，然后定义接口、调用 axios 实例并返回，可以更灵活的使用 axios，比如你可以对 post 请求时提交的数据进行一个 qs 序列化的处理等。</li><li>请求的配置更灵活，你可以针对某个需求进行一个不同的配置。关于配置的优先级，axios 文档说的很清楚，这个顺序是：在 lib/defaults.js 找到的库的默认值，然后是实例的 defaults 属性，最后是请求的 config 参数。后者将优先于前者。</li><li>restful 风格的接口，也可以通过这种方式灵活的设置 api 接口地址。</li></ol></div><p>最后，为了方便 api 的调用，我们需要将其挂载到 vue 的原型上。在 main.js 中：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>; <span class="comment">// 导入路由文件</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>; <span class="comment">// 导入vuex文件</span></span><br><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">&quot;./api&quot;</span>; <span class="comment">// 导入api接口</span></span><br><span class="line"></span><br><span class="line">Vue.prototype.$api = api; <span class="comment">// 将api挂载到vue的原型上</span></span><br></pre></td></tr></table></figure><p>在页面中这样调用接口，例子 🌰：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">onLoad</span>(<span class="params">id</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.$api.article.articleDetail(id, &#123;</span><br><span class="line">            api: <span class="number">123</span></span><br><span class="line">        &#125;).then(<span class="function"><span class="params">res</span>=&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 执行某些操作</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>关于断网的处理，这里做一个简单的示例 🌰：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;!network&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>我没网了<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">&quot;onRefresh&quot;</span>&gt;</span>刷新<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    name: <span class="string">&quot;App&quot;</span>,</span></span><br><span class="line">    computed: &#123;</span><br><span class="line"><span class="javascript">      ...mapState([<span class="string">&quot;network&quot;</span>]),</span></span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line"><span class="javascript">      <span class="comment">// 通过跳转一个空页面再返回的方式来实现刷新当前页面数据的目的</span></span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="title">onRefresh</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.$router.replace(<span class="string">&quot;/refresh&quot;</span>);</span></span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这是 app.vue，这里简单演示一下断网。在 http.js 中介绍了，我们会在断网的时候，来更新 vue 中 network 的状态，那么这里我们根据 network 的状态来判断是否需要加载这个断网组件。断网情况下，加载断网组件，不加载对应页面的组件。当点击刷新的时候，我们通过跳转 refesh 页面然后立即返回的方式来实现重新获取数据的操作。因此我们需要新建一个 refresh.vue 页面，并在其 beforeRouteEnter 钩子中再返回当前页面。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// refresh.vue</span></span><br><span class="line">beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    next(<span class="function"><span class="params">vm</span> =&gt;</span> &#123;</span><br><span class="line">        vm.$router.replace(<span class="keyword">from</span>.fullPath)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Axios </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浏览器渲染过程简介</title>
      <link href="gc6agg/"/>
      <url>gc6agg/</url>
      
        <content type="html"><![CDATA[<h2 id="浏览器工作流程"><a href="#浏览器工作流程" class="headerlink" title="浏览器工作流程"></a>浏览器工作流程</h2><p>话不多说，先来看个图：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/Render-Process.jpg"></p><p>从上面这个图中，我们可以看到那么几个事：</p><ul><li>浏览器会解析三个东西：</li></ul><ol><li>一个是 HTML/SVG/XHTML，事实上，Webkit 有三个 C++的类对应这三类文档。解析这三种文件会产生一个 DOM Tree。</li><li>CSS，解析 CSS 会产生 CSS 规则树。</li><li>Javascript 脚本，主要是通过 DOM API 和 CSSOM API 来操作 DOM Tree 和 CSS Rule Tree（CSS 规则树）。</li></ol><ul><li>解析完成后，浏览器引擎会通过 DOM Tree 和 CSS Rule Tree 来构造 Rendering Tree（渲染树）。</li></ul><blockquote><p>注意：<br>Rendering Tree 渲染树并不等同于 DOM 树，因为一些像 Header 或 display:none 的东西就没必要放在渲染树中了。<br>CSS 的 Rule Tree 主要是为了完成匹配并把 CSS Rule 附加上 Rendering Tree 上的每个 Element（元素）。也就是 DOM 节点。也就是所谓的 Frame（框架）。<br>然后，计算每个 Frame（也就是每个 Element）的位置，这又叫 layout 和 reflow（重排/回流）过程。</p></blockquote><ul><li>最后通过调用操作系统 Native GUI 的 API 绘制。</li></ul><hr><h2 id="DOM-解析"><a href="#DOM-解析" class="headerlink" title="DOM 解析"></a>DOM 解析</h2><p>HTML 的 DOM Tree 解析如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">title</span>&gt;</span>Web page parsing<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Web page parsing<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is an example Web page.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面这段 HTML 会解析成这样：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/DOM-Tree-01.jpg"></p><p>有 SVG 标签的情况：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/DOM-Tree-02.jpg"></p><hr><h2 id="CSS-解析"><a href="#CSS-解析" class="headerlink" title="CSS 解析"></a>CSS 解析</h2><p>CSS 的解析大概是下面这个样子（下面主要说的是 Gecko 也就是 Firefox 的玩法），假设我们有下面的 HTML 文档：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">doc</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>A few quotes<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">para</span>&gt;</span></span><br><span class="line">    Franklin said that <span class="tag">&lt;<span class="name">quote</span>&gt;</span>&quot;A penny saved is a penny earned.&quot;<span class="tag">&lt;/<span class="name">quote</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">para</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">para</span>&gt;</span></span><br><span class="line">    FDR said</span><br><span class="line">    <span class="tag">&lt;<span class="name">quote</span>&gt;</span>&quot;We have nothing to fear but <span class="tag">&lt;<span class="name">span</span>&gt;</span>fear itself.<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&quot;<span class="tag">&lt;/<span class="name">quote</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">para</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">doc</span>&gt;</span></span><br></pre></td></tr></table></figure><p>DOM Tree 是这个样子：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/DOM-Tree-Example.jpg"></p><p>css 文档：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* rule 1 */</span></span><br><span class="line">doc &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">text-indent</span>: <span class="number">1em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* rule 2 */</span></span><br><span class="line">title &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">3em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* rule 3 */</span></span><br><span class="line">para &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* rule 4 */</span></span><br><span class="line"><span class="selector-attr">[class=<span class="string">&quot;emph&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attribute">font-style</span>: italic;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>于是我们的 CSS Rule Tree 会是这个样子：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/CSS-Rule-Tree-Example.jpg"></p><p>注意，图中的第 4 条规则出现了两次，一次是独立的，一次是在规则 3 的子节点。所以，我们可以知道，建立 CSS Rule Tree（CSS 规则树）是需要比照着 DOM Tree 来的。CSS 匹配 DOM Tree 主要是从右到左解析 CSS 的 Selector（选择器），好多人以为这个事会比较快，其实并不一定。关键还看我们的 CSS 的 Selector（选择器）怎么写了。</p><div class="note warning modern"><p>注意：<br>CSS 匹配 HTML 元素是一个相当复杂和有性能问题的事情。所以，你就会在 N 多地方看到很多人都告诉你，DOM 树要小，CSS 尽量用 id 和 class，千万不要过渡层叠下去……</p></div><p>通过这两个树，我们可以得到一个叫 Style Context Tree（样式上下文树），也就是下面这样（把 CSS Rule 节点附加到 DOM Tree 上）：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/CSS-Content-Tree-Example.jpg"></p><p>所以，Firefox 基本上来说是通过 CSS 解析 生成 CSS Rule Tree，然后，通过比对 DOM 生成 Style Context Tree，然后 Firefox 通过把 Style Context Tree 和其 Render Tree（Frame Tree）关联上，就完成了。</p><div class="note warning modern"><p>注意：Render Tree 会把一些不可见的节点去除掉。而 Firefox 中所谓的 Frame 就是一个 DOM 节点，不要被其名字所迷惑了。</p></div><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/Firefox-style-context-tree.png"></p><blockquote><p>注：Webkit 不像 Firefox 要用两个树来干这个，Webkit 也有 Style 对象，它直接把这个 Style 对象存在了相应的 DOM 节点上了。</p></blockquote><hr><h2 id="渲染"><a href="#渲染" class="headerlink" title="渲染"></a>渲染</h2><p>渲染的流程基本上如下（黄色的四个步骤）：</p><ol><li>计算 CSS 样式</li><li>构建 Render Tree</li><li>Layout – 定位坐标和大小，是否换行，各种 position, overflow, z-index 属性 ……</li><li>正式开画</li></ol><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/Render-Process-Skipping-1024x282.jpg"></p><div class="note warning modern"><p>注意：上图流程中有很多连接线，这表示了 Javascript 动态修改了 DOM 属性或是 CSS 属会导致重新 Layout，有些改变不会，就是那些指到天上的箭头，比如，修改后的 CSS rule 没有被匹配到，等。</p></div><p>这里重要要说两个概念，一个是 Reflow（重排/回流），另一个是 Repaint（重绘）。这两个不是一回事。</p><div class="note info modern"><ul><li>Repaint（重排/回流）——屏幕的一部分要重画，比如某个 CSS 的背景色变了。但是元素的几何尺寸没有变。</li><li>Reflow（重绘）——意味着元件的几何尺寸变了，我们需要重新验证并计算 Render Tree。是 Render Tree 的一部分或全部发生了变化。这就是 Reflow，或是 Layout。（HTML 使用的是 flow based layout，也就是流式布局，所以，如果某元件的几何尺寸发生了变化，需要重新布局，也就叫 reflow）reflow 会从这个 root frame 开始递归往下，依次计算所有的节点几何尺寸和位置，在 reflow 过程中，可能会增加一些 frame，比如一个文本字符串必需被包装起来。</li></ul></div><p>Reflow 的成本比 Repaint 的成本高得多的多。DOM Tree 里的每个节点都会有 reflow 方法，一个节点的 reflow 很有可能导致子节点，甚至父节点以及同级节点的 reflow。在一些高性能的电脑上也许还没什么，但是如果 reflow 发生在手机上，那么这个过程是非常痛苦和耗电的。</p><p>所以，下面这些动作有很大可能会是成本比较高的。</p><ul><li>当你增加、删除、修改 DOM 节点时，会导致 Reflow 或 Repaint</li><li>当你移动 DOM 的位置，或是搞个动画的时候。</li><li>当你修改 CSS 样式的时候。</li><li>当你 Resize 窗口的时候（移动端没有这个问题），或是滚动的时候。</li><li>当你修改网页的默认字体时。</li></ul><blockquote><p>注：display:none 会触发 reflow，而 visibility:hidden 只会触发 repaint，因为没有发现位置变化。</p></blockquote><p>通常来说，如果在滚屏的时候，我们的页面上的所有的像素都会跟着滚动，那么性能上没什么问题，因为我们的显卡对于这种把全屏像素往上往下移的算法是很快。但是如果你有一个 fixed 的背景图，或是有些 Element 不跟着滚动，有些 Elment 是动画，那么这个滚动的动作对于浏览器来说会是相当相当痛苦的一个过程。你可以看到很多这样的网页在滚动的时候性能有多差。因为滚屏也有可能会造成 reflow。</p><p>基本上来说，reflow 有如下的几个原因：</p><ol><li>Initial。网页初始化的时候。</li><li>Incremental。一些 Javascript 在操作 DOM Tree 时。</li><li>Resize。其些元件的尺寸变了。</li><li>StyleChange。如果 CSS 的属性发生变化了。</li><li>Dirty。几个 Incremental 的 reflow 发生在同一个 frame 的子树上。</li></ol><p>看个例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bstyle = <span class="built_in">document</span>.body.style; <span class="comment">// cache</span></span><br><span class="line"></span><br><span class="line">bstyle.padding = <span class="string">&quot;20px&quot;</span>; <span class="comment">// reflow, repaint</span></span><br><span class="line">bstyle.border = <span class="string">&quot;10px solid red&quot;</span>; <span class="comment">//  再一次的 reflow 和 repaint</span></span><br><span class="line"></span><br><span class="line">bstyle.color = <span class="string">&quot;blue&quot;</span>; <span class="comment">// repaint</span></span><br><span class="line">bstyle.backgroundColor = <span class="string">&quot;#fad&quot;</span>; <span class="comment">// repaint</span></span><br><span class="line"></span><br><span class="line">bstyle.fontSize = <span class="string">&quot;2em&quot;</span>; <span class="comment">// reflow, repaint</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// new DOM element – reflow, repaint</span></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(<span class="built_in">document</span>.createTextNode(<span class="string">&quot;dude&quot;</span>));</span><br></pre></td></tr></table></figure><p>当然，我们的浏览器是聪明的，它不会像上面那样，你每改一次样式，它就 reflow 或 repaint 一次。<strong>一般来说，浏览器会把这样的操作积攒一批，然后做一次 reflow，这又叫异步 reflow 或增量异步 reflow</strong>。但是有些情况浏览器是不会这么做的，比如：resize 窗口，改变了页面默认的字体，等。对于这些操作，浏览器会马上进行 reflow。</p><p>但是有些时候，我们的脚本会阻止浏览器这么干，比如：如果我们请求下面的一些 DOM 值：</p><ul><li>offsetTop, offsetLeft, offsetWidth, offsetHeight</li><li>scrollTop/Left/Width/Height</li><li>clientTop/Left/Width/Height</li><li>IE 中的 getComputedStyle(), 或 currentStyle</li></ul><p>因为，如果我们的程序需要这些值，那么浏览器需要返回最新的值，而这样一样会有一些样式的改变，从而造成频繁的 reflow/repaint。</p><hr><h2 id="减少重排-重绘"><a href="#减少重排-重绘" class="headerlink" title="减少重排/重绘"></a>减少重排/重绘</h2><ol><li>不要一条一条地修改 DOM 的样式。与其这样，还不如预先定义好 css 的 class，然后修改 DOM 的 className。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> left = <span class="number">10</span>,</span><br><span class="line">  top = <span class="number">10</span>;</span><br><span class="line">el.style.left = left + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">el.style.top = top + <span class="string">&quot;px&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line">el.className += <span class="string">&quot;theclassname&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Good</span></span><br><span class="line">el.style.cssText += <span class="string">&quot;; left: &quot;</span> + left + <span class="string">&quot;px; top: &quot;</span> + top + <span class="string">&quot;px;&quot;</span>;</span><br></pre></td></tr></table></figure><ol start="2"><li>把 DOM 离线后修改。<br> 如：<br> 使用 documentFragment 对象在内存里操作 DOM<br> 先把 DOM 给 display:none(有一次 reflow)，然后你想怎么改就怎么改。比如修改 100 次，然后再把他显示出来。<br> clone 一个 DOM 节点到内存里，然后想怎么改就怎么改，改完后，和在线的那个的交换一下。</li><li> 不要把 DOM 节点的属性值放在一个循环里当成循环里的变量。不然这会导致大量地读写这个节点的属性。</li><li> 尽可能的修改层级比较低的 DOM。当然，改变层级比较底的 DOM 有可能会造成大面积的 reflow，但是也可能影响范围很小。</li><li> 为动画的 HTML 元件使用 fixed 或 absoult 的 position，那么修改他们的 CSS 是不会 reflow 的。</li><li> 千万不要使用 table 布局。因为可能很小的一个小改动会造成整个 table 的重新布局。</li></ol><hr><p>转载自：<a href="https://coolshell.cn/articles/9666.html">https://coolshell.cn/articles/9666.html</a><br>推荐文章：<a href="http://taligarsiel.com/Projects/howbrowserswork1.htm">《How Browsers Work》</a></p>]]></content>
      
      
      <categories>
          
          <category> 浏览器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Browser </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React(一)：核心概念</title>
      <link href="xu4nht/"/>
      <url>xu4nht/</url>
      
        <content type="html"><![CDATA[<h2 id="React-简介"><a href="#React-简介" class="headerlink" title="React 简介"></a>React 简介</h2><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>React 起源于 Facebook 的内部项目，因为该公司对市场上所有 JavaScript MVC 框架，都不满意，就决定自己写一套，用来架设 Instagram 的网站。做出来以后，发现这套东西很好用，就在 2013 年 5 月开源了。</p><h3 id="react-是什么？"><a href="#react-是什么？" class="headerlink" title="react 是什么？"></a>react 是什么？</h3><p>React 是一个用于构建用户界面的 JavaScript 库。用于构建快速、高效的用户界面；它是一个轻量级库，遵循组件化设计模式、声明式编程范式以及函数式编程概念。它使用虚拟 DOM 来有效地操作 DOM；遵循从高阶组件到低阶组件的单向数据流。</p><blockquote><p>在整个 Web 应用的 MVC 架构中，你可以将 React 看作为视图层，并且是一个高效的视图。React 提供了和以往不一样的方式来看待视图，它以组件开发为基础。对 React 应用而言，你需要分割你的页面，使其成为一个个的组件。也就是说，你的应用是由这些组件组合而成的。你可以通过分割组件的方式去开发复杂的页面或某个功能区块，并且组件是可以被复用的。这个过程大概类似于用乐高积木去拼装不同的物体。</p></blockquote><hr><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><ul><li>采用组件化模式、声明式编码；提高开发效率和组件复用率</li><li>使用虚拟 DOM 和 diffing 算法，减少与真实 DOM 的交互</li><li>与已知的库或框架完好配合，相对灵活</li><li>使用 JSX 语法糖</li><li>单向数据流</li></ul><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/vdom.jpg"></p><hr><h2 id="Virtual-DOM"><a href="#Virtual-DOM" class="headerlink" title="Virtual DOM"></a>Virtual DOM</h2><p>为了跟踪模型层的变化，并且将其应用到 DOM 中（也就是渲染），我们需要注意两个重要的事情：</p><ul><li>数据是什么时候改变的<br>React 提供了一个观察者模型用于替代传统的脏检查（dirty checking），也就是持续的检查模型的变化。这也就是解释了为什么 React 不需要计算哪些发生了改变的原因，因为它会立即知道。这个过程减少了计算量，使应用程序变得更平滑。</li><li>哪一个（些）DOM 元素需要被更新<br>React 在内存中构建了 DOM 的树形表示，并且计算出哪个 DOM 元素应该被改变。对浏览器而言，DOM 操纵是比较耗费性能的，因此我们更倾向于让其变得最小化。幸运的是，React 视图尽可能少的触及到 DOM 元素。给予对象表示而言， 更少的 DOM 操纵意味着计算会更快，因此 DOM 改变也被尽可能的减少。<br>React 在底层实现了一个 diffing 算法，该算法使用 DOM 的树形表示法，当某个节点发生变化（标记为 dirty）时它会重新计算整个子树，你会注意到你的模型发生了改变，因为整个子树在之后会被重新渲染。</li></ul><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/vdom03.png"></p><h3 id="什么是虚拟-DOM？"><a href="#什么是虚拟-DOM？" class="headerlink" title="什么是虚拟 DOM？"></a>什么是虚拟 DOM？</h3><p>在 react 中，简单来说虚拟 DOM 其实就是 JS 对象，将真实 DOM 抽象成一个 javascript 对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">el</span>(<span class="params">name, props, child</span>) </span>&#123;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.props = props;</span><br><span class="line">    <span class="built_in">this</span>.child = child;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dom = <span class="keyword">new</span> el(<span class="string">&quot;div&quot;</span>, &#123; <span class="attr">id</span>: <span class="string">&quot;list&quot;</span> &#125;, [</span><br><span class="line">  <span class="keyword">new</span> el(<span class="string">&quot;span&quot;</span>, &#123; <span class="attr">id</span>: <span class="string">&quot;span_one&quot;</span> &#125;, [<span class="string">&quot;第一个元素&quot;</span>]),</span><br><span class="line">  <span class="keyword">new</span> el(<span class="string">&quot;span&quot;</span>, &#123; <span class="attr">id</span>: <span class="string">&quot;span_two&quot;</span> &#125;, [<span class="string">&quot;第二个元素&quot;</span>]),</span><br><span class="line">  <span class="keyword">new</span> el(<span class="string">&quot;span&quot;</span>, &#123; <span class="attr">id</span>: <span class="string">&quot;span_three&quot;</span> &#125;, [<span class="string">&quot;第三个元素&quot;</span>]),</span><br><span class="line">  <span class="keyword">new</span> el(<span class="string">&quot;span&quot;</span>, &#123; <span class="attr">id</span>: <span class="string">&quot;span_four&quot;</span> &#125;, [<span class="string">&quot;第四个元素&quot;</span>]),</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><p>这里的 dom 就是一个对象，里面包含了 name,props,child。<br>将对象转换成真实的 DOM:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">el.prototype.render = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> d = <span class="built_in">document</span>.createElement(<span class="built_in">this</span>.name);</span><br><span class="line">  <span class="keyword">for</span> (key <span class="keyword">in</span> <span class="built_in">this</span>.props) &#123;</span><br><span class="line">    d.setAttribute(key, <span class="built_in">this</span>.props[key]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">this</span>.child.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">child</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (child <span class="keyword">instanceof</span> el) &#123;</span><br><span class="line">      tnode = child.render();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      tnode = <span class="built_in">document</span>.createTextNode(child);</span><br><span class="line">    &#125;</span><br><span class="line">    d.appendChild(tnode);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> d;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ele = dom.render();</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(ele);</span><br></pre></td></tr></table></figure><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>在 React 中，也有一个 render 函数来将虚拟 DOM 树转换成真实 DOM，并且，React 中有 state 转移的过程，所以每次 state 有变化之后，就会触发 render 函数，重新构造一个虚拟 DOM 树。对比新旧虚拟 DOM 树的差别，记录下差异，然后只针对差异部分对应的真实 DOM 进行操作。</p><ul><li>如何进行新旧虚拟 DOM 树的对比？<br>这里采用的是 Diff 算法。Diff 算法比较复杂，主要的思路是这样的。<br>首先，每一次生成的虚拟 DOM 树上的各个节点都对应唯一的一个 id，当第二次生成了新的 DOM 树时，对原来树上的每一个节点对比新树上对应节点，如果不同，就记录下来这个差异。同时，差异也分为很多种：</li></ul><ol><li>替换节点</li><li>删除、移动、增加节点</li><li>修改属性</li><li>对文本内容做修改</li></ol><p>对每一类记录下差异后，针对不同的差异做不同的操作。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">比如：替换节点就需要调原生JS的repaceChild()接口；对于修改属性，则要调setAttribute()接口等等。</span><br></pre></td></tr></table></figure><hr><h2 id="JSX-语法"><a href="#JSX-语法" class="headerlink" title="JSX 语法"></a>JSX 语法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, Word!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br></pre></td></tr></table></figure><blockquote><p>像这样的形式，被称为 JSX；是 javascript 的语法扩展。JSX 的基本语法和 XML 基本相同，都是使用成对标签的形式构成树状结构的数据。</p></blockquote><h3 id="为什么使用-JSX？"><a href="#为什么使用-JSX？" class="headerlink" title="为什么使用 JSX？"></a>为什么使用 JSX？</h3><p>我们来看看 React 官方的回答：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/jsx.png"></p><p>简单来说，react 认为组件才是王道；而组件是和模板紧密关联的。组件模板和组件逻辑分离让问题复杂化了。<br>所以就有了 JSX 这种语法，就是为了把 HTML 模板直接嵌入到 JS 代码里面，这样就做到了模板和组件关联，但是 JS 不支持这种包含 HTML 的语法，所以需要通过工具将 JSX 编译输出成 JS 代码才能使用。</p><h3 id="JSX-是可选的"><a href="#JSX-是可选的" class="headerlink" title="JSX 是可选的"></a>JSX 是可选的</h3><p>因为 JSX 最终是输出成 JS 代码来表达的，所以我们可以直接用 React 提供的这些 DOM 构建方法来写模板，比如一个 JSX 写的一个链接：<br><code>&lt;a href=&quot;https://react.docschina.org/&quot;&gt;Hello!&lt;/a&gt;</code><br>用 js 来写的的话就是：<br><code>React.createElement(&#39;a&#39;, &#123;href: &#39;https://react.docschina.org/&#39;&#125;, &#39;Hello!&#39;)</code></p><p>JSX 语法糖允许前端开发者使用我们最熟悉的类 HTML 标签语法来创建虚拟 DOM 在降低学习成本的同时，也提升了研发效率与研发体验。</p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h4 id="标签类型"><a href="#标签类型" class="headerlink" title="标签类型"></a>标签类型</h4><ul><li>DOM 类型的标签(div,span 等)， 使用时，标签首字母必须小写</li><li>React 组件类型的标签，使用时，组件名称的首字母必须大写</li></ul><p>React 通过首字母的大小写来判断渲染的是 DOM 类型标签还是 React 组件类型标签。</p><h4 id="JS-表达式"><a href="#JS-表达式" class="headerlink" title="JS 表达式"></a>JS 表达式</h4><p>JSX 的本质是 javascript，在 JSX 中使用 JS 表达式需要用{}包裹起来。</p><ul><li>使用场景</li></ul><ol><li>通过表达式给标签属性赋值<br><code>const dom = &lt;Child data=&#123; 1 + 1 &#125; /&gt;</code></li><li>通过表达式定义子组件</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;li01&#x27;</span>,<span class="string">&#x27;li02&#x27;</span>,<span class="string">&#x27;li03&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dom = &#123;</span><br><span class="line">  &lt;ul&gt;</span><br><span class="line">    arr.map(<span class="function"><span class="params">item</span>=&gt;</span>&#123;<span class="xml"><span class="tag">&lt;<span class="name">Item</span> <span class="attr">msg</span>=<span class="string">&#123;item&#125;</span> <span class="attr">key</span>=<span class="string">&#123;item&#125;</span> /&gt;</span></span>&#125;)</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="标签属性"><a href="#标签属性" class="headerlink" title="标签属性"></a>标签属性</h4><ol><li>当 JSX 标签是 DOM 类型的标签时，对应的 DOM 标签支持的属性 JSX 也支持，部分属性名称有所变化，例如 class 写成 className,之所以改变是因为 React 对 DOM 标签支持的事件重新做了封装。事件属性名称采用驼峰格式。</li><li>当 JSX 标签是 React 组件类型时，可以自定义标签的属性名。</li></ol><h4 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h4><p>JSX 的注释需要大括号”{}”将/**/包裹起来。</p><hr><h2 id="元素渲染"><a href="#元素渲染" class="headerlink" title="元素渲染"></a>元素渲染</h2><blockquote><p>元素是构成 React 应用的最小砖块。</p></blockquote><h3 id="将一个元素渲染为-DOM"><a href="#将一个元素渲染为-DOM" class="headerlink" title="将一个元素渲染为 DOM"></a>将一个元素渲染为 DOM</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dom = <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, Word!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">ReactDOM.render(dom, <span class="built_in">document</span>.getElementById(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="更新已渲染元素"><a href="#更新已渲染元素" class="headerlink" title="更新已渲染元素"></a>更新已渲染元素</h3><p>React 元素是不可变对象。一旦被创建，你就无法更改它的子元素或者属性。一个元素就像电影的单帧：它代表了某个特定时刻的 UI。更新 UI 唯一的方式是创建一个全新的元素，并将其传入 ReactDOM.render()。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> element = (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Hello, world!&lt;/h1&gt;</span><br><span class="line">      &lt;h2&gt;It is &#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString()&#125;.&lt;/h2&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">  ReactDOM.render(element, <span class="built_in">document</span>.getElementById(<span class="string">&quot;root&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setInterval</span>(tick, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure><h3 id="React-只更新它需要更新的部分"><a href="#React-只更新它需要更新的部分" class="headerlink" title="React 只更新它需要更新的部分"></a>React 只更新它需要更新的部分</h3><p>ReactDOM 会将元素和它的子元素与它们之前的状态进行比较，并只会进行必要的更新来使 DOM 达到预期的状态。</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/timeout.gif"></p><p>尽管每一秒都会新建一个描述整个 UI 树的元素，ReactDOM 只会更新实际改变了的内容。</p><hr><h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><h3 id="组件的定义"><a href="#组件的定义" class="headerlink" title="组件的定义"></a>组件的定义</h3><p>定义组件的两种方式：</p><ul><li>使用函数（函数组件）</li><li>使用 ES6 class（类组件）</li></ul><h4 id="函数组件"><a href="#函数组件" class="headerlink" title="函数组件"></a>函数组件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Funcomponent</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是函数组件，&#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>该函数是一个有效的 React 组件，因为它接收唯一带有数据的 “props”（代表属性）对象并返回一个 React 元素。这类组件被称为“函数组件”，因为它本质上就是 JavaScript 函数。</p></blockquote><h4 id="class-类组件"><a href="#class-类组件" class="headerlink" title="class 类组件"></a>class 类组件</h4><p>使用 class 定义组件满足的两个条件：</p><ol><li>class 继承自 React.Component。</li><li>class 内部必须自定义 render 方法,render 方法返回代表该组件 UI 的 React 元素。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Classcomponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是类组件，&#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="组件渲染"><a href="#组件渲染" class="headerlink" title="组件渲染"></a>组件渲染</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">name</span>=<span class="string">&quot;child&quot;</span> /&gt;</span></span>;</span><br></pre></td></tr></table></figure><blockquote><p>当 React 元素为用户自定义组件时，它会将 JSX 所接收的属性（attributes）以及子组件（children）转换为单个对象传递给组件，这个对象被称之为 “props”。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello！&#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">name</span>=<span class="string">&quot;函数式组件&quot;</span> /&gt;</span></span>;</span><br><span class="line">ReactDOM.render(element, <span class="built_in">document</span>.getElementById(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><p>来看看上述例子都做了什么？</p><ul><li>调用 ReactDOM.render()函数，并传入&lt; Child name=”函数式组件” /&gt;作为参数。</li><li>React 调用 Child 组件，并将{name: ‘函数式组件’}作为 props 传入。</li><li>Child 组件将&lt; h1 &gt;Hello！函数式组件&lt;/ h1 &gt;元素作为返回值。</li><li>React DOM 将 DOM 高效地更新为&lt; h1 &gt;Hello！函数式组件&lt;/ h1 &gt;。</li></ul><h3 id="组合、嵌套组件"><a href="#组合、嵌套组件" class="headerlink" title="组合、嵌套组件"></a>组合、嵌套组件</h3><blockquote><p>将一个组件渲染到某一个节点里的时候，会将这个节点里原有内容覆盖。组件嵌套的方式就是将子组件写入到父组件的模板中去，且 React 没有 Vue 中的内容分发机制（slot），所以我们在一个组件的模板中只能看到父子关系</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从 react 的包当中引入了 React 和 React.js 的组件父类 Component</span></span><br><span class="line"><span class="comment">// 还引入了一个React.js里的一种特殊的组件 Fragment</span></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component, Fragment &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Title</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">render () &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">&lt;h1&gt;Hello,React&lt;/h1&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Content</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">render () &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">&lt;p&gt;React.js是一个用于构建用户界面的JavaScript库&lt;/p&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/** 由于每个React组件只能有一个根节点，所以要渲染多个组件的时候，需要在最外层包一个容器，如果使用div, 会生成多余的一层dom</span></span><br><span class="line"><span class="comment">class App extends Component &#123;</span></span><br><span class="line"><span class="comment">  render () &#123;</span></span><br><span class="line"><span class="comment">    return (</span></span><br><span class="line"><span class="comment">      &lt;div&gt;</span></span><br><span class="line"><span class="comment">        &lt;Title /&gt;</span></span><br><span class="line"><span class="comment">        &lt;Content /&gt;</span></span><br><span class="line"><span class="comment">      &lt;/div&gt;</span></span><br><span class="line"><span class="comment">    )</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">// 如果不想生成多余的一层dom可以使用React提供的Fragment组件在最外层进行包裹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;Fragment&gt;</span><br><span class="line">        &lt;Title /&gt;</span><br><span class="line">        &lt;Content /&gt;</span><br><span class="line">      &lt;/Fragment&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">&lt;App/&gt;,</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="Props（组件的数据挂载方式）"><a href="#Props（组件的数据挂载方式）" class="headerlink" title="Props（组件的数据挂载方式）"></a>Props（组件的数据挂载方式）</h3><h4 id="属性-props（只读性）"><a href="#属性-props（只读性）" class="headerlink" title="属性 props（只读性）"></a>属性 props（只读性）</h4><p>props 是由外部传进来的，也可以由组件内部设置初始化的 props；组件无论是使用函数式组件还是 class 组件，都不能修改自身的 props。可以通过父组件主动重新渲染的方式来传入新的 props。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component, Fragment &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Title</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;h1&gt;Hello,&#123;<span class="built_in">this</span>.props.name&#125;&lt;/h1&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Conent = <span class="function">(<span class="params">props</span>)=&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;p&gt;&#123;props.name&#125;是一个用于构建用户界面的JavaScript库&lt;/p&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">      &lt;Fragment&gt;</span><br><span class="line">        &lt;Title name=<span class="string">&quot;React&quot;</span> /&gt;</span><br><span class="line">        &lt;Conent name=<span class="string">&quot;React.js&quot;</span> /&gt;</span><br><span class="line">      &lt;/Fragment&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">&lt;App/&gt;,</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="设置组件的默认-props"><a href="#设置组件的默认-props" class="headerlink" title="设置组件的默认 props"></a>设置组件的默认 props</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component, Fragment &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Title</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="comment">// 使用类创建的组件，直接在这里写static方法，创建defaultProps</span></span><br><span class="line">  <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">    name: <span class="string">&#x27;React&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;h1&gt;Hello,&#123;<span class="built_in">this</span>.props.name&#125;&lt;/h1&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Conent = <span class="function">(<span class="params">props</span>)=&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;p&gt;&#123;props.name&#125;是一个用于构建用户界面的JavaScript库&lt;/p&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用箭头函数创建的组件，需要在这个组件上直接写defaultProps属性</span></span><br><span class="line">Content.defaultProps = &#123;</span><br><span class="line">name: <span class="string">&#x27;React.js&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">      &lt;Fragment&gt;</span><br><span class="line">      &#123;<span class="comment">/* 由于设置了defaultProps， 不传props也能正常运行，如果传递了就会覆盖defaultProps的值 */</span>&#125;</span><br><span class="line">        &lt;Title /&gt;</span><br><span class="line">        &lt;Conent /&gt;</span><br><span class="line">      &lt;/Fragment&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">&lt;App/&gt;,</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="props-children"><a href="#props-children" class="headerlink" title="props.children"></a>props.children</h4><p>我们知道使用组件的时候，可以嵌套。要在自定义组件的使用嵌套结构，就需要使用 props.children。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component, Fragment &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Title</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;h1&gt;Hello,&#123;<span class="built_in">this</span>.props.children&#125;&lt;/h1&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Conent = <span class="function">(<span class="params">props</span>)=&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;p&gt;&#123;props.children&#125;&lt;/p&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">      &lt;Fragment&gt;</span><br><span class="line">        &lt;Title&gt;React&lt;/Title&gt;</span><br><span class="line">        &lt;Conent&gt;<span class="xml"><span class="tag">&lt;<span class="name">strong</span>&gt;</span>React.js<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span>是一个用于构建用户界面的JavaScript库&lt;/Conent&gt;</span><br><span class="line">      &lt;/Fragment&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">&lt;App/&gt;,</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="prop-types"><a href="#prop-types" class="headerlink" title="prop-types"></a>prop-types</h4><blockquote><p>React 其实是为了构建大型应用程序而生, 在一个大型应用中，根本不知道别人使用你写的组件的时候会传入什么样的参数，有可能会造成应用程序运行不了，但是不报错。为了解决这个问题，React 提供了一种机制，让写组件的人可以给组件的 props 设定参数检查，需要安装和使用 prop-types:</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i prop-types -S</span><br></pre></td></tr></table></figure><hr><h2 id="State（状态）"><a href="#State（状态）" class="headerlink" title="State（状态）"></a>State（状态）</h2><div class="note primary modern"><p>组件的 state 是组件内部的状态，state 的变化最终将反映在组件 UI 的变化上。在构造方法 constructor 中通过 this.state 定义组件的初始状态，并调用 this.setState 方法改变组件的状态。</p></div><h3 id="定义-state"><a href="#定义-state" class="headerlink" title="定义 state"></a>定义 state</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component, Fragment &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">super</span>()</span><br><span class="line">    <span class="built_in">this</span>.state = &#123;</span><br><span class="line">      name: <span class="string">&#x27;React&#x27;</span>,</span><br><span class="line">      bool: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Welcome to &#123;<span class="built_in">this</span>.state.name&#125; Word！&lt;/h1&gt;</span><br><span class="line">        &lt;button&gt;&#123;<span class="built_in">this</span>.state.bool ? <span class="string">&#x27;YES&#x27;</span> : <span class="string">&#x27;NO&#x27;</span>&#125;&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">&lt;App/&gt;,</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>)</span><br></pre></td></tr></table></figure><div class="note info modern"><p>this.props 和 this.state 是纯 js 对象,在 vue 中，data 属性是利用 Object.defineProperty 处理过的，更改 data 的数据的时候会触发数据的 getter 和 setter，但是 React 中没有做这样的处理，如果直接更改的话，react 是无法得知的，所以，需要使用特殊的更改状态的方法 setState。</p></div><h3 id="setState"><a href="#setState" class="headerlink" title="setState"></a>setState</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component, Fragment &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">super</span>()</span><br><span class="line">    <span class="built_in">this</span>.state = &#123;</span><br><span class="line">      name: <span class="string">&#x27;React&#x27;</span>,</span><br><span class="line">      bool: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 添加点击事件</span></span><br><span class="line">  handleBtn = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.setState = (&#123;</span><br><span class="line">      bool: !<span class="built_in">this</span>.state.bool</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Welcome to &#123;<span class="built_in">this</span>.state.name&#125; Word！&lt;/h1&gt;</span><br><span class="line">        &lt;button onClick=&#123;<span class="built_in">this</span>.handleBtn&#125;&gt;&#123;<span class="built_in">this</span>.state.bool ? <span class="string">&#x27;YES&#x27;</span> : <span class="string">&#x27;NO&#x27;</span>&#125;&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">&lt;App/&gt;,</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>)</span><br></pre></td></tr></table></figure><p>setState 有两个参数：</p><div class="tabs" id="参数"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#参数-1">参数是对象</button></li><li class="tab"><button type="button" data-href="#参数-2">参数是方法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="参数-1"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.setState = &#123;</span><br><span class="line">  bool: !<span class="built_in">this</span>.state.bool,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="参数-2"><div class="note warning modern"><p>注意的是这个方法接收两个参数，第一个是上一次的 state, 第二个是 props<br>setState 是异步的，所以想要获取到最新的 state，没有办法获取，就有了第二个参数，这是一个可选的回调函数</p></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.setState =</span><br><span class="line">  (<span class="function">(<span class="params">preState, props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      bool: !preState.bool,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;callback&quot;</span>, <span class="built_in">this</span>.state.bool);</span><br><span class="line">  &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;setState&quot;</span>, <span class="built_in">this</span>.state.bool);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="Props-和-State-对比"><a href="#Props-和-State-对比" class="headerlink" title="Props 和 State 对比"></a>Props 和 State 对比</h2><div class="tabs" id="props和state对比"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#props和state对比-1">相似点</button></li><li class="tab"><button type="button" data-href="#props和state对比-2">不同点</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="props和state对比-1"><p><strong>都是纯 js 对象，都会触发 render 更新，都具有确定性（状态/属性相同，结果相同）</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="props和state对比-2"><table><thead><tr><th>Props</th><th>State</th></tr></thead><tbody><tr><td>能从父组件获取</td><td>不能</td></tr><tr><td>可以由父组件修改</td><td>不可以</td></tr><tr><td>能在内部设置默认值</td><td>不能</td></tr><tr><td>不在组件内部修改</td><td>要改</td></tr><tr><td>能设置子组件初始值</td><td>不可以</td></tr><tr><td>可以修改子组件的值</td><td>不可以</td></tr><tr><td>主要作用是让使用该组件的父组件可以传入参数来配置该组件。它是外部传进来的配置参数，组件内部无法控制也无法修改。除非外部组件主动传入新的 props，否则组件的 props 永远保持不变。</td><td>主要作用是用于组件保存、控制、修改自己的可变状态。state 在组件内部初始化，可以被组件自身修改，而外部不能访问也不能修改。你可以认为 state 是一个局部的、只能被组件自身控制的数据源。state 中状态可以通过 this.setState 方法进行更新，setState 会导致组件的重新渲染。</td></tr></tbody></table><div class="note success modern"><p>React 组件是通过 props 和 state 两种数据驱动渲染出组件 UI。Props 是组件对外的接口，它是只读的，组件通过 props 接受外部传入的数据；state 是组件对内的接口，它是可变的，组件内部状态通过 state 来反映。</p></div><p>如果搞不清 state 和 props 的使用场景，记住一个简单的规则：尽量少地用 state，多用 props。<br>没有 state 的组件叫无状态组件（stateless component），设置了 state 的叫做有状态组件（stateful component）。因为状态会带来管理的复杂性，我们尽量多地写无状态组件，尽量少地写有状态的组件。这样会降低代码维护的难度，也会在一定程度上增强组件的可复用性。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p><strong><em>状态提升</em></strong></p><ul><li>如果有多个组件共享一个数据，把这个数据放到共同的父级组件中来管理<br>具体操作可以查看 React 文档：<a href="https://react.docschina.org/docs/lifting-state-up.html">状态提升</a></li></ul><hr><h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><div class="tabs" id="生命周期"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#生命周期-1">React旧版生命周期</button></li><li class="tab"><button type="button" data-href="#生命周期-2">React新版生命周期</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="生命周期-1"><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/oldComponent.png"></p><ul><li>第一次渲染<br>constructor → componentWillMount → render → componentDidMount</li><li>props 更新<br>componentWillReceiveProps → shouldComponentUpdate(如果返回 true) → componentWillUpdate → render → componentDidUpdate</li><li>state 更新<br>shouldComponentUpdate (如果返回 true)→ componentWillUpdate → render → componentDidUpdate</li><li>组件卸载<br>componentWillUnmount</li></ul><p><strong>React 旧版生命周期包含三个过程：</strong></p><ol><li>挂载过程<br> constructor()<br> componentWillMount()<br> componentDidMount()</li><li>更新过程<br> componentWillReceiveProps(nextProps)<br> shouldComponentUpdate(nextProps,nextState)<br> componentWillUpdate (nextProps,nextState)<br> render()<br> componentDidUpdate(prevProps,prevState)</li><li>卸载过程<br> componentWillUnmount()</li></ol><p><strong>其具体作用分别为：</strong></p><ul><li><strong>constructor()</strong><br>完成了 React 数据的初始化。</li><li><strong>componentWillMount()</strong><br>组件已经完成初始化数据，但是还未渲染 DOM 时执行的逻辑，主要用于服务端渲染。</li><li><strong>componentDidMount()</strong><br>组件第一次渲染完成时执行的逻辑，此时 DOM 节点已经生成了。</li><li><strong>componentWillReceiveProps(nextProps)</strong><br>接收父组件新的 props 时，重新渲染组件执行的逻辑。</li><li><strong>shouldComponentUpdate(nextProps, nextState)</strong><br>在 setState 以后，state 发生变化，组件会进入重新渲染的流程时执行的逻辑。在这个生命周期中 return false 可以阻止组件的更新，主要用于性能优化。</li><li><strong>componentWillUpdate(nextProps, nextState)</strong><br>shouldComponentUpdate 返回 true 以后，组件进入重新渲染的流程时执行的逻辑。</li><li><strong>render()</strong><br>页面渲染执行的逻辑，render 函数把 jsx 编译为函数并生成虚拟 dom，然后通过其 diff 算法比较更新前后的新旧 DOM 树，并渲染更改后的节点。</li><li><strong>componentDidUpdate(prevProps, prevState)</strong><br>重新渲染后执行的逻辑。</li><li><strong>componentWillUnmount()</strong><br>组件的卸载前执行的逻辑，比如进行“清除组件中所有的 setTimeout、setInterval 等计时器”或“移除所有组件中的监听器 removeEventListener”等操作。</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="生命周期-2"><p><em>​</em></p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/newComponent.png"></p><p>所不同的是少了 componentWillMount, componentWillReceiveProps, componentWillUpdate 这三个鸡肋，其实这三个生命周期回调要直到 v17 才会被完全删除，不过现在都被冠以 UNSAFE_的前缀了。</p><p>多了两个是 getDerivedStateFromProps 和 getSnapshotBeforeUpdate，其中 getDerivedStateFromProps 在第一次渲染和更新的时候都会被调用，而 getSnapshotBeforeUpdate 只会在更新的时候被调用。</p><ul><li><p><strong>使用 getDerivedStateFromProps(nextProps, prevState)的原因：</strong></p><div class="note primary modern"><p>  旧的 React 中 componentWillReceiveProps 方法是用来判断前后两个 props 是否相同，如果不同，则将新的 props 更新到相应的 state 上去。在这个过程中我们实际上是可以访问到当前 props 的，这样我们可能会对 this.props 做一些奇奇怪怪的操作，很可能会破坏 state 数据的单一数据源，导致组件状态变得不可预测。</p><p>而在 getDerivedStateFromProps 中禁止了组件去访问 this.props，强制让开发者去比较 nextProps 与 prevState 中的值，以确保当开发者用到 getDerivedStateFromProps 这个生命周期函数时，就是在根据当前的 props 来更新组件的 state，而不是去访问 this.props 并做其他一些让组件自身状态变得更加不可预测的事情。</p></div></li><li><p><strong>使用 getSnapshotBeforeUpdate(prevProps, prevState)的原因：</strong></p><div class="note primary modern"><p>  在 React 开启异步渲染模式后，在执行函数时读到的 DOM 元素状态并不总是渲染时相同，这就导致在 componentDidUpdate 中使用 componentWillUpdate 中读取到的 DOM 元素状态是不安全的，因为这时的值很有可能已经失效了。</p><p>而 getSnapshotBeforeUpdate 会在最终的 render 之前被调用，也就是说在 getSnapshotBeforeUpdate 中读取到的 DOM 元素状态是可以保证与 componentDidUpdate 中一致的。</p></div></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><h2 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h2><h3 id="绑定事件"><a href="#绑定事件" class="headerlink" title="绑定事件"></a>绑定事件</h3><p>React 元素的事件处理和 DOM 元素很相似，都是采用 on+事件名称的方式绑定事件。但不同的是原生事件采用的是纯小写形式，如：onclick；而 React 的事件使用小驼峰的形式，如：onClick；使用 JSX 语法时你需要传入一个函数作为事件处理函数，而不是一个字符串。</p><div class="note info modern"><p>React 的事件不是原生事件，而是合成事件。</p></div><p>传统 HTML:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;clickActive()&quot;</span>&gt;</span>BUTTON<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>React:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&quot;&#123;clickActive&#125;&quot;</span>&gt;</span>BUTTON<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="事件-handler-的写法"><a href="#事件-handler-的写法" class="headerlink" title="事件 handler 的写法"></a>事件 handler 的写法</h3><ul><li>直接在 render 里写行内的箭头函数(不推荐)</li><li>在组件内使用箭头函数定义一个方法(推荐)</li><li>直接在组件内定义一个非箭头函数的方法，然后在 render 里直接使用 onClick={this.handleClick.bind(this)}(不推荐)</li><li>直接在组件内定义一个非箭头函数的方法，然后在 constructor 里 bind(this)(推荐)</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Toggle</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(props);</span><br><span class="line">    <span class="built_in">this</span>.state = &#123; <span class="attr">isToggleOn</span>: <span class="literal">true</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 为了在回调中使用 `this`，这个绑定是必不可少的</span></span><br><span class="line">    <span class="built_in">this</span>.handleClick = <span class="built_in">this</span>.handleClick.bind(<span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">handleClick</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.setState(<span class="function">(<span class="params">state</span>) =&gt;</span> (&#123;</span><br><span class="line">      isToggleOn: !state.isToggleOn,</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;button onClick=&#123;<span class="built_in">this</span>.handleClick&#125;&gt;</span><br><span class="line">        &#123;<span class="built_in">this</span>.state.isToggleOn ? <span class="string">&quot;ON&quot;</span> : <span class="string">&quot;OFF&quot;</span>&#125;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">Toggle</span> /&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="Event-对象"><a href="#Event-对象" class="headerlink" title="Event 对象"></a>Event 对象</h3><p>和普通浏览器一样，事件 handler 会被自动传入一个 event 对象，这个对象和普通的浏览器 event 对象所包含的方法和属性都基本一致。不同的是 React 中的 event 对象并不是浏览器提供的，而是它自己内部所构建的。它同样具有 event.stopPropagation、event.preventDefault 这种常用的方法</p><blockquote><p>因此，在 React 中你不能通过返回 false 的方式阻止默认行为。你必须显式的使用 preventDefault。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;console.log(&#x27;click&#x27;); return false&quot;</span>&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Active</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">clickLink</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;clickLink&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="向事件处理程序传递参数"><a href="#向事件处理程序传递参数" class="headerlink" title="向事件处理程序传递参数"></a>向事件处理程序传递参数</h3><ol><li>在 render 里调用方法的地方包一层箭头函数</li><li>在 render 里通过 this.handleEvent.bind(this, 参数)这样的方式来传递</li><li>通过 event 传递</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;(e)</span> =&gt;</span> this.deleteRow(id, e)&#125;&gt;Delete Row<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.deleteRow.bind(this,</span> <span class="attr">id</span>)&#125;&gt;</span>Delete Row<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h2><p>在 React 中，你可以创建不同的组件来封装各种你需要的行为。然后，依据应用的不同状态，你可以只渲染对应状态下的部分内容。</p><div class="note primary modern"><p>React 中的条件渲染和 JavaScript 中的一样，使用 JavaScript 运算符 if 或者条件运算符去创建元素来表现当前的状态，然后让 React 根据它们来更新 UI。</p></div><h3 id="条件表达式渲染（适用于两个组件二选一的渲染）"><a href="#条件表达式渲染（适用于两个组件二选一的渲染）" class="headerlink" title="条件表达式渲染（适用于两个组件二选一的渲染）"></a>条件表达式渲染（适用于两个组件二选一的渲染）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> isLoggedIn = <span class="built_in">this</span>.state.isLoggedIn;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;isLoggedIn ? (</span><br><span class="line">        &lt;LogoutButton onClick=&#123;<span class="built_in">this</span>.handleLogoutClick&#125; /&gt;</span><br><span class="line">      ) : (</span><br><span class="line">        &lt;LoginButton onClick=&#123;<span class="built_in">this</span>.handleLoginClick&#125; /&gt;</span><br><span class="line">      )&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="amp-amp-操作符渲染-适用于一个组件有无的渲染"><a href="#amp-amp-操作符渲染-适用于一个组件有无的渲染" class="headerlink" title="&amp;&amp; 操作符渲染 (适用于一个组件有无的渲染)"></a>&amp;&amp; 操作符渲染 (适用于一个组件有无的渲染)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Mailbox</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> messages = props.messages;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Hello!&lt;/h1&gt;</span><br><span class="line">      &#123;messages.length &gt; <span class="number">0</span> &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>You have &#123;messages.length&#125; messages.<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span>&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="利用变量输出组件渲染-（适用于有多个组件多种条件下的渲染）"><a href="#利用变量输出组件渲染-（适用于有多个组件多种条件下的渲染）" class="headerlink" title="利用变量输出组件渲染 （适用于有多个组件多种条件下的渲染）"></a>利用变量输出组件渲染 （适用于有多个组件多种条件下的渲染）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> isLoggedIn = <span class="built_in">this</span>.state.isLoggedIn;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> button = isLoggedIn ? (</span><br><span class="line">      &lt;LogoutButton onClick=&#123;<span class="built_in">this</span>.handleLogoutClick&#125; /&gt;</span><br><span class="line">    ) : (</span><br><span class="line">      &lt;LoginButton onClick=&#123;<span class="built_in">this</span>.handleLoginClick&#125; /&gt;</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Greeting isLoggedIn=&#123;isLoggedIn&#125; /&gt;</span><br><span class="line">        &#123;button&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="利用函数方法输出组件或者利用函数式组件进行渲染-（适用于多个子组件需要根据复杂的条件输出的情况）"><a href="#利用函数方法输出组件或者利用函数式组件进行渲染-（适用于多个子组件需要根据复杂的条件输出的情况）" class="headerlink" title="利用函数方法输出组件或者利用函数式组件进行渲染 （适用于多个子组件需要根据复杂的条件输出的情况）"></a>利用函数方法输出组件或者利用函数式组件进行渲染 （适用于多个子组件需要根据复杂的条件输出的情况）</h3><h4 id="函数方式"><a href="#函数方式" class="headerlink" title="函数方式"></a>函数方式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">renderButton</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> isLoggedIn = <span class="built_in">this</span>.state.isLoggedIn;</span><br><span class="line">    <span class="keyword">if</span>(isLoggedIn)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">LogoutButton</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleLogoutClick&#125;</span> /&gt;</span></span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">LoginButton</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleLoginClick&#125;</span> /&gt;</span></span>);</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Greeting /&gt;</span><br><span class="line">        &#123;<span class="built_in">this</span>.renderButton()&#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h4 id="函数式组件"><a href="#函数式组件" class="headerlink" title="函数式组件"></a>函数式组件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Greeting</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> isLoggedIn = props.isLoggedIn;</span><br><span class="line">  <span class="keyword">if</span> (isLoggedIn) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">UserGreeting</span> /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">GuestGreeting</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Greeting isLoggedIn=&#123;<span class="literal">false</span>&#125; /&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><hr><h2 id="列表和-key"><a href="#列表和-key" class="headerlink" title="列表和 key"></a>列表和 key</h2><p>当列表数据为多组时，调用数据运行时为提示警告：“Each child in an array or iterator should have a unique ‘ key ’ prop ”说明如果没有给每条数据添加一个“key” 的话，当数据组数过多时，不同组数有相同的数据，调用就可能会出现错误。因此这里的“key”就相当于数据库里的主键，给每组数据调取都有一个参照。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ListItem</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 正确！这里不需要指定 key：</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;props.value&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NumberList</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> numbers = props.numbers;</span><br><span class="line">  <span class="keyword">const</span> listItems = numbers.map(<span class="function">(<span class="params">number</span>) =&gt;</span> (</span><br><span class="line">    <span class="comment">// 正确！key 应该在数组的上下文中被指定</span></span><br><span class="line">    &lt;ListItem key=&#123;number.toString()&#125; value=&#123;number&#125; /&gt;</span><br><span class="line">  ));</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;listItems&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;NumberList numbers=&#123;numbers&#125; /&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><div class="note success modern"><ul><li>key 帮助 React 识别哪些元素改变了，比如被添加或删除。因此你应当给数组中的每一个元素赋予一个确定的标识。</li><li>虽然列表元素的 key 不能重复，但这个唯一性仅限至于在当前列表中，而不是全局唯一。</li><li>不推荐使用索引作为 key，因为一旦列表中的数据发生重排，数据的索引也会发生变化，不利于 React 的渲染优化。</li></ul></div><hr><h2 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h2><h3 id="受控组件"><a href="#受控组件" class="headerlink" title="受控组件"></a>受控组件</h3><blockquote><p>什么受控组件？简单来说就是如果一个表单元素的值是由 React 来管理的，那它就是一个受控组件。</p></blockquote><p>贴一段 React 官网的解释：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/input.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Inputs</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">props</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(props);</span><br><span class="line">    <span class="built_in">this</span>.state = &#123;</span><br><span class="line">      name: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      password: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">handleChange</span>(<span class="params">event</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> e = event.target;</span><br><span class="line">    <span class="built_in">this</span>.setState(&#123;</span><br><span class="line">      [e.name]: e.value,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">handleSubmit</span>(<span class="params">event</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Login Success!&quot;</span>);</span><br><span class="line">    event.preventDefault();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;form onSubmit=&#123;<span class="built_in">this</span>.handleSubmit&#125;&gt;</span><br><span class="line">                 </span><br><span class="line">        &lt;label&gt;</span><br><span class="line">                    用户名：</span><br><span class="line">          &lt;input</span><br><span class="line">            type=<span class="string">&quot;text&quot;</span></span><br><span class="line">            name=<span class="string">&quot;name&quot;</span></span><br><span class="line">            value=&#123;<span class="built_in">this</span>.state.name&#125;</span><br><span class="line">            onChange=&#123;<span class="built_in">this</span>.handleChange&#125;</span><br><span class="line">          /&gt;</span><br><span class="line">                   </span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">                 &lt;label&gt;</span><br><span class="line">                    密码：</span><br><span class="line">          &lt;input</span><br><span class="line">            type=<span class="string">&quot;password&quot;</span></span><br><span class="line">            name=<span class="string">&quot;password&quot;</span></span><br><span class="line">            value=&#123;<span class="built_in">this</span>.state.password&#125;</span><br><span class="line">            onChange=&#123;<span class="built_in">this</span>.handleChange&#125;</span><br><span class="line">          /&gt;</span><br><span class="line">                   </span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">                 </span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;登录&quot;</span> /&gt;</span><br><span class="line">      &lt;/form&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note success modern"><p>用户名和密码两个表单元素的值是从组件的 state 中获取的，当用户更改表单元素的值时，onChange 事件会被触发，对应的 handleChange 处理函数会把变化同步到组件的 state，新的 state 又会触发表单元素重新渲染，从而实现表单元素状态的控制。</p></div><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote><p>本章主要介绍了 React 的主要特性及其用法。React 通过 JSX 语法声明界面 UI，将界面 UI 和它的逻辑封装在同一个 JS 文件中。通过虚拟 DOM 和 diffing 算法来减少与真实 DOM 的交互。组件是 React 的核心，根据组件的外部接口 props 和内部接口 state 完成自身的渲染。使用组件需要理解它的生命周期，借助不同的生命周期方法，组件可以实现复杂逻辑。渲染时，注意 key 的使用，事件处理时，注意事件名称和事件处理函数的写法。最后介绍表单元素的用法，使用方式分受控组价和非受控组件。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS forEach 踩坑</title>
      <link href="ehgc3o/"/>
      <url>ehgc3o/</url>
      
        <content type="html"><![CDATA[<p>在 js 做遍历数组的时候会用到很多数组的遍历方法，例如 for 循环、forEach 之类的方法，今天主要来说说 forEach 方法的一些坑。<br>来看一下这段代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line">arr.forEach(<span class="function">(<span class="params">item, indec</span>) =&gt;</span> &#123;</span><br><span class="line">  arr.splice(index, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;执行&quot;</span>); <span class="comment">// 输出了几次？？？</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// arr ????</span></span><br></pre></td></tr></table></figure><h2 id="上述代码中，循环体内“执行”打印了几次？arr-的输出是多少？"><a href="#上述代码中，循环体内“执行”打印了几次？arr-的输出是多少？" class="headerlink" title="上述代码中，循环体内“执行”打印了几次？arr 的输出是多少？"></a>上述代码中，循环体内“执行”打印了几次？arr 的输出是多少？</h2><p>👌 好，我们带着这些疑问继续往下看。</p><h2 id="forEach-参数"><a href="#forEach-参数" class="headerlink" title="forEach 参数"></a>forEach 参数</h2><p>与 for 循环一样，forEach 也属于完整遍历数组的方法，并会对数组每项元素执行提供的回调函数，一个完整的 forEach 应该是这样，我们一一解释回调函数的参数，与后方的 this 有何作用。<br><code>arr.forEach(function(self,index,arr)&#123;&#125;,this)</code></p><ul><li>**<em>self</em>**：数组当前遍历的元素，默认从左往右依次获取数组元素</li><li>**<em>index</em>**：数组当前元素的索引</li><li>**<em>arr</em>**：当前遍历的数组</li><li>**<em>this</em>**：回调函数中的 this 指向</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">&#125;;</span><br><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">self, index, arr</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`当前元素为<span class="subst">$&#123;self&#125;</span>索引为<span class="subst">$&#123;index&#125;</span>,属于数组<span class="subst">$&#123;arr&#125;</span>`</span>);</span><br><span class="line">  <span class="comment">//做个简单计算</span></span><br><span class="line">  <span class="built_in">console</span>.log(self + <span class="built_in">this</span>.a);</span><br><span class="line">&#125;, obj);</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/each01.png"></p><p>可以看到，arr 参数其实就是我们正在遍历的数组，而回调函数中的 this 指向我们提供的 obj。</p><p>至于第三个参数 arr，遍历自己还提供自己作为参数，其实这个参数还挺好用，比如我们可以利用它做数组去重，像这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = [];</span><br><span class="line">arr1.forEach(<span class="function">(<span class="params">self, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">  arr.indexOf(self) === index ? arr2.push(self) : <span class="literal">null</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr2); <span class="comment">// [1,2,3,4]</span></span><br></pre></td></tr></table></figure><hr><h2 id="坑点"><a href="#坑点" class="headerlink" title="坑点"></a>坑点</h2><h3 id="1、不支持-break"><a href="#1、不支持-break" class="headerlink" title="1、不支持 break"></a>1、不支持 break</h3><p>大家都知道，在使用 for 循环时可以使用 break 跳出循环，比如我希望找到数组中符合条件的第一个元素就跳出循环，这对于优化数组遍历是非常棒的。很遗憾，forEach 并不支持 break 操作，使用 break 会导致报错。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], i = <span class="number">0</span>, length = arr.length;</span><br><span class="line"><span class="keyword">for</span> (; i &lt; length; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(arr[i]); <span class="comment">//1,2</span></span><br><span class="line">    <span class="keyword">if</span> (arr[i] === <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">arr.forEach(<span class="function">(<span class="params">self,index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(self);</span><br><span class="line">    <span class="keyword">if</span> (self === <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">//报错</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>要想跳过循环，需要通过 try catch 来操作；具体可以查看文章<a href="https://www.cnblogs.com/echolun/p/10651039.html">js forEach 跳出循环</a></p><h3 id="2、使用-return-无效"><a href="#2、使用-return-无效" class="headerlink" title="2、使用 return 无效"></a>2、使用 return 无效</h3><p>forEach 中使用 return 不会报错，但 rerutn 并不会生效，我们来看个例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find</span>(<span class="params">arr, num</span>) </span>&#123;</span><br><span class="line">  arr.forEach(<span class="function">(<span class="params">self, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (self === num) &#123;</span><br><span class="line">      <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> index = find(arr, <span class="number">2</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>上述代码想要找到数字 2 在数组中的索引，但 return 并不会起到终止代码运行并返回值的作用。<br>如果我们真的要用 return 返回某个值，那就只能将 return 操作放在函数中，而不是 forEach 循环中，像这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">find</span>(<span class="params">arr, num</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _index;</span><br><span class="line">  arr.forEach(<span class="function">(<span class="params">self, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (self === num) &#123;</span><br><span class="line">      _index = index;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> _index;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3、删除自身元素-index-不会被重置"><a href="#3、删除自身元素-index-不会被重置" class="headerlink" title="3、删除自身元素 index 不会被重置"></a>3、删除自身元素 index 不会被重置</h3><p>让我们回头看看文章开头的那段代码，那段代码其实只会执行一次，数组也不会被删除干净，这是因为 forEach 在遍历跑完回调函数后，会隐性让 index 自增，像这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arr.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">  arr.splice(index, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;执行&quot;</span>);</span><br><span class="line">  <span class="comment">//这里隐性让index自增加1</span></span><br><span class="line">  index++;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>当第一次遍历结束，此时数组为[2]而 index 变成了 1，此时数组最大索引只是 0，不满足条件，所以跳出了循环。<br>那有没有什么办法让此时的 forEach 不跳出循环呢，当然有，使用 ES6 的拓展运算符。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[...arr].forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">  arr.splice(index, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;执行&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>通过拓展运算符重置数组 arr，达到不跳出循环的目的，会发现内部确实执行了两次，很遗憾的是 index 依旧没被重置，所以数组 arr 还是无法在遍历的同时删空自己。</p><hr><h2 id="for、forEach-比较"><a href="#for、forEach-比较" class="headerlink" title="for、forEach 比较"></a>for、forEach 比较</h2><ol><li>for 循环可以使用 break 跳出循环，但 forEach 不能。</li><li>for 循环可以控制循环起点（i 初始化的数字决定循环的起点），forEach 只能默认从索引 0 开始。</li><li>for 循环过程中支持修改索引（修改 i），但 forEach 做不到（底层控制 index 自增，我们无法左右它）。</li></ol><hr><h2 id="数组遍历并删除自身"><a href="#数组遍历并删除自身" class="headerlink" title="数组遍历并删除自身"></a>数组遍历并删除自身</h2><p>怎么在遍历一个数组的同时，并删除符合条件的所有项呢？</p><h3 id="for-循环实现"><a href="#for-循环实现" class="headerlink" title="for 循环实现"></a>for 循环实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>],</span><br><span class="line">  i = <span class="number">0</span>,</span><br><span class="line">  length = arr.length;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (; i &lt; length; i++) &#123;</span><br><span class="line">  <span class="comment">// 删除数组中所有的1</span></span><br><span class="line">  <span class="keyword">if</span> (arr[i] === <span class="number">1</span>) &#123;</span><br><span class="line">    arr.splice(i, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//重置i，否则i会跳一位</span></span><br><span class="line">    i--;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// [2]</span></span><br></pre></td></tr></table></figure><h3 id="filter-实现"><a href="#filter-实现" class="headerlink" title="filter 实现"></a>filter 实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = arr.filter(<span class="function">(<span class="params">index</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> index !== <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr1); <span class="comment">//[2]</span></span><br></pre></td></tr></table></figure><h3 id="forEach-实现（不建议）"><a href="#forEach-实现（不建议）" class="headerlink" title="forEach 实现（不建议）"></a>forEach 实现（不建议）</h3><p>forEach 因为 index 索引无法重置，对于删除数组项真的很困难，我们得让数组反过来遍历：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br><span class="line">  .slice()</span><br><span class="line">  .reverse()</span><br><span class="line">  .forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item, index, arr1</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (item === <span class="number">1</span>) &#123;</span><br><span class="line">      arr.splice(arr1.length - <span class="number">1</span> - index, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">//[2]</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Promise(三)：拓展方法实现</title>
      <link href="ddv8fu/"/>
      <url>ddv8fu/</url>
      
        <content type="html"><![CDATA[<p>上次把 Promise 简单的实现了基本功能，趁热打铁，我们来实现一下它里面的拓展方法。</p><h2 id="myPromise-prototype-catch"><a href="#myPromise-prototype-catch" class="headerlink" title="myPromise.prototype.catch"></a>myPromise.prototype.catch</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myPromise.prototype.catch = <span class="function"><span class="keyword">function</span> (<span class="params">rejectFun</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.then(<span class="literal">null</span>, rejectFun);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>catch 方法实现起来还是简单的，通过调用 Promise 的 then 方法，只传入失败的回调；then 方法会把值传递下去。</p></blockquote><hr><h2 id="myPromise-prototype-finally"><a href="#myPromise-prototype-finally" class="headerlink" title="myPromise.prototype.finally"></a>myPromise.prototype.finally</h2><p>不管成功还是失败，都会执行</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">myPromise.prototype.finally = <span class="function"><span class="keyword">function</span> (<span class="params">finallyFun</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    finallyFun();</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;).catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    fiinallyFun();</span><br><span class="line">    <span class="keyword">return</span> err;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="myPromise-resolve"><a href="#myPromise-resolve" class="headerlink" title="myPromise.resolve"></a>myPromise.resolve</h2><p>返回一个成功的 Promise</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">myPromise.resolve = <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    resolve(res);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="myPromise-reject"><a href="#myPromise-reject" class="headerlink" title="myPromise.reject"></a>myPromise.reject</h2><p>返回一个失败的 Promise</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">myPromise.reject = <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    reject(res);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="myPromise-all"><a href="#myPromise-all" class="headerlink" title="myPromise.all"></a>myPromise.all</h2><ul><li>返回一个 Promsie 实例，接收一个可迭代的对象，返回值是一个数组</li><li>等参数内的值都执行成功才返回成功，只要有一个值返回失败，则返回失败</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">myPromise.all = <span class="function"><span class="keyword">function</span> (<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*判断参数类型*/</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&quot;参数类型错误，必须是数组&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> resolve;</span><br><span class="line">  <span class="keyword">let</span> reject;</span><br><span class="line">  <span class="keyword">const</span> promise = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">r, j</span>) =&gt;</span> &#123;</span><br><span class="line">    resolve = r;</span><br><span class="line">    reject = j;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> fufilledCount = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> result = [];</span><br><span class="line">  <span class="comment">/*记录当前遍历的index*/</span></span><br><span class="line">  <span class="keyword">const</span> wrapFufilled = <span class="function">(<span class="params">i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">      fufilledCount += <span class="number">1</span>;</span><br><span class="line">      result[i] = val;</span><br><span class="line">      <span class="keyword">if</span> (fufilledCount &gt;= index) &#123;</span><br><span class="line">        resolve(result);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> wrapRejected = <span class="function">(<span class="params">i</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      reject(err);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    myPromise.resolve(item).then(wrapFufilled(index), wrapRejected(index));</span><br><span class="line">    index += <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>调用一下 myPromise.all</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 测试</span></span><br><span class="line"><span class="keyword">const</span> pro1 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">res, rej</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    res(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> pro2 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">res, rej</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// res(&#x27;2&#x27;)</span></span><br><span class="line">    rej(<span class="string">&quot;错误&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> pro3 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">res, rej</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    res(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proAll = myPromise</span><br><span class="line">  .all([pro1, pro2, pro3])</span><br><span class="line">  .then(</span><br><span class="line">    (res) =&gt; <span class="built_in">console</span>.log(res) <span class="comment">// 3秒之后打印 [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;]</span></span><br><span class="line">  )</span><br><span class="line">  .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e); <span class="comment">// “错误”</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/cs.png"></p><p>其中一个失败时</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/cs2.png"></p><blockquote><p><strong>总结:</strong><br>1、Promise.all()接受一个 Array 类型的参数<br>2、只有数组中全部的 Promise 都变为 resolve 的时候<br>3、返回一个新的 Promise 实例<br>4、只要有一个失败，状态就变成 rejected</p></blockquote><hr><h2 id="myPromise-race"><a href="#myPromise-race" class="headerlink" title="myPromise.race"></a>myPromise.race</h2><p>返回一个 Promsie，接收一个数组作为参数，一旦数组其中一项执行，就返回执行结果。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">myPromise.race = <span class="function"><span class="keyword">function</span> (<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> resolve;</span><br><span class="line">  <span class="keyword">let</span> reject;</span><br><span class="line">  <span class="keyword">const</span> promise = <span class="keyword">new</span> myPromsie(<span class="function">(<span class="params">r, j</span>) =&gt;</span> &#123;</span><br><span class="line">    resolve = r;</span><br><span class="line">    reject = j;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    myPromise.resolve(item).then(</span><br><span class="line">      (val) =&gt; resolve(val),</span><br><span class="line">      (err) =&gt; reject(err)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="myPromise-any"><a href="#myPromise-any" class="headerlink" title="myPromise.any"></a>myPromise.any</h2><p>只要其中一个 Promsie 成功，就返回成功的那个；如果没有一个成功，就返回失败，把失败的错误集中在一起。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">myPromise.any = <span class="function"><span class="keyword">function</span> (<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> resolve;</span><br><span class="line">  <span class="keyword">let</span> reject;</span><br><span class="line">  <span class="keyword">const</span> promise = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">r, j</span>) =&gt;</span> &#123;</span><br><span class="line">    resolve = r;</span><br><span class="line">    reject = j;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> errCount = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> arrCount = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    arrCount += <span class="number">1</span>;</span><br><span class="line">    myPromise.resolve(item).then(</span><br><span class="line">      (val) =&gt; resolve(val),</span><br><span class="line">      (err) =&gt; &#123;</span><br><span class="line">        errCount += <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (errCount &gt;= arrCount) &#123;</span><br><span class="line">          reject(<span class="keyword">new</span> AggregateError(<span class="string">&quot;所有Promsie都失败&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
            <tag> Promise </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Promise(二)：手动实现一个 Promise</title>
      <link href="ymm751/"/>
      <url>ymm751/</url>
      
        <content type="html"><![CDATA[<p>上一篇文章我们认识了 Promise 的基本用法，现在来尝试手动来实现一下简单的 Promise 功能。</p><h2 id="简易版-Promise"><a href="#简易版-Promise" class="headerlink" title="简易版 Promise"></a>简易版 Promise</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*创建三个变量来表示状态*/</span></span><br><span class="line"><span class="keyword">const</span> PENDING = <span class="string">&quot;pending&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> FULFILLED = <span class="string">&quot;fulfilled&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">&quot;rejected&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myPromise</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* that 保存 this ，避免 this 指向问题*/</span></span><br><span class="line">  <span class="keyword">const</span> that = <span class="built_in">this</span>;</span><br><span class="line">  <span class="comment">/*value 用来保存 resolve 或 reject 中传入的值*/</span></span><br><span class="line">  that.value = <span class="literal">null</span>;</span><br><span class="line">  <span class="comment">/*默认状态*/</span></span><br><span class="line">  that.status = PENDING;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   *用于保存 then 中的回调</span></span><br><span class="line"><span class="comment">   *当执行完 Promise 时状态可能还是等待中，这时候应该把 then 中的回调保存起来用于状态改变时使用</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  that.fulfilledCallback = [];</span><br><span class="line">  that.rejectedCallback = [];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (that.status === PENDING) &#123;</span><br><span class="line">      <span class="comment">/*改变status状态*/</span></span><br><span class="line">      that.status = FULFILLED;</span><br><span class="line">      <span class="comment">/*保存传入的value值*/</span></span><br><span class="line">      that.value = value;</span><br><span class="line">      <span class="comment">/*执行回调方法*/</span></span><br><span class="line">      that.fulfilledCallback.forEach(<span class="function">(<span class="params">fun</span>) =&gt;</span> fun(that.value));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (that.status === PENDING) &#123;</span><br><span class="line">      <span class="comment">/*改变status状态*/</span></span><br><span class="line">      that.status = REJECTED;</span><br><span class="line">      <span class="comment">/*保存传入的value值*/</span></span><br><span class="line">      that.value = value;</span><br><span class="line">      <span class="comment">/*执行回调方法*/</span></span><br><span class="line">      that.rejectedCallback.forEach(<span class="function">(<span class="params">fun</span>) =&gt;</span> fun(that.value));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*执行回调*/</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    fn(resolve, reject);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    reject(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *考虑到所有的实例都要用到then方法，then方法得放在promise的原型链上。</span></span><br><span class="line"><span class="comment"> *当状态是PENDING状态时，该做什么？不执行回调，那就将回调方法分别放入不同的栈内，等待调用。</span></span><br><span class="line"><span class="comment"> *当状态为FULFILLED或者REJECTED时，则执行响应的方法即可。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">myPromise.prototype.then = <span class="function"><span class="keyword">function</span> (<span class="params">resolveFun, rejectFun</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _this = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">if</span> (_this.status === PENDING) &#123;</span><br><span class="line">    <span class="comment">/*等待状态，添加回调函数到栈中*/</span></span><br><span class="line">    _this.fulfilledCallback.push(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      resolveFun(_this.value);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    _this.rejectedCallback.push(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      rejectFun(_this.value);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (_this.status === FULFILLED) &#123;</span><br><span class="line">    resolveFun(_this.value);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (_this.status === REJECTED) &#123;</span><br><span class="line">    rejectFun(_this.value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> pro = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;myPromise&quot;</span>);</span><br><span class="line">  resolve(<span class="string">&quot;data&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">pro.then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="好了，一个简易的-Promise-就完成了，我们来看一下结果："><a href="#好了，一个简易的-Promise-就完成了，我们来看一下结果：" class="headerlink" title="好了，一个简易的 Promise 就完成了，我们来看一下结果："></a>好了，一个简易的 Promise 就完成了，我们来看一下结果：</h2><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/sole.png"></p><h2 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h2><h3 id="resolve-和-reject-的改造"><a href="#resolve-和-reject-的改造" class="headerlink" title="resolve 和 reject 的改造"></a>resolve 和 reject 的改造</h3><p>根据 promise+规范改造 promise，传给 then 的应该是个 promise。<br>resolve 和 reject 的改造：</p><ul><li>对于 resolve 函数来说，首先需要判断传入的值是否为 Promise 类型</li><li>为了保证函数执行顺序，需要将两个函数体代码使用 setTimeout 包裹起来</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*判断value值是否为Promise类型*/</span></span><br><span class="line">  <span class="keyword">if</span> (value <span class="keyword">instanceof</span> myPromise) &#123;</span><br><span class="line">    <span class="keyword">return</span> value.then(resolve, reject);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*为保证函数执行顺序，将函数体包裹在setTimeout中*/</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (that.status === PENDING) &#123;</span><br><span class="line">      <span class="comment">/*改变status状态*/</span></span><br><span class="line">      that.status = FULFILLED;</span><br><span class="line">      <span class="comment">/*保存传入的value值*/</span></span><br><span class="line">      that.value = value;</span><br><span class="line">      <span class="comment">/*执行回调方法*/</span></span><br><span class="line">      that.fulfilledCallback.forEach(<span class="function">(<span class="params">fun</span>) =&gt;</span> fun(that.value));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*为保证函数执行顺序，将函数体包裹在setTimeout中*/</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (that.status === PENDING) &#123;</span><br><span class="line">      <span class="comment">/*改变status状态*/</span></span><br><span class="line">      that.status = REJECTED;</span><br><span class="line">      <span class="comment">/*保存传入的value值*/</span></span><br><span class="line">      that.value = value;</span><br><span class="line">      <span class="comment">/*执行回调方法*/</span></span><br><span class="line">      that.rejectedCallback.forEach(<span class="function">(<span class="params">fun</span>) =&gt;</span> fun(that.value));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="then-方法优化"><a href="#then-方法优化" class="headerlink" title="then 方法优化"></a>then 方法优化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">myPromise.prototype.then = <span class="function"><span class="keyword">function</span> (<span class="params">resolveFun, rejectFun</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _this = <span class="built_in">this</span>;</span><br><span class="line">  <span class="comment">/*新增一个变量 promise2，因为每个 then 函数都需要返回一个新的 Promise 对象，该变量用于保存新的返回对象*/</span></span><br><span class="line">  <span class="keyword">let</span> promise2 = <span class="literal">null</span>;</span><br><span class="line">  resolveFun = <span class="keyword">typeof</span> resolveFun === <span class="string">&quot;function&quot;</span> ? resolveFun : <span class="function">(<span class="params">res</span>) =&gt;</span> res;</span><br><span class="line">  rejectFun =</span><br><span class="line">    <span class="keyword">typeof</span> rejectFun === <span class="string">&quot;function&quot;</span></span><br><span class="line">      ? rejectFun</span><br><span class="line">      : <span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">throw</span> val;</span><br><span class="line">        &#125;;</span><br><span class="line">  <span class="keyword">if</span> (_this.status === PENDING) &#123;</span><br><span class="line">    <span class="comment">/*等待状态，添加回调函数到栈中*/</span></span><br><span class="line">    <span class="keyword">return</span> (promise2 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resole, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      _this.fulfilledCallback.push(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> val = resolveFun(_this.value);</span><br><span class="line">          resultPromise(promise2, val, resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          reject(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      _this.rejectedCallback.push(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> val = rejectFun(_this.value);</span><br><span class="line">          resultPromise(promise2, val, resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          reject(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        rejectFun(_this.value);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (_this.status === FULFILLED) &#123;</span><br><span class="line">    <span class="keyword">return</span> (promise2 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resole, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> val = resolveFun(_this.value);</span><br><span class="line">          resultPromise(promise2, val, resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          reject(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="number">0</span>);</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (_this.status === REJECTED) &#123;</span><br><span class="line">    <span class="keyword">return</span> (promise2 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> val = rejectFun(_this.value);</span><br><span class="line">          resultPromise(promise2, val, resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          reject(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="number">0</span>);</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>如果 val 处于等待状态，Promise 需保持为等待状态直至 val 被执行或拒绝<br>如果 val 处于其他状态，则用相同的值处理 Promise</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">resultPromise</span>(<span class="params">promise, val, resolve, reject</span>)</span>&#123;</span><br><span class="line">  <span class="comment">/*为了防止回调地狱的情况，需要判断一下 promise2 与当前结果的关系</span></span><br><span class="line"><span class="comment">  * 如果相等，这说明出现回调地狱，就抛出一个错误</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">if</span>(promise === val)&#123;</span><br><span class="line">    <span class="keyword">return</span> reject(<span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&#x27;循环引用&#x27;</span>) )</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*判断val类型*/</span></span><br><span class="line">  <span class="keyword">if</span> (val <span class="keyword">instanceof</span> myPromise) &#123;</span><br><span class="line">    val.then(<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      resultPromise(promise, value, resolve, reject)</span><br><span class="line">    &#125;, reject)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*创建一个变量 bool 用于判断是否已经调用过函数*/</span></span><br><span class="line">  <span class="keyword">let</span> bool = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">if</span>(val !== <span class="literal">null</span> &amp;&amp; (<span class="keyword">typeof</span> val === <span class="string">&#x27;object&#x27;</span> || <span class="keyword">typeof</span> val === <span class="string">&#x27;function&#x27;</span>) )&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="comment">/*因为每个 promsie 都会有一个 then 方法，用变量 then 来保存它；如果出现错误，直接执行 reject 方法*/</span></span><br><span class="line">      <span class="keyword">let</span> then = val.then;</span><br><span class="line">      <span class="comment">/*判断then方法的类型，如果是 function；就认为返回的是一个 promise，否则就是一个普通的值，直接调用 resolve 方法*/</span></span><br><span class="line">      <span class="keyword">if</span>( <span class="keyword">typeof</span> then === <span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">        <span class="comment">/*让then方法执行，判断执行的结果，如果成功就走 resolve ；失败就走 reject</span></span><br><span class="line"><span class="comment">        * 因为当前上下文的 this 指向的并不是 val,所以通过 call 方法改变this指向 val</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        then.call(val, <span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(bool) <span class="keyword">return</span>;</span><br><span class="line">          bool = <span class="literal">true</span>;</span><br><span class="line">          <span class="comment">/*通过递归解析，重复执行，直到返回的结果不是一个 promise 为止*/</span></span><br><span class="line">          resultPromise(promise2, data, resolve, reject)</span><br><span class="line">        &#125;,<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(e) <span class="keyword">return</span>;</span><br><span class="line">          bool = <span class="literal">true</span>;</span><br><span class="line">          reject(e)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        resolve(val)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(e)&#123;</span><br><span class="line">      <span class="keyword">if</span>(bool) <span class="keyword">return</span>;</span><br><span class="line">      bool = <span class="literal">true</span>;</span><br><span class="line">      reject(e)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">/*如果当前的值不是一个函数也不是一个对象，那说明是一个普通值，就直接进入下一次的成功方法*/</span></span><br><span class="line">    resolve(val)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><p>以上就是修改的内容了，来将代码整理一下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*创建三个变量来表示状态*/</span></span><br><span class="line"><span class="keyword">const</span> PENDING = <span class="string">&quot;pending&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> FULFILLED = <span class="string">&quot;fulfilled&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">&quot;rejected&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myPromise</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* that 保存 this ，避免 this 指向问题*/</span></span><br><span class="line">  <span class="keyword">const</span> that = <span class="built_in">this</span>;</span><br><span class="line">  <span class="comment">/*value 用来保存 resolve 或 reject 中传入的值*/</span></span><br><span class="line">  that.value = <span class="literal">null</span>;</span><br><span class="line">  <span class="comment">/*默认状态*/</span></span><br><span class="line">  that.status = PENDING;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   *用于保存 then 中的回调</span></span><br><span class="line"><span class="comment">   *当执行完 Promise 时状态可能还是等待中，这时候应该把 then 中的回调保存起来用于状态改变时使用</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  that.fulfilledCallback = [];</span><br><span class="line">  that.rejectedCallback = [];</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/*判断value值是否为Promise类型*/</span></span><br><span class="line">    <span class="keyword">if</span> (value <span class="keyword">instanceof</span> myPromise) &#123;</span><br><span class="line">      <span class="keyword">return</span> value.then(resolve, reject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*为保证函数执行顺序，将函数体包裹在setTimeout中*/</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (that.status === PENDING) &#123;</span><br><span class="line">        <span class="comment">/*改变status状态*/</span></span><br><span class="line">        that.status = FULFILLED;</span><br><span class="line">        <span class="comment">/*保存传入的value值*/</span></span><br><span class="line">        that.value = value;</span><br><span class="line">        <span class="comment">/*执行回调方法*/</span></span><br><span class="line">        that.fulfilledCallback.forEach(<span class="function">(<span class="params">fun</span>) =&gt;</span> fun(that.value));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/*为保证函数执行顺序，将函数体包裹在setTimeout中*/</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (that.status === PENDING) &#123;</span><br><span class="line">        <span class="comment">/*改变status状态*/</span></span><br><span class="line">        that.status = REJECTED;</span><br><span class="line">        <span class="comment">/*保存传入的value值*/</span></span><br><span class="line">        that.value = value;</span><br><span class="line">        <span class="comment">/*执行回调方法*/</span></span><br><span class="line">        that.rejectedCallback.forEach(<span class="function">(<span class="params">fun</span>) =&gt;</span> fun(that.value));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*执行回调*/</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    fn(resolve, reject);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    reject(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myPromise.prototype.then = <span class="function"><span class="keyword">function</span> (<span class="params">resolveFun, rejectFun</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _this = <span class="built_in">this</span>;</span><br><span class="line">  <span class="comment">/*新增一个变量 promise2，因为每个 then 函数都需要返回一个新的 Promise 对象，该变量用于保存新的返回对象*/</span></span><br><span class="line">  <span class="keyword">let</span> promise2 = <span class="literal">null</span>;</span><br><span class="line">  resolveFun = <span class="keyword">typeof</span> resolveFun === <span class="string">&quot;function&quot;</span> ? resolveFun : <span class="function">(<span class="params">res</span>) =&gt;</span> res;</span><br><span class="line">  rejectFun =</span><br><span class="line">    <span class="keyword">typeof</span> rejectFun === <span class="string">&quot;function&quot;</span></span><br><span class="line">      ? rejectFun</span><br><span class="line">      : <span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">throw</span> val;</span><br><span class="line">        &#125;;</span><br><span class="line">  <span class="keyword">if</span> (_this.status === PENDING) &#123;</span><br><span class="line">    <span class="comment">/*等待状态，添加回调函数到栈中*/</span></span><br><span class="line">    <span class="keyword">return</span> (promise2 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resole, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      _this.fulfilledCallback.push(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> val = resolveFun(_this.value);</span><br><span class="line">          resultPromise(promise2, val, resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          reject(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      _this.rejectedCallback.push(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> val = rejectFun(_this.value);</span><br><span class="line">          resultPromise(promise2, val, resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          reject(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        rejectFun(_this.value);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (_this.status === FULFILLED) &#123;</span><br><span class="line">    <span class="keyword">return</span> (promise2 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resole, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> val = resolveFun(_this.value);</span><br><span class="line">          resultPromise(promise2, val, resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          reject(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="number">0</span>);</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (_this.status === REJECTED) &#123;</span><br><span class="line">    <span class="keyword">return</span> (promise2 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">let</span> val = rejectFun(_this.value);</span><br><span class="line">          resultPromise(promise2, val, resolve, reject);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          reject(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="number">0</span>);</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resultPromise</span>(<span class="params">promise, val, resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*为了防止回调地狱的情况，需要判断一下 promise2 与当前结果的关系</span></span><br><span class="line"><span class="comment">   * 如果相等，这说明出现回调地狱，就抛出一个错误</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">if</span> (promise === val) &#123;</span><br><span class="line">    <span class="keyword">return</span> reject(<span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&quot;循环引用&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*判断val类型*/</span></span><br><span class="line">  <span class="keyword">if</span> (val <span class="keyword">instanceof</span> myPromise) &#123;</span><br><span class="line">    val.then(<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      resultPromise(promise, value, resolve, reject);</span><br><span class="line">    &#125;, reject);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*创建一个变量 bool 用于判断是否已经调用过函数*/</span></span><br><span class="line">  <span class="keyword">let</span> bool = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">if</span> (val !== <span class="literal">null</span> &amp;&amp; (<span class="keyword">typeof</span> val === <span class="string">&quot;object&quot;</span> || <span class="keyword">typeof</span> val === <span class="string">&quot;function&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">/*因为每个 promsie 都会有一个 then 方法，用变量 then 来保存它；如果出现错误，直接执行 reject 方法*/</span></span><br><span class="line">      <span class="keyword">let</span> then = val.then;</span><br><span class="line">      <span class="comment">/*判断then方法的类型，如果是 function；就认为返回的是一个 promise，否则就是一个普通的值，直接调用 resolve 方法*/</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> then === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">/*让then方法执行，判断执行的结果，如果成功就走 resolve ；失败就走 reject</span></span><br><span class="line"><span class="comment">         * 因为当前上下文的 this 指向的并不是 val,所以通过 call 方法改变this指向 val</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        then.call(</span><br><span class="line">          val,</span><br><span class="line">          (data) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (bool) <span class="keyword">return</span>;</span><br><span class="line">            bool = <span class="literal">true</span>;</span><br><span class="line">            <span class="comment">/*通过递归解析，重复执行，直到返回的结果不是一个 promise 为止*/</span></span><br><span class="line">            resultPromise(promise2, data, resolve, reject);</span><br><span class="line">          &#125;,</span><br><span class="line">          (e) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (e) <span class="keyword">return</span>;</span><br><span class="line">            bool = <span class="literal">true</span>;</span><br><span class="line">            reject(e);</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        resolve(val);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">if</span> (bool) <span class="keyword">return</span>;</span><br><span class="line">      bool = <span class="literal">true</span>;</span><br><span class="line">      reject(e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">/*如果当前的值不是一个函数也不是一个对象，那说明是一个普通值，就直接进入下一次的成功方法*/</span></span><br><span class="line">    resolve(val);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="执行结果"><a href="#执行结果" class="headerlink" title="执行结果"></a>执行结果</h2><p>现在来使用一下，看下结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> p1 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="number">111</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> p1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> p2 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      resolve(<span class="number">222</span>);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;第二次&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> p2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> p3 = <span class="keyword">new</span> myPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      resolve(<span class="number">333</span>);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;第三次&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> p3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">p1()</span><br><span class="line">  .then(</span><br><span class="line">    (res) =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(res);</span><br><span class="line">      <span class="keyword">return</span> p2();</span><br><span class="line">    &#125;,</span><br><span class="line">    (err) =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;err&quot;</span>, err);</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">    <span class="keyword">return</span> p3();</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;直接返回数据&quot;</span>;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>打印结果如下：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/res.png"></p><a class="btn-beautify button--animated red larger block right" href="/ddv8fu"   title="🔨Promise(三)：拓展方法实现"><i class="iconfont icon-xuanzhongxiaoshou fa-fw"></i><span>🔨Promise(三)：拓展方法实现</span></a>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
            <tag> Promise </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Promise(一)：Promise认识</title>
      <link href="pnzuz1/"/>
      <url>pnzuz1/</url>
      
        <content type="html"><![CDATA[<h2 id="Promise-是什么？"><a href="#Promise-是什么？" class="headerlink" title="Promise 是什么？"></a>Promise 是什么？</h2><p>Promise 是 ES6 中的一个重要特性，那 Promise 究竟长什么样子呢？我们来 console.dir()打印一下就知道了。<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/p.png"><br>从打印的结果可以看出，Promise 是一个构造函数，身上有许多方法: all,any,race,reject,resolve；原型上有 then,catch 等常用到的方法。</p><p>那我们来 new 一个 Promise 来看看。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> pro = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//** 在里面执行一些异步操作*/</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;三秒后执行&quot;</span>);</span><br><span class="line">    resolve(<span class="string">&quot;数据data&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/p2.png"><br>Promise 构造函数接收一个参数，是一个函数，里面传入两个参数 resolve,reject;它们分别表示异步操作执行成功后的回调和异步操作执行失败的回调。</p><h3 id="Promise-概念"><a href="#Promise-概念" class="headerlink" title="Promise 概念"></a>Promise 概念</h3><p>Promise 的中文意思是‘承诺’，什么叫承诺？承诺就是现在没有发生，在将来的某个时刻一定会发生的事情。<br>放在编程语言的环境下，Promise 就是异步事件的结果的占位符。我们不用去管异步事件的结果什么时候来，只需要关心异步事件的结果产生的时候，你想要做什么就对了。</p><h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p>异步事件不是立即执行程序，它的结果可能要在动作发生后一段时间才到，所以它有个生命周期。<br>一个 Promise 的生命周期主要有 2 个阶段：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1: unsettled（pending） 处理中</span><br><span class="line">2: settled (fulfilled或者rejected) 处理完</span><br></pre></td></tr></table></figure><h3 id="Promise-有三个状态："><a href="#Promise-有三个状态：" class="headerlink" title="Promise 有三个状态："></a>Promise 有三个状态：</h3><ul><li>pending   初始状态（等待）</li><li>fulfiled   操作成功</li><li>rejected   操作失败</li></ul><blockquote><p><strong>resolve:</strong> 是指将 Promise 对象的状态从 pending 变为 fulfilled，在异步操作成功时调用，并将结果作为参数传递出去。<br><strong>reject:</strong> 是指将 Promise 对象的状态从 pending 变为 rejected，在异步操作失败时调用，并将异步操作报的错误作为参数传递出去。</p></blockquote><p>上面这段代码，执行了一个 setTimeout 异步操作，会在三秒后执行，打印“三秒后执行”并调用 resolve 方法。<br>需要注意的一点是，我们只是 new 了一个 Promise 对象并没有调用它，但传进去的函数去执行了；所以，一般使用 Promise 的时候我们都会在外面包一层函数，在需要的时候再去调用这个函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">promiseAsync</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> pro = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;三秒后执行&#x27;</span>)</span><br><span class="line">      resolve(<span class="string">&#x27;数据data&#x27;</span>)</span><br><span class="line">    &#125;,<span class="number">3000</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> pro</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">promiseAsync()</span><br></pre></td></tr></table></figure><h3 id="链式调用"><a href="#链式调用" class="headerlink" title="链式调用"></a>链式调用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">promiseAsync().then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>在 promiseAsync()的返回上直接调用 then 方法，then 接收一个参数，是函数，并且会拿到我们在 promiseAsync 中调用 resolve 时传的的参数。运行这段代码，会在三秒后输出“三秒后执行”，紧接着输出“数据 data”。</p><blockquote><p>从这可以看出，原来 then 里面的函数就跟我们平时的回调函数一个意思，能够在 promiseAsync 这个异步任务执行完成之后被执行。这就是 Promise 的作用了，简单来讲，就是能把原来的回调写法分离出来，在异步操作执行完后，用链式调用的方式执行回调函数。<br>而 Promise 的优势在于，可以在 then 方法中继续写 Promise 对象并返回，然后继续调用 then 来进行回调操作。<br>所以，Promise 表面上只是简化了层层回调的写法，实质上通过维护状态、传递状态的方式来使得回调函数能够及时得到调用，相比于传递 callback 来说更加简单和灵活。<br>如下实例：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promiseAsync1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> pro1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;promiseAsync1执行成功&quot;</span>);</span><br><span class="line">      resolve(<span class="string">&quot;data1111&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> pro1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promiseAsync2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> pro2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;promiseAsync2执行成功&quot;</span>);</span><br><span class="line">      resolve(<span class="string">&quot;data2222&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> pro2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promiseAsync3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> pro3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;promiseAsync3执行成功&quot;</span>);</span><br><span class="line">      resolve(<span class="string">&quot;data3333&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> pro3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*链式调用*/</span></span><br><span class="line">promiseAsync1()</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data); <span class="comment">// data1111</span></span><br><span class="line">    <span class="keyword">return</span> promiseAsync2();</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data); <span class="comment">// data2222</span></span><br><span class="line">    <span class="keyword">return</span> promiseAsync3();</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data); <span class="comment">// data3333</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;直接返回数据&quot;</span>;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data); <span class="comment">// 直接返回数据</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>运行结果：<br><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/p3.png"></p><h2 id=""><a href="#" class="headerlink" title=""></a><div class="note default modern"><p>总结：<br>1、主要用于异步计算<br>2、可以将异步操作队列化，按照期望的顺序执行，返回符合预期的结果<br>3、可以在对象之间传递和操作 Promise，帮助我们处理队列</p></div></h2><h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><p>Promise 会自动捕获内部异常，并交给 rejected 响应函数进行处理。</p><h3 id="1-throw-new-Error-‘错误信息’-catch-gt-错误处理逻辑"><a href="#1-throw-new-Error-‘错误信息’-catch-gt-错误处理逻辑" class="headerlink" title="1. throw new Error(‘错误信息’).catch( () =&gt; {错误处理逻辑})"></a>1. throw new Error(‘错误信息’).catch( () =&gt; {错误处理逻辑})</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;抛出error&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Error&quot;</span>, err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h3 id="2-reject-‘错误信息’-then-gt-gt-错误处理逻辑"><a href="#2-reject-‘错误信息’-then-gt-gt-错误处理逻辑" class="headerlink" title="2. reject(‘错误信息’).then(() =&gt; {}, () =&gt; {错误处理逻辑})"></a>2. reject(‘错误信息’).then(() =&gt; {}, () =&gt; {错误处理逻辑})</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    reject(<span class="string">&quot;抛出err&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;).then(</span><br><span class="line">  (res) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;,</span><br><span class="line">  (err) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Error&quot;</span>, err);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><blockquote><p>推荐使用第一种方式，更加清晰好读，并且可以捕获前面所有的错误（可以捕获 N 个 then 回调错误）</p></blockquote><hr><h2 id="Promise-reject-执行失败操作"><a href="#Promise-reject-执行失败操作" class="headerlink" title="Promise.reject 执行失败操作"></a>Promise.reject 执行失败操作</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getNum</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> pro = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//做一些异步操作</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> num = <span class="built_in">Math</span>.ceil(<span class="built_in">Math</span>.random() * <span class="number">10</span>); <span class="comment">//生成1-10的随机数</span></span><br><span class="line">      <span class="keyword">if</span> (num &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">        resolve(num);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(<span class="string">&quot;数字太大了&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> pro;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getNum().then(</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;resolved&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">reason, data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;rejected&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(reason);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><blockquote><p>getNum 函数用来异步获取一个数字，3 秒后执行完成，如果数字小于等于 5，我们认为是“成功”了，调用 resolve 修改 Promise 的状态。否则我们认为是“失败”了，调用 reject 并传递一个参数，作为失败的原因。</p></blockquote><hr><h2 id="Promise-catch"><a href="#Promise-catch" class="headerlink" title="Promise.catch"></a>Promise.catch</h2><p>catch 方法和 then 方法的第二参数是差不多的作用，主要是用来指定 reject 的回调。还是拿 getNum 函数为例，用法如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getNum()</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;resolved&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;rejected&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(e);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>效果和写在 then 的第二个参数里面一样。不过它还有另外一个作用：在执行 resolve 的回调（也就是上面 then 中的第一个参数）时，如果抛出异常了（代码出错了），那么并不会报错卡死 js，而是会进到这个 catch 方法中。请看下面的代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getNum()</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;resolved&quot;</span>);</span><br><span class="line">    cosnole.log(reslut); <span class="comment">// 一个未定义的变量</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;rejected&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(e); <span class="comment">// ReferenceError: cosnole is not defined at &lt;anonymous&gt;:3:5</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h2 id="在-resolve-的回调中，我们-console-log-reslut-而-reslut-这个变量是没有被定义的。如果我们不用-Promise，代码运行到这里就直接在控制台报错了，不往下运行了。但是在这里，会得到这样的结果："><a href="#在-resolve-的回调中，我们-console-log-reslut-而-reslut-这个变量是没有被定义的。如果我们不用-Promise，代码运行到这里就直接在控制台报错了，不往下运行了。但是在这里，会得到这样的结果：" class="headerlink" title="在 resolve 的回调中，我们 console.log(reslut);而 reslut 这个变量是没有被定义的。如果我们不用 Promise，代码运行到这里就直接在控制台报错了，不往下运行了。但是在这里，会得到这样的结果："></a>在 resolve 的回调中，我们 console.log(reslut);而 reslut 这个变量是没有被定义的。如果我们不用 Promise，代码运行到这里就直接在控制台报错了，不往下运行了。但是在这里，会得到这样的结果：</h2><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/p4.png"><br>也就是说进到 catch 方法里面去了，而且把错误原因传到了 e 参数中。即便是有错误的代码也不会报错了，这与我们的 try/catch 语句有相同的功能。</p><h2 id="Promise-all-批量执行操作"><a href="#Promise-all-批量执行操作" class="headerlink" title="Promise.all 批量执行操作"></a>Promise.all 批量执行操作</h2><p>Promise 的 all 方法提供了并行执行异步操作的能力，并且在所有异步操作执行完后才执行回调。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Promise.all([pro1,pro2,pro3])用于将多个Promise实例，包装成一个新的Promise实例。</span><br><span class="line">他接收一个数组作为参数，数组里可以是Promise对象或者别的值，只有Promise会等待状态改变。</span><br><span class="line">当所有的子Promise实例全部完成，该Promise才完成，返回值是全部值的数组。</span><br><span class="line">有任何一个子Promise实例失败，该Promise将失败，并返回第一个失败的子Promise实例的结果。</span><br></pre></td></tr></table></figure><p>还是拿上面定义的 promiseAsync1,promiseAsync2,promiseAsync3 来用一下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.all([promiseAsync1(), promiseAsync2(), promiseAsync3()])</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;全部值数组：&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;第一个实例失败结果：&quot;</span> + e);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/p5.png"></p><h2 id="-1"><a href="#-1" class="headerlink" title=""></a></h2><p>有了 all，就可以并行执行多个异步操作，并且在一个回调中处理所有的返回数据。</p><h2 id="promise-race-类似于-Promise-all-，区别在于它有任意一个完成就算完成"><a href="#promise-race-类似于-Promise-all-，区别在于它有任意一个完成就算完成" class="headerlink" title="promise.race 类似于 Promise.all() ，区别在于它有任意一个完成就算完成"></a>promise.race 类似于 Promise.all() ，区别在于它有任意一个完成就算完成</h2><p>all 方法的效果实际上是「谁跑的慢，以谁为准执行回调」，那么相对的就有另一个方法「谁跑的快，以谁为准执行回调」，这就是 race 方法，这个词本来就是赛跑的意思。race 的用法与 all 一样，我们把上面 promsieAsync1 的延时改为 1 秒来看一下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.race([promiseAsync1(), promiseAsync2(), promiseAsync3()])</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;第一个执行完成：&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>这三个异步操作同样是并行执行的。结果你应该可以猜到，1 秒后 promiseAsync1 已经执行完了，此时 then 里面的就执行了。结果是这样的：</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/p6.png"></p><ul><li>常见用法：<br>回调包装成 Promise，他有两个显而易见的好处：<ol><li> 可读性好</li><li> 返回的结果可以加入任何 Promise 队列</li></ol></li></ul><p>异步操作和定时器放在一起，如果定时器先触发，就认为超时，告知用户；<br>例如我们要从远程的服务器在资源如果 5000ms 还没有加载过来我们就告知用户加载失败</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//请求某个图片资源</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">requestImg</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> pro = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      resolve(img);</span><br><span class="line">    &#125;;</span><br><span class="line">    img.src = <span class="string">&quot;xxxxxx&quot;</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> pro;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//延时函数，用于给请求计时</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> pro = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="string">&quot;图片请求超时&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">5000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> pro;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.race([requestImg(), timeout()])</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><a class="btn-beautify button--animated red larger block right" href="/ymm751"   title="🔨 Promise(二)：手动实现一个Promise"><i class="iconfont icon-xuanzhongxiaoshou fa-fw"></i><span>🔨 Promise(二)：手动实现一个Promise</span></a>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
            <tag> Promise </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS 合并数组对象中 key 值相同的数据</title>
      <link href="nt8dtc/"/>
      <url>nt8dtc/</url>
      
        <content type="html"><![CDATA[<h2 id="将数组里某个属性相同的对象合并到一个数组中"><a href="#将数组里某个属性相同的对象合并到一个数组中" class="headerlink" title="将数组里某个属性相同的对象合并到一个数组中"></a>将数组里某个属性相同的对象合并到一个数组中</h2><p><em>原数组示例：</em></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> oldData = [</span><br><span class="line">  &#123;</span><br><span class="line">    type:<span class="string">&quot;篮球&quot;</span>,</span><br><span class="line">    value:<span class="number">20</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type:<span class="string">&quot;跑步&quot;</span>,</span><br><span class="line">    value:<span class="number">40</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type:<span class="string">&quot;游泳&quot;</span>,</span><br><span class="line">    value:<span class="number">10</span></span><br><span class="line">  &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    type:<span class="string">&quot;跑步&quot;</span>,</span><br><span class="line">    value:<span class="number">15</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">希望获得的数据格式（即将相同”type“值的对象合并为一个新的数组）</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> resultData = [</span><br><span class="line">  &#123;</span><br><span class="line">    type: <span class="string">&quot;篮球&quot;</span>,</span><br><span class="line">    infoList: [</span><br><span class="line">      &#123;</span><br><span class="line">        type: <span class="string">&quot;篮球&quot;</span>,</span><br><span class="line">        value: <span class="number">20</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type: <span class="string">&quot;跑步&quot;</span>,</span><br><span class="line">    infoList: [</span><br><span class="line">      &#123;</span><br><span class="line">        type: <span class="string">&quot;跑步&quot;</span>,</span><br><span class="line">        value: <span class="number">40</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        type: <span class="string">&quot;跑步&quot;</span>,</span><br><span class="line">        value: <span class="number">15</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type: <span class="string">&quot;游泳&quot;</span>,</span><br><span class="line">    infoList: [</span><br><span class="line">      &#123;</span><br><span class="line">        type: <span class="string">&quot;游泳&quot;</span>,</span><br><span class="line">        value: <span class="number">10</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><hr><h2 id="实现方案"><a href="#实现方案" class="headerlink" title="实现方案"></a>实现方案</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tempArr = [];</span><br><span class="line"><span class="keyword">let</span> data = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; oldData.length; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (tempArr.indexOf(oldData[i].type) === -<span class="number">1</span>) &#123;</span><br><span class="line">    data.push(&#123;</span><br><span class="line">      type: oldData[i].type,</span><br><span class="line">      infoList: [oldData[i]],</span><br><span class="line">    &#125;);</span><br><span class="line">    tempArr.push(oldData[i].type);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; data.length; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (data[j].type == oldData[i].type) &#123;</span><br><span class="line">        data[j].infoList.push(oldData[i]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> infoList = &#123;&#125;;</span><br><span class="line">oldData.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> &#123; type &#125; = item;</span><br><span class="line">  <span class="keyword">if</span> (!infoList[type]) &#123;</span><br><span class="line">    infoList[type] = &#123;</span><br><span class="line">      type,</span><br><span class="line">      list: [],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  infoList[type].list.push(item);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> list = <span class="built_in">Object</span>.values(infoList); <span class="comment">// 转换后的数据</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端常用公共方法工具类</title>
      <link href="fk3tzn/"/>
      <url>fk3tzn/</url>
      
        <content type="html"><![CDATA[<h2 id="关于时间的处理"><a href="#关于时间的处理" class="headerlink" title="关于时间的处理"></a>关于时间的处理</h2><h3 id="1-时间格式化"><a href="#1-时间格式化" class="headerlink" title="1. 时间格式化"></a>1. 时间格式化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;(Object|string|number)&#125;</span> <span class="variable">time</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>TimeFormat   想要返回时间的格式 例如 &#x27;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125; &#123;a&#125;&#x27; &#123;a&#125;为周</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;string&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseTime</span>(<span class="params">time, TimeFormat</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!time) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> format = TimeFormat || <span class="string">&quot;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&quot;</span>;</span><br><span class="line">  <span class="keyword">let</span> date;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> time === <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">    date = time;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> time === <span class="string">&quot;string&quot;</span> &amp;&amp; <span class="regexp">/^[0-9]+$/</span>.test(time)) &#123;</span><br><span class="line">      time = <span class="built_in">parseInt</span>(time);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> time === <span class="string">&quot;number&quot;</span> &amp;&amp; time.toString().length === <span class="number">10</span>) &#123;</span><br><span class="line">      time = time * <span class="number">1000</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    date = <span class="keyword">new</span> <span class="built_in">Date</span>(time);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> formatObj = &#123;</span><br><span class="line">    y: date.getFullYear(),</span><br><span class="line">    m: date.getMonth() + <span class="number">1</span>,</span><br><span class="line">    d: date.getDate(),</span><br><span class="line">    h: date.getHours(),</span><br><span class="line">    i: date.getMinutes(),</span><br><span class="line">    s: date.getSeconds(),</span><br><span class="line">    a: date.getDay(),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> time_str = format.replace(<span class="regexp">/&#123;(y|m|d|h|i|s|a)+&#125;/g</span>, <span class="function">(<span class="params">result, key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> value = formatObj[key];</span><br><span class="line">    <span class="keyword">if</span> (key === <span class="string">&quot;a&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> [<span class="string">&quot;日&quot;</span>, <span class="string">&quot;一&quot;</span>, <span class="string">&quot;二&quot;</span>, <span class="string">&quot;三&quot;</span>, <span class="string">&quot;四&quot;</span>, <span class="string">&quot;五&quot;</span>, <span class="string">&quot;六&quot;</span>][value];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (result.length &gt; <span class="number">0</span> &amp;&amp; value &lt; <span class="number">10</span>) &#123;</span><br><span class="line">      value = <span class="string">&quot;0&quot;</span> + value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value || <span class="number">0</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> time_str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parseTime(<span class="string">&quot;1617680226605&quot;</span>); <span class="comment">//不填写返回格式 默认为&#x27;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&#x27; 2021-04-06 11:37:06</span></span><br><span class="line">parseTime(<span class="string">&quot;1617680226605&quot;</span>, <span class="string">&quot;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&quot;</span>); <span class="comment">//填写对应格式  2021-04-06 11:37:06</span></span><br><span class="line">parseTime(<span class="string">&quot;1617680226605&quot;</span>, <span class="string">&quot;&#123;m&#125;-&#123;d&#125;-&#123;y&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125;&quot;</span>); <span class="comment">//修改格式  04-06-2021 11:37:06</span></span><br><span class="line">parseTime(<span class="string">&quot;1617680226605&quot;</span>, <span class="string">&quot;&#123;y&#125;-&#123;m&#125;-&#123;d&#125; &#123;h&#125;:&#123;i&#125;:&#123;s&#125; 周&#123;a&#125;&quot;</span>); <span class="comment">//加上周  2021-04-06 11:37:06 周四</span></span><br></pre></td></tr></table></figure><h3 id="2-获取某年中，某月最后一天是几号"><a href="#2-获取某年中，某月最后一天是几号" class="headerlink" title="2. 获取某年中，某月最后一天是几号"></a>2. 获取某年中，某月最后一天是几号</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMonthEnd</span>(<span class="params">year, month</span>) </span>&#123;</span><br><span class="line">  month = <span class="built_in">parseInt</span>(month);</span><br><span class="line">  <span class="keyword">if</span> (month == <span class="number">12</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> expect = <span class="number">1</span>;</span><br><span class="line">    year++;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(</span><br><span class="line">      <span class="keyword">new</span> <span class="built_in">Date</span>(year + <span class="string">&quot;/&quot;</span> + expect + <span class="string">&quot;/1&quot;</span>).getTime() - <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">100</span></span><br><span class="line">    ).getDate();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(</span><br><span class="line">      <span class="keyword">new</span> <span class="built_in">Date</span>(year + <span class="string">&quot;/&quot;</span> + (month + <span class="number">1</span>) + <span class="string">&quot;/1&quot;</span>).getTime() - <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">100</span></span><br><span class="line">    ).getDate();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getMonthEnd(<span class="number">2021</span>, <span class="number">4</span>); <span class="comment">// 30</span></span><br></pre></td></tr></table></figure><h3 id="3-获取某月的总天数"><a href="#3-获取某月的总天数" class="headerlink" title="3. 获取某月的总天数"></a>3. 获取某月的总天数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMonthDaysCount</span>(<span class="params">year, month</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">0</span>).getDate();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getMonthDaysCount(<span class="number">2021</span>, <span class="number">2</span>); <span class="comment">// 28</span></span><br></pre></td></tr></table></figure><h3 id="4-根据起始日期和结束日期计算天数"><a href="#4-根据起始日期和结束日期计算天数" class="headerlink" title="4. 根据起始日期和结束日期计算天数"></a>4. 根据起始日期和结束日期计算天数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;(Object|string|number)&#125;</span> <span class="variable">startDate</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;(Object|string|number)&#125;</span> <span class="variable">endDate</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;string&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DateDiff</span>(<span class="params">startDate, endDate</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> oDate1, oDate2, iDays;</span><br><span class="line">  oDate1 = <span class="keyword">new</span> <span class="built_in">Date</span>(</span><br><span class="line">    startDate.substring(<span class="number">4</span>, <span class="number">6</span>) +</span><br><span class="line">      <span class="string">&quot;-&quot;</span> +</span><br><span class="line">      startDate.substring(<span class="number">6</span>) +</span><br><span class="line">      <span class="string">&quot;-&quot;</span> +</span><br><span class="line">      startDate.substring(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">  );</span><br><span class="line">  oDate2 = <span class="keyword">new</span> <span class="built_in">Date</span>(</span><br><span class="line">    endDate.substring(<span class="number">4</span>, <span class="number">6</span>) +</span><br><span class="line">      <span class="string">&quot;-&quot;</span> +</span><br><span class="line">      endDate.substring(<span class="number">6</span>) +</span><br><span class="line">      <span class="string">&quot;-&quot;</span> +</span><br><span class="line">      endDate.substring(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">  );</span><br><span class="line">  iDays = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.abs(oDate1 - oDate2) / <span class="number">1000</span> / <span class="number">60</span> / <span class="number">60</span> / <span class="number">24</span>);</span><br><span class="line">  <span class="keyword">return</span> iDays;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DateDiff(<span class="string">&quot;2021 03 01&quot;</span>, <span class="string">&quot;2021 04 06&quot;</span>); <span class="comment">// 37</span></span><br></pre></td></tr></table></figure><h3 id="5-获取上一个月份"><a href="#5-获取上一个月份" class="headerlink" title="5. 获取上一个月份"></a>5. 获取上一个月份</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取上一个月</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date </span>格式为yyyy-mm-dd的日期，如：2021-04-06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPreMonth</span>(<span class="params">date</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = date.split(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> year = arr[<span class="number">0</span>]; <span class="comment">//获取当前日期的年份</span></span><br><span class="line">  <span class="keyword">var</span> month = arr[<span class="number">1</span>]; <span class="comment">//获取当前日期的月份</span></span><br><span class="line">  <span class="keyword">var</span> day = arr[<span class="number">2</span>]; <span class="comment">//获取当前日期的日</span></span><br><span class="line">  <span class="keyword">var</span> days = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">0</span>);</span><br><span class="line">  days = days.getDate(); <span class="comment">//获取当前日期中月的天数</span></span><br><span class="line">  <span class="keyword">var</span> year2 = year;</span><br><span class="line">  <span class="keyword">var</span> month2 = <span class="built_in">parseInt</span>(month) - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (month2 == <span class="number">0</span>) &#123;</span><br><span class="line">    year2 = <span class="built_in">parseInt</span>(year2) - <span class="number">1</span>;</span><br><span class="line">    month2 = <span class="number">12</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> day2 = day;</span><br><span class="line">  <span class="keyword">var</span> days2 = <span class="keyword">new</span> <span class="built_in">Date</span>(year2, month2, <span class="number">0</span>);</span><br><span class="line">  days2 = days2.getDate();</span><br><span class="line">  <span class="keyword">if</span> (day2 &gt; days2) &#123;</span><br><span class="line">    day2 = days2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (month2 &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    month2 = <span class="string">&quot;0&quot;</span> + month2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> t2 = year2 + <span class="string">&quot;-&quot;</span> + month2;</span><br><span class="line">  t2 = day2 ? t2 + <span class="string">&quot;-&quot;</span> + day2 : t2;</span><br><span class="line">  <span class="keyword">return</span> t2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getPreMonth(<span class="string">&quot;2021-04-06&quot;</span>); <span class="comment">// &quot;2021-03-01&quot;</span></span><br></pre></td></tr></table></figure><h3 id="6-中国标准时间转换成-datetime-格式"><a href="#6-中国标准时间转换成-datetime-格式" class="headerlink" title="6. 中国标准时间转换成 datetime 格式"></a>6. 中国标准时间转换成 datetime 格式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatData</span>(<span class="params">time, format</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> t = <span class="keyword">new</span> <span class="built_in">Date</span>(time);</span><br><span class="line">  <span class="keyword">var</span> tf = <span class="function"><span class="keyword">function</span> (<span class="params">i</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (i &lt; <span class="number">10</span> ? <span class="string">&quot;0&quot;</span> : <span class="string">&quot;&quot;</span>) + i;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> format.replace(<span class="regexp">/yyyy|MM|dd|HH|mm|ss/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (a) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;yyyy&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getFullYear());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;MM&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getMonth() + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;mm&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getMinutes());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;dd&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getDate());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;HH&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getHours());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;ss&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> tf(t.getSeconds());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-比较两个日期的大小"><a href="#7-比较两个日期的大小" class="headerlink" title="7. 比较两个日期的大小"></a>7. 比较两个日期的大小</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compareDate</span>(<span class="params">date1, date2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> oDate1 = <span class="keyword">new</span> <span class="built_in">Date</span>(date1);</span><br><span class="line">  <span class="keyword">var</span> oDate2 = <span class="keyword">new</span> <span class="built_in">Date</span>(date2);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (oDate1.getTime() &gt; oDate2.getTime()) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-获取前-n-月日期和后-n-月日期"><a href="#8-获取前-n-月日期和后-n-月日期" class="headerlink" title="8. 获取前 n 月日期和后 n 月日期"></a>8. 获取前 n 月日期和后 n 月日期</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">countMonths(<span class="number">2</span>); <span class="comment">//+代表过去  -代表将来</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">countMonths</span>(<span class="params">month</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> today = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">var</span> defaultmonth = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  defaultmonth.setMonth(today.getMonth() - month); <span class="comment">//用于设置月份</span></span><br><span class="line">  <span class="keyword">var</span> strYear = defaultmonth.getFullYear();</span><br><span class="line">  <span class="keyword">var</span> strMonth = defaultmonth.getMonth() + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (strMonth &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    strMonth = <span class="string">&quot;0&quot;</span> + strMonth;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  alert(strYear + <span class="string">&quot;-&quot;</span> + strMonth);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-时间日期格式转换"><a href="#9-时间日期格式转换" class="headerlink" title="9. 时间日期格式转换"></a>9. 时间日期格式转换</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Date</span>.prototype.format = <span class="function"><span class="keyword">function</span> (<span class="params">formatStr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> str = formatStr;</span><br><span class="line">  <span class="keyword">var</span> Week = [<span class="string">&quot;日&quot;</span>, <span class="string">&quot;一&quot;</span>, <span class="string">&quot;二&quot;</span>, <span class="string">&quot;三&quot;</span>, <span class="string">&quot;四&quot;</span>, <span class="string">&quot;五&quot;</span>, <span class="string">&quot;六&quot;</span>];</span><br><span class="line">  str = str.replace(<span class="regexp">/yyyy|YYYY/</span>, <span class="built_in">this</span>.getFullYear());</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /yy|YY/,</span><br><span class="line">    <span class="built_in">this</span>.getYear() % <span class="number">100</span> &gt; <span class="number">9</span></span><br><span class="line">      ? (<span class="built_in">this</span>.getYear() % <span class="number">100</span>).toString()</span><br><span class="line">      : <span class="string">&quot;0&quot;</span> + (<span class="built_in">this</span>.getYear() % <span class="number">100</span>)</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /MM/,</span><br><span class="line">    <span class="built_in">this</span>.getMonth() + <span class="number">1</span> &gt; <span class="number">9</span></span><br><span class="line">      ? (<span class="built_in">this</span>.getMonth() + <span class="number">1</span>).toString()</span><br><span class="line">      : <span class="string">&quot;0&quot;</span> + (<span class="built_in">this</span>.getMonth() + <span class="number">1</span>)</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/M/g</span>, <span class="built_in">this</span>.getMonth() + <span class="number">1</span>);</span><br><span class="line">  str = str.replace(<span class="regexp">/w|W/g</span>, Week[<span class="built_in">this</span>.getDay()]);</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /dd|DD/,</span><br><span class="line">    <span class="built_in">this</span>.getDate() &gt; <span class="number">9</span> ? <span class="built_in">this</span>.getDate().toString() : <span class="string">&quot;0&quot;</span> + <span class="built_in">this</span>.getDate()</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/d|D/g</span>, <span class="built_in">this</span>.getDate());</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /hh|HH/,</span><br><span class="line">    <span class="built_in">this</span>.getHours() &gt; <span class="number">9</span> ? <span class="built_in">this</span>.getHours().toString() : <span class="string">&quot;0&quot;</span> + <span class="built_in">this</span>.getHours()</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/h|H/g</span>, <span class="built_in">this</span>.getHours());</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /mm/,</span><br><span class="line">    <span class="built_in">this</span>.getMinutes() &gt; <span class="number">9</span></span><br><span class="line">      ? <span class="built_in">this</span>.getMinutes().toString()</span><br><span class="line">      : <span class="string">&quot;0&quot;</span> + <span class="built_in">this</span>.getMinutes()</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/m/g</span>, <span class="built_in">this</span>.getMinutes());</span><br><span class="line">  str = str.replace(</span><br><span class="line">    /ss|SS/,</span><br><span class="line">    <span class="built_in">this</span>.getSeconds() &gt; <span class="number">9</span></span><br><span class="line">      ? <span class="built_in">this</span>.getSeconds().toString()</span><br><span class="line">      : <span class="string">&quot;0&quot;</span> + <span class="built_in">this</span>.getSeconds()</span><br><span class="line">  );</span><br><span class="line">  str = str.replace(<span class="regexp">/s|S/g</span>, <span class="built_in">this</span>.getSeconds());</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或</span></span><br><span class="line"><span class="built_in">Date</span>.prototype.format = <span class="function"><span class="keyword">function</span> (<span class="params">format</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> o = &#123;</span><br><span class="line">    <span class="string">&quot;M+&quot;</span>: <span class="built_in">this</span>.getMonth() + <span class="number">1</span>, <span class="comment">//month</span></span><br><span class="line">    <span class="string">&quot;d+&quot;</span>: <span class="built_in">this</span>.getDate(), <span class="comment">//day</span></span><br><span class="line">    <span class="string">&quot;h+&quot;</span>: <span class="built_in">this</span>.getHours(), <span class="comment">//hour</span></span><br><span class="line">    <span class="string">&quot;m+&quot;</span>: <span class="built_in">this</span>.getMinutes(), <span class="comment">//minute</span></span><br><span class="line">    <span class="string">&quot;s+&quot;</span>: <span class="built_in">this</span>.getSeconds(), <span class="comment">//second</span></span><br><span class="line">    <span class="string">&quot;q+&quot;</span>: <span class="built_in">Math</span>.floor((<span class="built_in">this</span>.getMonth() + <span class="number">3</span>) / <span class="number">3</span>), <span class="comment">//quarter</span></span><br><span class="line">    S: <span class="built_in">this</span>.getMilliseconds(), <span class="comment">//millisecond</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/(y+)/</span>.test(format))</span><br><span class="line">    format = format.replace(</span><br><span class="line">      <span class="built_in">RegExp</span>.$1,</span><br><span class="line">      (<span class="built_in">this</span>.getFullYear() + <span class="string">&quot;&quot;</span>).substr(<span class="number">4</span> - <span class="built_in">RegExp</span>.$1.length)</span><br><span class="line">    );</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> o) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;(&quot;</span> + k + <span class="string">&quot;)&quot;</span>).test(format))</span><br><span class="line">      format = format.replace(</span><br><span class="line">        <span class="built_in">RegExp</span>.$1,</span><br><span class="line">        <span class="built_in">RegExp</span>.$1.length == <span class="number">1</span> ? o[k] : (<span class="string">&quot;00&quot;</span> + o[k]).substr((<span class="string">&quot;&quot;</span> + o[k]).length)</span><br><span class="line">      );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> format;</span><br><span class="line">&#125;;</span><br><span class="line">alert(<span class="keyword">new</span> <span class="built_in">Date</span>().format(<span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>));</span><br></pre></td></tr></table></figure><hr><h2 id="字符串处理"><a href="#字符串处理" class="headerlink" title="字符串处理"></a>字符串处理</h2><h3 id="1-将字符串用-js-按大写字母拆分，然后以下划线-拼接并转换成小写返回；用作-table-排序-prop-格式化"><a href="#1-将字符串用-js-按大写字母拆分，然后以下划线-拼接并转换成小写返回；用作-table-排序-prop-格式化" class="headerlink" title="1. 将字符串用 js 按大写字母拆分，然后以下划线_拼接并转换成小写返回；用作 table 排序 prop 格式化"></a>1. 将字符串用 js 按大写字母拆分，然后以下划线_拼接并转换成小写返回；用作 table 排序 prop 格式化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strsplit</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> strProp = str.split(<span class="regexp">/(?=[A-Z])/</span>);</span><br><span class="line">  <span class="keyword">return</span> strProp.join(<span class="string">&quot;_&quot;</span>).toLowerCase();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-提取汉字"><a href="#2-提取汉字" class="headerlink" title="2. 提取汉字"></a>2. 提取汉字</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetChinese</span>(<span class="params">strValue</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (strValue !== <span class="literal">null</span> &amp;&amp; strValue !== <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> reg = <span class="regexp">/[\u4e00-\u9fa5]/g</span>;</span><br><span class="line">    <span class="keyword">return</span> strValue.match(reg).join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-提取英文"><a href="#3-提取英文" class="headerlink" title="3. 提取英文"></a>3. 提取英文</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetaZ</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (str !== <span class="literal">null</span> &amp;&amp; str !== <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> reg = <span class="regexp">/[a-zA-Z]/g</span>;</span><br><span class="line">    <span class="keyword">return</span> str.match(reg).join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-去除字符左右两边空格"><a href="#4-去除字符左右两边空格" class="headerlink" title="4. 去除字符左右两边空格"></a>4. 去除字符左右两边空格</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lrTrim</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (val === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> value = val + <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> vallue.replace(<span class="regexp">/(^\s*)|(\s*$)/g</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-去除字符两头空格或者指定字符"><a href="#5-去除字符两头空格或者指定字符" class="headerlink" title="5. 去除字符两头空格或者指定字符"></a>5. 去除字符两头空格或者指定字符</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trim</span>(<span class="params">char, type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (char) &#123;</span><br><span class="line">    <span class="keyword">if</span> (type == <span class="string">&quot;left&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;^\\&quot;</span> + char + <span class="string">&quot;+&quot;</span>, <span class="string">&quot;g&quot;</span>), <span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="string">&quot;right&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;\\&quot;</span> + char + <span class="string">&quot;+$&quot;</span>, <span class="string">&quot;g&quot;</span>), <span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.replace(</span><br><span class="line">      <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;^\\&quot;</span> + char + <span class="string">&quot;+|\\&quot;</span> + char + <span class="string">&quot;+$&quot;</span>, <span class="string">&quot;g&quot;</span>),</span><br><span class="line">      <span class="string">&quot;&quot;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.replace(<span class="regexp">/^\s+|\s+$/g</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//* 去除字符串首尾全部空白*/</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;  Imagine  &quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;aaa&quot;</span> + str.trim() + <span class="string">&quot;bbb&quot;</span>); <span class="comment">// aaaImaginebbb</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//* 去除字符串左侧空白*/</span></span><br><span class="line">str = <span class="string">&quot;  Imagine  &quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;aaa&quot;</span> + str.trim(<span class="string">&quot; &quot;</span>, <span class="string">&quot;left&quot;</span>) + <span class="string">&quot;bbb&quot;</span>); <span class="comment">// aaaImagine  bbb</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//* 去除字符串右侧字符*/</span></span><br><span class="line">str = <span class="string">&quot;  Imagine  &quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;aaa&quot;</span> + str.trim(<span class="string">&quot; &quot;</span>, <span class="string">&quot;right&quot;</span>) + <span class="string">&quot;bbb&quot;</span>); <span class="comment">// aaa  Imaginebbb</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//* 去除字符串两侧指定字符*/</span></span><br><span class="line">str = <span class="string">&quot;/Imagine/&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.trim(<span class="string">&quot;?&quot;</span>)); <span class="comment">// Imagine</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//* 去除字符串左侧指定字符*/</span></span><br><span class="line">str = <span class="string">&quot;?Imagine/&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.trim(<span class="string">&quot;?&quot;</span>, <span class="string">&quot;left&quot;</span>)); <span class="comment">// Imagine/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//* 去除字符串右侧指定字符*/</span></span><br><span class="line">str = <span class="string">&quot;?Imagine/&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.trim(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;right&quot;</span>)); <span class="comment">// ?Imagine</span></span><br></pre></td></tr></table></figure><h3 id="6-获取字节长度"><a href="#6-获取字节长度" class="headerlink" title="6. 获取字节长度"></a>6. 获取字节长度</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> <span class="variable">str</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;Number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">byteLength</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> s = str.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = str.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">const</span> code = str.charCodeAt(i);</span><br><span class="line">    <span class="keyword">if</span> (code &gt; <span class="number">0x7f</span> &amp;&amp; code &lt;= <span class="number">0x7ff</span>) s++;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (code &gt; <span class="number">0x7ff</span> &amp;&amp; code &lt;= <span class="number">0xffff</span>) s += <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (code &gt;= <span class="number">0xdc00</span> &amp;&amp; code &lt;= <span class="number">0xdfff</span>) i--;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-判断是否以某个字符串结束"><a href="#7-判断是否以某个字符串结束" class="headerlink" title="7. 判断是否以某个字符串结束"></a>7. 判断是否以某个字符串结束</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.endWith = <span class="function"><span class="keyword">function</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> d = <span class="built_in">this</span>.length - s.length;</span><br><span class="line">  <span class="keyword">return</span> d &gt;= <span class="number">0</span> &amp;&amp; <span class="built_in">this</span>.lastIndexOf(s) == d;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="数字格式化"><a href="#数字格式化" class="headerlink" title="数字格式化"></a>数字格式化</h2><h3 id="1-千分号加逗号，即个位数开始每隔三位数，就用逗号隔开"><a href="#1-千分号加逗号，即个位数开始每隔三位数，就用逗号隔开" class="headerlink" title="1. 千分号加逗号，即个位数开始每隔三位数，就用逗号隔开"></a>1. 千分号加逗号，即个位数开始每隔三位数，就用逗号隔开</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numFormat</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (num == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">isNaN</span>(num)) &#123;</span><br><span class="line">    num = num.toString();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (num.indexOf(<span class="string">&quot;.&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> decimals = num.split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      (<span class="built_in">parseInt</span>(<span class="built_in">Number</span>(num)) + <span class="string">&quot;&quot;</span>).replace(</span><br><span class="line">        /\d&#123;<span class="number">1</span>,<span class="number">3</span>&#125;(?=(\d&#123;<span class="number">3</span>&#125;)+(\.\d*)?$)/g,</span><br><span class="line">        <span class="string">&quot;$&amp;,&quot;</span></span><br><span class="line">      ) +</span><br><span class="line">      <span class="string">&quot;.&quot;</span> +</span><br><span class="line">      decimals.substring(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">    );</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">parseInt</span>(<span class="built_in">Number</span>(num)).toFixed(<span class="number">0</span>) + <span class="string">&quot;&quot;</span>).replace(</span><br><span class="line">      /\d&#123;<span class="number">1</span>,<span class="number">3</span>&#125;(?=(\d&#123;<span class="number">3</span>&#125;)+(\.\d*)?$)/g,</span><br><span class="line">      <span class="string">&quot;$&amp;,&quot;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numFormat(<span class="number">10000000.08</span>); <span class="comment">// 10,000,000.08</span></span><br></pre></td></tr></table></figure><h3 id="2-千分号去掉逗号"><a href="#2-千分号去掉逗号" class="headerlink" title="2. 千分号去掉逗号"></a>2. 千分号去掉逗号</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delNumFormat</span>(<span class="params">snum</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> snum.replace(<span class="regexp">/,/g</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delNumFormat(<span class="string">&quot;10,100,100,100.08&quot;</span>); <span class="comment">// 10100100100.08</span></span><br></pre></td></tr></table></figure><h3 id="3-阿拉伯数字转中文大写数字"><a href="#3-阿拉伯数字转中文大写数字" class="headerlink" title="3. 阿拉伯数字转中文大写数字"></a>3. 阿拉伯数字转中文大写数字</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> numberToChinese = <span class="function"><span class="keyword">function</span> (<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 将阿拉伯数字翻译成中文的大写数字</span></span><br><span class="line">  <span class="keyword">let</span> AA = <span class="keyword">new</span> <span class="built_in">Array</span>(</span><br><span class="line">    <span class="string">&quot;零&quot;</span>,</span><br><span class="line">    <span class="string">&quot;一&quot;</span>,</span><br><span class="line">    <span class="string">&quot;二&quot;</span>,</span><br><span class="line">    <span class="string">&quot;三&quot;</span>,</span><br><span class="line">    <span class="string">&quot;四&quot;</span>,</span><br><span class="line">    <span class="string">&quot;五&quot;</span>,</span><br><span class="line">    <span class="string">&quot;六&quot;</span>,</span><br><span class="line">    <span class="string">&quot;七&quot;</span>,</span><br><span class="line">    <span class="string">&quot;八&quot;</span>,</span><br><span class="line">    <span class="string">&quot;九&quot;</span>,</span><br><span class="line">    <span class="string">&quot;十&quot;</span></span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">let</span> BB = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;十&quot;</span>, <span class="string">&quot;百&quot;</span>, <span class="string">&quot;仟&quot;</span>, <span class="string">&quot;萬&quot;</span>, <span class="string">&quot;億&quot;</span>, <span class="string">&quot;点&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> a = (<span class="string">&quot;&quot;</span> + num).replace(<span class="regexp">/(^0*)/g</span>, <span class="string">&quot;&quot;</span>).split(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> k = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> re = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = a[<span class="number">0</span>].length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        re = BB[<span class="number">7</span>] + re;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;0&#123;4&#125;//d&#123;&quot;</span> + (a[<span class="number">0</span>].length - i - <span class="number">1</span>) + <span class="string">&quot;&#125;$&quot;</span>).test(a[<span class="number">0</span>])) &#123;</span><br><span class="line">          re = BB[<span class="number">4</span>] + re;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        re = BB[<span class="number">5</span>] + re;</span><br><span class="line">        BB[<span class="number">7</span>] = BB[<span class="number">5</span>];</span><br><span class="line">        k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (k % <span class="number">4</span> === <span class="number">2</span> &amp;&amp; a[<span class="number">0</span>].charAt(i + <span class="number">2</span>) !== <span class="number">0</span> &amp;&amp; a[<span class="number">0</span>].charAt(i + <span class="number">1</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">      re = AA[<span class="number">0</span>] + re;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a[<span class="number">0</span>].charAt(i) !== <span class="number">0</span>) &#123;</span><br><span class="line">      re = AA[a[<span class="number">0</span>].charAt(i)] + BB[k % <span class="number">4</span>] + re;</span><br><span class="line">    &#125;</span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (a.length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// 加上小数部分(如果有小数部分)</span></span><br><span class="line">    re += BB[<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; a[<span class="number">1</span>].length; i++) &#123;</span><br><span class="line">      re += AA[a[<span class="number">1</span>].charAt(i)];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (re === <span class="string">&quot;一十&quot;</span>) &#123;</span><br><span class="line">    re = <span class="string">&quot;十&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (re.match(<span class="regexp">/^一/</span>) &amp;&amp; re.length === <span class="number">3</span>) &#123;</span><br><span class="line">    re = re.replace(<span class="string">&quot;一&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> re;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="4-生成随机数范围"><a href="#4-生成随机数范围" class="headerlink" title="4. 生成随机数范围"></a>4. 生成随机数范围</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> random = <span class="function"><span class="keyword">function</span> (<span class="params">min, max</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 生成随机数范围</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.floor(min + <span class="built_in">Math</span>.random() * (max + <span class="number">1</span> - min));</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="关于地图方面"><a href="#关于地图方面" class="headerlink" title="关于地图方面"></a>关于地图方面</h2><h3 id="1-计算两个经纬度之间的距离"><a href="#1-计算两个经纬度之间的距离" class="headerlink" title="1. 计算两个经纬度之间的距离"></a>1. 计算两个经纬度之间的距离</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">distance</span>(<span class="params">la1, lo1, la2, lo2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> La1 = (la1 * <span class="built_in">Math</span>.PI) / <span class="number">180.0</span>;</span><br><span class="line">  <span class="keyword">var</span> La2 = (la2 * <span class="built_in">Math</span>.PI) / <span class="number">180.0</span>;</span><br><span class="line">  <span class="keyword">var</span> La3 = La1 - La2;</span><br><span class="line">  <span class="keyword">var</span> Lb3 = (lo1 * <span class="built_in">Math</span>.PI) / <span class="number">180.0</span> - (lo2 * <span class="built_in">Math</span>.PI) / <span class="number">180.0</span>;</span><br><span class="line">  <span class="keyword">var</span> s =</span><br><span class="line">    <span class="number">2</span> *</span><br><span class="line">    <span class="built_in">Math</span>.asin(</span><br><span class="line">      <span class="built_in">Math</span>.sqrt(</span><br><span class="line">        <span class="built_in">Math</span>.pow(<span class="built_in">Math</span>.sin(La3 / <span class="number">2</span>), <span class="number">2</span>) +</span><br><span class="line">          <span class="built_in">Math</span>.cos(La1) * <span class="built_in">Math</span>.cos(La2) * <span class="built_in">Math</span>.pow(<span class="built_in">Math</span>.sin(Lb3 / <span class="number">2</span>), <span class="number">2</span>)</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">  s = s * <span class="number">6378.137</span>;</span><br><span class="line">  s = <span class="built_in">Math</span>.round(s * <span class="number">10000</span>) / <span class="number">10000</span>;</span><br><span class="line">  s = s * <span class="number">1000</span>; <span class="comment">//转为米单位</span></span><br><span class="line">  s = s.toFixed(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-各种地图坐标系的转换"><a href="#2-各种地图坐标系的转换" class="headerlink" title="2. 各种地图坐标系的转换"></a>2. 各种地图坐标系的转换</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义一些常量</span></span><br><span class="line"><span class="keyword">var</span> x_PI = (<span class="number">3.14159265358979324</span> * <span class="number">3000.0</span>) / <span class="number">180.0</span>;</span><br><span class="line"><span class="keyword">var</span> PI = <span class="number">3.1415926535897932384626</span>;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">6378245.0</span>;</span><br><span class="line"><span class="keyword">var</span> ee = <span class="number">0.00669342162296594323</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 百度坐标系 (BD-09) 与 火星坐标系 (GCJ-02)的转换</span></span><br><span class="line"><span class="comment"> * 即 百度 转 谷歌、高德</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">bd_lon</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">bd_lat</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;*[]&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bd09togcj02</span>(<span class="params">bd_lon, bd_lat</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> bd_lon = +bd_lon;</span><br><span class="line">  <span class="keyword">var</span> bd_lat = +bd_lat;</span><br><span class="line">  <span class="keyword">var</span> x = bd_lon - <span class="number">0.0065</span>;</span><br><span class="line">  <span class="keyword">var</span> y = bd_lat - <span class="number">0.006</span>;</span><br><span class="line">  <span class="keyword">var</span> z = <span class="built_in">Math</span>.sqrt(x * x + y * y) - <span class="number">0.00002</span> * <span class="built_in">Math</span>.sin(y * x_PI);</span><br><span class="line">  <span class="keyword">var</span> theta = <span class="built_in">Math</span>.atan2(y, x) - <span class="number">0.000003</span> * <span class="built_in">Math</span>.cos(x * x_PI);</span><br><span class="line">  <span class="keyword">var</span> gg_lng = z * <span class="built_in">Math</span>.cos(theta);</span><br><span class="line">  <span class="keyword">var</span> gg_lat = z * <span class="built_in">Math</span>.sin(theta);</span><br><span class="line">  <span class="keyword">return</span> [gg_lng, gg_lat];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 火星坐标系 (GCJ-02) 与百度坐标系 (BD-09) 的转换</span></span><br><span class="line"><span class="comment"> * 即谷歌、高德 转 百度</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">lng</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">lat</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;*[]&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gcj02tobd09</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lat = +lat;</span><br><span class="line">  <span class="keyword">var</span> lng = +lng;</span><br><span class="line">  <span class="keyword">var</span> z = <span class="built_in">Math</span>.sqrt(lng * lng + lat * lat) + <span class="number">0.00002</span> * <span class="built_in">Math</span>.sin(lat * x_PI);</span><br><span class="line">  <span class="keyword">var</span> theta = <span class="built_in">Math</span>.atan2(lat, lng) + <span class="number">0.000003</span> * <span class="built_in">Math</span>.cos(lng * x_PI);</span><br><span class="line">  <span class="keyword">var</span> bd_lng = z * <span class="built_in">Math</span>.cos(theta) + <span class="number">0.0065</span>;</span><br><span class="line">  <span class="keyword">var</span> bd_lat = z * <span class="built_in">Math</span>.sin(theta) + <span class="number">0.006</span>;</span><br><span class="line">  <span class="keyword">return</span> [bd_lng, bd_lat];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * WGS84转GCj02</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">lng</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">lat</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;*[]&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wgs84togcj02</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lat = +lat;</span><br><span class="line">  <span class="keyword">var</span> lng = +lng;</span><br><span class="line">  <span class="keyword">if</span> (out_of_china(lng, lat)) &#123;</span><br><span class="line">    <span class="keyword">return</span> [lng, lat];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> dlat = transformlat(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">    <span class="keyword">var</span> dlng = transformlng(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">    <span class="keyword">var</span> radlat = (lat / <span class="number">180.0</span>) * PI;</span><br><span class="line">    <span class="keyword">var</span> magic = <span class="built_in">Math</span>.sin(radlat);</span><br><span class="line">    magic = <span class="number">1</span> - ee * magic * magic;</span><br><span class="line">    <span class="keyword">var</span> sqrtmagic = <span class="built_in">Math</span>.sqrt(magic);</span><br><span class="line">    dlat = (dlat * <span class="number">180.0</span>) / (((a * (<span class="number">1</span> - ee)) / (magic * sqrtmagic)) * PI);</span><br><span class="line">    dlng = (dlng * <span class="number">180.0</span>) / ((a / sqrtmagic) * <span class="built_in">Math</span>.cos(radlat) * PI);</span><br><span class="line">    <span class="keyword">var</span> mglat = lat + dlat;</span><br><span class="line">    <span class="keyword">var</span> mglng = lng + dlng;</span><br><span class="line">    <span class="keyword">return</span> [mglng, mglat];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * GCJ02 转换为 WGS84</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">lng</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">lat</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;*[]&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gcj02towgs84</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lat = +lat;</span><br><span class="line">  <span class="keyword">var</span> lng = +lng;</span><br><span class="line">  <span class="keyword">if</span> (out_of_china(lng, lat)) &#123;</span><br><span class="line">    <span class="keyword">return</span> [lng, lat];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> dlat = transformlat(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">    <span class="keyword">var</span> dlng = transformlng(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">    <span class="keyword">var</span> radlat = (lat / <span class="number">180.0</span>) * PI;</span><br><span class="line">    <span class="keyword">var</span> magic = <span class="built_in">Math</span>.sin(radlat);</span><br><span class="line">    magic = <span class="number">1</span> - ee * magic * magic;</span><br><span class="line">    <span class="keyword">var</span> sqrtmagic = <span class="built_in">Math</span>.sqrt(magic);</span><br><span class="line">    dlat = (dlat * <span class="number">180.0</span>) / (((a * (<span class="number">1</span> - ee)) / (magic * sqrtmagic)) * PI);</span><br><span class="line">    dlng = (dlng * <span class="number">180.0</span>) / ((a / sqrtmagic) * <span class="built_in">Math</span>.cos(radlat) * PI);</span><br><span class="line">    <span class="keyword">var</span> mglat = lat + dlat;</span><br><span class="line">    <span class="keyword">var</span> mglng = lng + dlng;</span><br><span class="line">    <span class="keyword">return</span> [lng * <span class="number">2</span> - mglng, lat * <span class="number">2</span> - mglat];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">transformlat</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lat = +lat;</span><br><span class="line">  <span class="keyword">var</span> lng = +lng;</span><br><span class="line">  <span class="keyword">var</span> ret =</span><br><span class="line">    -<span class="number">100.0</span> +</span><br><span class="line">    <span class="number">2.0</span> * lng +</span><br><span class="line">    <span class="number">3.0</span> * lat +</span><br><span class="line">    <span class="number">0.2</span> * lat * lat +</span><br><span class="line">    <span class="number">0.1</span> * lng * lat +</span><br><span class="line">    <span class="number">0.2</span> * <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.abs(lng));</span><br><span class="line">  ret +=</span><br><span class="line">    ((<span class="number">20.0</span> * <span class="built_in">Math</span>.sin(<span class="number">6.0</span> * lng * PI) + <span class="number">20.0</span> * <span class="built_in">Math</span>.sin(<span class="number">2.0</span> * lng * PI)) *</span><br><span class="line">      <span class="number">2.0</span>) /</span><br><span class="line">    <span class="number">3.0</span>;</span><br><span class="line">  ret +=</span><br><span class="line">    ((<span class="number">20.0</span> * <span class="built_in">Math</span>.sin(lat * PI) + <span class="number">40.0</span> * <span class="built_in">Math</span>.sin((lat / <span class="number">3.0</span>) * PI)) * <span class="number">2.0</span>) /</span><br><span class="line">    <span class="number">3.0</span>;</span><br><span class="line">  ret +=</span><br><span class="line">    ((<span class="number">160.0</span> * <span class="built_in">Math</span>.sin((lat / <span class="number">12.0</span>) * PI) + <span class="number">320</span> * <span class="built_in">Math</span>.sin((lat * PI) / <span class="number">30.0</span>)) *</span><br><span class="line">      <span class="number">2.0</span>) /</span><br><span class="line">    <span class="number">3.0</span>;</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">transformlng</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lat = +lat;</span><br><span class="line">  <span class="keyword">var</span> lng = +lng;</span><br><span class="line">  <span class="keyword">var</span> ret =</span><br><span class="line">    <span class="number">300.0</span> +</span><br><span class="line">    lng +</span><br><span class="line">    <span class="number">2.0</span> * lat +</span><br><span class="line">    <span class="number">0.1</span> * lng * lng +</span><br><span class="line">    <span class="number">0.1</span> * lng * lat +</span><br><span class="line">    <span class="number">0.1</span> * <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.abs(lng));</span><br><span class="line">  ret +=</span><br><span class="line">    ((<span class="number">20.0</span> * <span class="built_in">Math</span>.sin(<span class="number">6.0</span> * lng * PI) + <span class="number">20.0</span> * <span class="built_in">Math</span>.sin(<span class="number">2.0</span> * lng * PI)) *</span><br><span class="line">      <span class="number">2.0</span>) /</span><br><span class="line">    <span class="number">3.0</span>;</span><br><span class="line">  ret +=</span><br><span class="line">    ((<span class="number">20.0</span> * <span class="built_in">Math</span>.sin(lng * PI) + <span class="number">40.0</span> * <span class="built_in">Math</span>.sin((lng / <span class="number">3.0</span>) * PI)) * <span class="number">2.0</span>) /</span><br><span class="line">    <span class="number">3.0</span>;</span><br><span class="line">  ret +=</span><br><span class="line">    ((<span class="number">150.0</span> * <span class="built_in">Math</span>.sin((lng / <span class="number">12.0</span>) * PI) +</span><br><span class="line">      <span class="number">300.0</span> * <span class="built_in">Math</span>.sin((lng / <span class="number">30.0</span>) * PI)) *</span><br><span class="line">      <span class="number">2.0</span>) /</span><br><span class="line">    <span class="number">3.0</span>;</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断是否在国内，不在国内则不做偏移</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">lng</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">lat</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;boolean&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">out_of_china</span>(<span class="params">lng, lat</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lat = +lat;</span><br><span class="line">  <span class="keyword">var</span> lng = +lng;</span><br><span class="line">  <span class="comment">// 纬度3.86~53.55,经度73.66~135.05</span></span><br><span class="line">  <span class="keyword">return</span> !(lng &gt; <span class="number">73.66</span> &amp;&amp; lng &lt; <span class="number">135.05</span> &amp;&amp; lat &gt; <span class="number">3.86</span> &amp;&amp; lat &lt; <span class="number">53.55</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="页面跳转传参-获取参数值"><a href="#页面跳转传参-获取参数值" class="headerlink" title="页面跳转传参 获取参数值"></a>页面跳转传参 获取参数值</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUrlParam</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;(^|&amp;)&quot;</span> + name + <span class="string">&quot;=([^&amp;]*)(&amp;|$)&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> r = <span class="built_in">decodeURIComponent</span>(<span class="built_in">window</span>.location.search).substr(<span class="number">1</span>).match(reg);</span><br><span class="line">  <span class="keyword">if</span> (r != <span class="literal">null</span>) <span class="keyword">return</span> <span class="built_in">unescape</span>(r[<span class="number">2</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**提取url地址中的参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> <span class="variable">url</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;Object&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getQueryObject</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  url = url == <span class="literal">null</span> ? <span class="built_in">window</span>.location.href : url;</span><br><span class="line">  <span class="keyword">const</span> search = url.substring(url.lastIndexOf(<span class="string">&quot;?&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">const</span> reg = <span class="regexp">/([^?&amp;=]+)=([^?&amp;=]*)/g</span>;</span><br><span class="line">  search.replace(reg, <span class="function">(<span class="params">rs, $<span class="number">1</span>, $<span class="number">2</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> name = <span class="built_in">decodeURIComponent</span>($<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> val = <span class="built_in">decodeURIComponent</span>($<span class="number">2</span>);</span><br><span class="line">    val = <span class="built_in">String</span>(val);</span><br><span class="line">    obj[name] = val;</span><br><span class="line">    <span class="keyword">return</span> rs;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//*获取url连接问号后面的参数*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">queryValue</span>(<span class="params">query</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> url = <span class="built_in">window</span>.location.href.split(<span class="string">&quot;?&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">var</span> arr = url.split(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (arr &amp;&amp; arr.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> queryVal = arr[i].split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (queryVal[<span class="number">0</span>] == query) <span class="keyword">return</span> queryVal[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="前端获取-uuid"><a href="#前端获取-uuid" class="headerlink" title="前端获取 uuid"></a>前端获取 uuid</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">getUuid</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">   <span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">   <span class="keyword">if</span> (<span class="built_in">window</span>.performance &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">window</span>.performance.now === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">        d += performance.now();  <span class="comment">//use high-precision timer if available</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">var</span> uuid = <span class="string">&#x27;xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx&#x27;</span>.replace(<span class="regexp">/[xy]/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">c</span>) </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> r = (d + <span class="built_in">Math</span>.random() * <span class="number">16</span>) % <span class="number">16</span> | <span class="number">0</span>;</span><br><span class="line">       d = <span class="built_in">Math</span>.floor(d / <span class="number">16</span>);</span><br><span class="line">       <span class="keyword">return</span> (c == <span class="string">&#x27;x&#x27;</span> ? r : (r &amp; <span class="number">0x3</span> | <span class="number">0x8</span>)).toString(<span class="number">16</span>);</span><br><span class="line">   &#125;);</span><br><span class="line">  <span class="keyword">return</span> uuid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="两个数的加减乘除，解决小数运算出现多位小数"><a href="#两个数的加减乘除，解决小数运算出现多位小数" class="headerlink" title="两个数的加减乘除，解决小数运算出现多位小数"></a>两个数的加减乘除，解决小数运算出现多位小数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//浮点数相加，解决小数运算出现多位小数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addNum</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sq1, sq2, m;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    sq1 = num1.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    sq1 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    sq2 = num2.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    sq2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  m = <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="built_in">Math</span>.max(sq1, sq2));</span><br><span class="line">  <span class="keyword">return</span> (num1 * m + num2 * m) / m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//浮点数相减，解决小数运算出现多位小数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">subNum</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> r1, r2, m, n;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    r1 = num1.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    r1 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    r2 = num2.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    r2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  m = <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="built_in">Math</span>.max(r1, r2));</span><br><span class="line">  n = r1 &gt;= r2 ? r1 : r2;</span><br><span class="line">  <span class="keyword">return</span> (<span class="built_in">Math</span>.round(num1 * m - num2 * m) / m).toFixed(n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//浮点数相乘，解决小数运算出现多位小数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mulNum</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> m = <span class="number">0</span>,</span><br><span class="line">    r1,</span><br><span class="line">    r2;</span><br><span class="line">  <span class="keyword">var</span> s1 = num1.toString();</span><br><span class="line">  <span class="keyword">var</span> s2 = num2.toString();</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    m += s1.split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    m += s2.split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">  r1 = <span class="built_in">Number</span>(num1.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">  r2 = <span class="built_in">Number</span>(num2.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">  <span class="keyword">return</span> (r1 * r2) / <span class="built_in">Math</span>.pow(<span class="number">10</span>, m);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//浮点数相除，解决小数运算出现多位小数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">divNum</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> c,</span><br><span class="line">    d,</span><br><span class="line">    e = <span class="number">0</span>,</span><br><span class="line">    f = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    e = num1.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (g) &#123;&#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    f = num2.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (g) &#123;&#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    (c = <span class="built_in">Number</span>(num1.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>))),</span><br><span class="line">    (d = <span class="built_in">Number</span>(num2.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>))),</span><br><span class="line">    <span class="built_in">this</span>.mulNum(c / d, <span class="built_in">Math</span>.pow(<span class="number">10</span>, f - e))</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="判断是否为空对象、空数组"><a href="#判断是否为空对象、空数组" class="headerlink" title="判断是否为空对象、空数组"></a>判断是否为空对象、空数组</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isEmpty</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//检验 null 和 undefined 和 &#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> (!obj &amp;&amp; obj !== <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//检验数组</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Array</span>.prototype.isPrototypeOf(obj) &amp;&amp; obj.length === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//检验对象</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.isPrototypeOf(obj) &amp;&amp; <span class="built_in">Object</span>.keys(obj).length === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="数组去重"><a href="#数组去重" class="headerlink" title="数组去重"></a>数组去重</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//*利用ES6 Set去重*/</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;Array&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueArr</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;请传入数组&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(arr))</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//* 根据对象的属性不同去重 */</span></span><br><span class="line"><span class="function"><span class="title">handleRepeatArr</span>(<span class="params">&#123;data, key&#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(data)) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;请传入数组&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> arr = [], obj = &#123;&#125;</span><br><span class="line">    data.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> attr = key ? item[key] : item</span><br><span class="line">      <span class="keyword">if</span> (!obj[attr]) &#123;</span><br><span class="line">        obj[attr] = index + <span class="number">1</span></span><br><span class="line">        arr.push(item)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//* 利用indexOf以及forEach (适合处理数组，不适合处理对象数组)*/</span></span><br><span class="line"><span class="function"><span class="title">handleRepeatArr</span>(<span class="params">&#123;data, key&#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(data)) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;请传入数组&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> arr = []</span><br><span class="line">    data.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 如果当前元素在之后没有出现过(后面出现的数据会保留)</span></span><br><span class="line">      <span class="comment">// let result = data.indexOf(item, index + 1)</span></span><br><span class="line">      <span class="comment">// 如果当前元素在之前没有出现过(前面出现的数据会保留)</span></span><br><span class="line">      <span class="keyword">let</span> result = index === <span class="number">0</span> ? -<span class="number">1</span> : data.lastIndexOf(item, index - <span class="number">1</span>)</span><br><span class="line">      <span class="keyword">if</span> (result === -<span class="number">1</span>) &#123;</span><br><span class="line">        arr.push(item)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//* 双层循环去重 （占用内存高）*/</span></span><br><span class="line">handleRepeatArr (&#123;data, key&#125;) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(data)) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;请传入数组&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = data.length; i &lt; len; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; len; j++) &#123;</span><br><span class="line">        <span class="keyword">let</span> result = key ? data[i][key] === data[j][key] : data[i] === data[j]</span><br><span class="line">        <span class="keyword">if</span> (result) &#123;</span><br><span class="line">          data.splice(j, <span class="number">1</span>)</span><br><span class="line">          len--</span><br><span class="line">          j--</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//* 递归去重(数据无法保持之前的排序)*/</span></span><br><span class="line">handleRepeatArr (&#123;data, key&#125;) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(data)) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;请传入数组&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 先对数据做排序处理</span></span><br><span class="line">    data = data.sort(<span class="function">(<span class="params">item, item1</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (key) &#123;</span><br><span class="line">        <span class="keyword">return</span> item[key] - item1[key]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> item - item1</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 递归去重</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getData</span> (<span class="params">index</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (index &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// 判断当前数据和下一条数据是否相等</span></span><br><span class="line">        <span class="keyword">let</span> result = key ? data[index][key] === data[index - <span class="number">1</span>][key] : data[index] === data[index - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> (result) &#123;</span><br><span class="line">          data.splice(index, <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        getData(index - <span class="number">1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    getData(data.length - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="数组排序"><a href="#数组排序" class="headerlink" title="数组排序"></a>数组排序</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 快排 [left] + min + [right]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickArr</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (arr.length &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> left = [],</span><br><span class="line">    right = [];</span><br><span class="line">  <span class="keyword">var</span> pIndex = <span class="built_in">Math</span>.floor(arr.length / <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">var</span> p = arr.splice(pIndex, <span class="number">1</span>)[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr[i] &lt;= p) &#123;</span><br><span class="line">      left.push(arr[i]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      right.push(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 递归</span></span><br><span class="line">  <span class="keyword">return</span> quickArr(left).concat([p], quickArr(right));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 冒泡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = i + <span class="number">1</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[i] &gt; arr[j]) &#123;</span><br><span class="line">        <span class="keyword">var</span> temp = arr[i];</span><br><span class="line">        arr[i] = arr[j];</span><br><span class="line">        arr[j] = temp;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> len = arr.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; len - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">        <span class="keyword">var</span> temp = arr[j];</span><br><span class="line">        arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">        arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="去除对象中为空的属性"><a href="#去除对象中为空的属性" class="headerlink" title="去除对象中为空的属性"></a>去除对象中为空的属性</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleValue</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[key] === <span class="string">&quot;&quot;</span> || data[key] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">delete</span> data[key];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="递归深拷贝"><a href="#递归深拷贝" class="headerlink" title="递归深拷贝"></a>递归深拷贝</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 递归实现深拷贝 (为了解决循环引用和相同引用、不同类型的深拷贝)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 判断类型</span></span><br><span class="line">  <span class="keyword">return</span> obj !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> obj === <span class="string">&quot;object&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**通过闭包维护一个变量，变量中储存已经遍历过的对象</span></span><br><span class="line"><span class="comment"> *每次递归时判断当前的参数是否已经存在于变量中，如果已经存在，就说明已经递归过该变量，就可以停止这次递归并返回上次递归该变量时的返回值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_deepClone</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> visitedObjs = [];</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">baseClone</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isObject(target)) <span class="keyword">return</span> target;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; visitedObjs.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (visitedObjs[i].target === target) &#123;</span><br><span class="line">        <span class="keyword">return</span> visitedObjs[i].result;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="built_in">Array</span>.isArray(target) ? [] : &#123;&#125;;</span><br><span class="line">    visitedObjs.push(&#123; target, result &#125;);</span><br><span class="line">    <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(target);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = keys.length; i &lt; len; i++) &#123;</span><br><span class="line">      result[keys[i]] = baseClone(target[keys[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> baseClone(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="json-转-url-参数"><a href="#json-转-url-参数" class="headerlink" title="json 转 url 参数"></a>json 转 url 参数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseParams</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> tempArr = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> data) &#123;</span><br><span class="line">      <span class="keyword">var</span> key = <span class="built_in">encodeURIComponent</span>(i);</span><br><span class="line">      <span class="keyword">var</span> value = <span class="built_in">encodeURIComponent</span>(data[i]);</span><br><span class="line">      tempArr.push(key + <span class="string">&quot;=&quot;</span> + value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> urlParamsStr = tempArr.join(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> urlParamsStr;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="阻止事件冒泡"><a href="#阻止事件冒泡" class="headerlink" title="阻止事件冒泡"></a>阻止事件冒泡</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">stopEventPropagation</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (event.stopPropagation) &#123;</span><br><span class="line">    <span class="comment">// this code is for Mozilla and Opera</span></span><br><span class="line">    event.stopPropagation();</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.event) &#123;</span><br><span class="line">    <span class="comment">// this code is for IE</span></span><br><span class="line">    <span class="built_in">window</span>.event.cancelBubble = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="将有层级关系的列表转换成树状数据"><a href="#将有层级关系的列表转换成树状数据" class="headerlink" title="将有层级关系的列表转换成树状数据"></a>将有层级关系的列表转换成树状数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">用法示例：let arr &#x3D; [&#123;id: 1, pid: 0, name: &#39;一级&#39;&#125;, &#123;id: 2, pid: 1, name: &#39;二级&#39;&#125;],</span><br><span class="line">           arr1 &#x3D; getTreeArr(&#123;key: &#39;id&#39;, pKey: &#39;pid&#39;, rootPValue: 0, data: arr&#125;)</span><br><span class="line">得到的数据为:</span><br><span class="line">       arr1 &#x3D; [</span><br><span class="line">           &#123;id: 1, pid: 0, name: &#39;一级&#39;, children: [&#123;id: 2, pid: 1, name: &#39;二级&#39;, children: []&#125;]</span><br><span class="line">           &#125;</span><br><span class="line">       ]</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将一级的数据结构处理成树状数据结构</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>obj &#123;key, pKey, data&#125;</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param </span>obj.key  字段名称 比如id</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param </span>obj.pKey 父字段名称 比如 pid</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param </span>obj.rootPValue 根节点的父字段的值</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param </span>obj.data 需要处理的数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Array&#125;</span> <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">getTreeArr: <span class="function">(<span class="params">obj</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(obj.data)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;getTreeArr=&gt;请传入数组&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> [];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> arr = obj.data,</span><br><span class="line">    arr1 = [];</span><br><span class="line">  <span class="comment">// 将数据处理成数状结构</span></span><br><span class="line">  arr.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">    item.children = [];</span><br><span class="line">    arr.forEach(<span class="function">(<span class="params">item1</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 得到树结构关系</span></span><br><span class="line">      <span class="keyword">if</span> (item[obj.key] === item1[obj.pKey]) &#123;</span><br><span class="line">        item.children.push(item1);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 判断根节点</span></span><br><span class="line">      <span class="keyword">if</span> (item1.id !== item.pid) &#123;</span><br><span class="line">        index++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 传入根节点，根据传入的根节点组成树结构</span></span><br><span class="line">      <span class="keyword">if</span> (rootPValue <span class="keyword">in</span> obj &amp;&amp; item[obj.pKey] === obj.rootPValue) &#123;</span><br><span class="line">        arr1.push(item);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 没传入根节点，根据当前数据结构得到根节点</span></span><br><span class="line">    <span class="keyword">if</span> (!(rootPValue <span class="keyword">in</span> obj) &amp;&amp; index === arr.length) &#123;</span><br><span class="line">      arr1.push(item);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> arr1;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="获取浏览器类型"><a href="#获取浏览器类型" class="headerlink" title="获取浏览器类型"></a>获取浏览器类型</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getBrowserType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> str = <span class="built_in">window</span>.navigator.userAgent;</span><br><span class="line">  <span class="keyword">let</span> name;</span><br><span class="line">  <span class="keyword">if</span> (str.indexOf(<span class="string">&quot;Opera&quot;</span>) &gt; -<span class="number">1</span> || str.indexOf(<span class="string">&quot;OPR&quot;</span>) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">    name = <span class="string">&quot;Opera&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (str.indexOf(<span class="string">&quot;Edge&quot;</span>) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">    name = <span class="string">&quot;Edge&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (str.indexOf(<span class="string">&quot;Firefox&quot;</span>) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">    name = <span class="string">&quot;Firefox&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (str.indexOf(<span class="string">&quot;Chrome&quot;</span>) &gt; -<span class="number">1</span> &amp;&amp; str.indexOf(<span class="string">&quot;Safari&quot;</span>) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">    name = <span class="string">&quot;Chrome&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (str.indexOf(<span class="string">&quot;Chrome&quot;</span>) === -<span class="number">1</span> &amp;&amp; str.indexOf(<span class="string">&quot;Safari&quot;</span>) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">    name = <span class="string">&quot;Safari&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    (str.indexOf(<span class="string">&quot;Opera&quot;</span>) === -<span class="number">1</span> &amp;&amp; str.indexOf(<span class="string">&quot;MSIE&quot;</span>) &gt; -<span class="number">1</span>) ||</span><br><span class="line">    str.indexOf(<span class="string">&quot;Trident&quot;</span>) &gt; -<span class="number">1</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    name = <span class="string">&quot;IE&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="跨浏览器删除事件"><a href="#跨浏览器删除事件" class="headerlink" title="跨浏览器删除事件"></a>跨浏览器删除事件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delEvt</span>(<span class="params">obj, evt, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!obj) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (obj.addEventListener) &#123;</span><br><span class="line">    obj.addEventListener(evt, fn, <span class="literal">false</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (oTarget.attachEvent) &#123;</span><br><span class="line">    obj.attachEvent(<span class="string">&quot;on&quot;</span> + evt, fn);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    obj[<span class="string">&quot;on&quot;</span> + evt] = fn;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="post-方式下载文件流"><a href="#post-方式下载文件流" class="headerlink" title="post 方式下载文件流"></a>post 方式下载文件流</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ajax post 获取流，下载file文件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downloadFilePostStream</span>(<span class="params">apiStr, option</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//option为 传给后台的参数</span></span><br><span class="line">  <span class="keyword">let</span> body = <span class="built_in">document</span>.body || <span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;body&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">let</span> form = <span class="built_in">document</span>.createElement(<span class="string">&quot;form&quot;</span>);</span><br><span class="line">  form.className = <span class="string">&quot;myDownloadForm&quot;</span>;</span><br><span class="line">  form.setAttribute(<span class="string">&quot;action&quot;</span>, <span class="string">`<span class="subst">$&#123;globalHost&#125;</span><span class="subst">$&#123;apiStr&#125;</span>`</span>); <span class="comment">//配置</span></span><br><span class="line">  form.setAttribute(<span class="string">&quot;method&quot;</span>, <span class="string">&quot;post&quot;</span>);</span><br><span class="line">  form.setAttribute(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;downloadForm&quot;</span>);</span><br><span class="line">  form.setAttribute(<span class="string">&quot;target&quot;</span>, <span class="string">&quot;_blank&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> option) &#123;</span><br><span class="line">    <span class="keyword">if</span> (option[key] !== <span class="literal">undefined</span> &amp;&amp; option[key] !== <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="comment">//form表单的形式传undefined 会被转成字符串&#x27;undefined&#x27;，干脆直接不传了</span></span><br><span class="line">      <span class="keyword">let</span> input = <span class="built_in">document</span>.createElement(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">      input.setAttribute(<span class="string">&quot;name&quot;</span>, key);</span><br><span class="line">      input.value = option[key];</span><br><span class="line">      form.appendChild(input);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  body.appendChild(form);</span><br><span class="line">  form.submit();</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    body.removeChild(form);</span><br><span class="line">  &#125;, <span class="number">50</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="检验-URL-链接是否有效"><a href="#检验-URL-链接是否有效" class="headerlink" title="检验 URL 链接是否有效"></a>检验 URL 链接是否有效</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUrlState</span>(<span class="params">URL</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> ActiveXObject(<span class="string">&quot;microsoft.xmlhttp&quot;</span>);</span><br><span class="line">  xmlhttp.Open(<span class="string">&quot;GET&quot;</span>, URL, <span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    xmlhttp.Send();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> result = xmlhttp.responseText;</span><br><span class="line">    <span class="keyword">if</span> (result) &#123;</span><br><span class="line">      <span class="keyword">if</span> (xmlhttp.Status == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="随机数时间戳"><a href="#随机数时间戳" class="headerlink" title="随机数时间戳"></a>随机数时间戳</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueId</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">Math</span>.random,</span><br><span class="line">    b = <span class="built_in">parseInt</span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="built_in">Number</span>(<span class="keyword">new</span> <span class="built_in">Date</span>()).toString() + b(<span class="number">10</span> * a()) + b(<span class="number">10</span> * a()) + b(<span class="number">10</span> * a())</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="UTF8-解码"><a href="#UTF8-解码" class="headerlink" title="UTF8 解码"></a>UTF8 解码</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">utf8_decode</span>(<span class="params">str_data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> tmp_arr = [],</span><br><span class="line">    i = <span class="number">0</span>,</span><br><span class="line">    ac = <span class="number">0</span>,</span><br><span class="line">    c1 = <span class="number">0</span>,</span><br><span class="line">    c2 = <span class="number">0</span>,</span><br><span class="line">    c3 = <span class="number">0</span>;</span><br><span class="line">  str_data += <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">while</span> (i &lt; str_data.length) &#123;</span><br><span class="line">    c1 = str_data.charCodeAt(i);</span><br><span class="line">    <span class="keyword">if</span> (c1 &lt; <span class="number">128</span>) &#123;</span><br><span class="line">      tmp_arr[ac++] = <span class="built_in">String</span>.fromCharCode(c1);</span><br><span class="line">      i++;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c1 &gt; <span class="number">191</span> &amp;&amp; c1 &lt; <span class="number">224</span>) &#123;</span><br><span class="line">      c2 = str_data.charCodeAt(i + <span class="number">1</span>);</span><br><span class="line">      tmp_arr[ac++] = <span class="built_in">String</span>.fromCharCode(((c1 &amp; <span class="number">31</span>) &lt;&lt; <span class="number">6</span>) | (c2 &amp; <span class="number">63</span>));</span><br><span class="line">      i += <span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      c2 = str_data.charCodeAt(i + <span class="number">1</span>);</span><br><span class="line">      c3 = str_data.charCodeAt(i + <span class="number">2</span>);</span><br><span class="line">      tmp_arr[ac++] = <span class="built_in">String</span>.fromCharCode(</span><br><span class="line">        ((c1 &amp; <span class="number">15</span>) &lt;&lt; <span class="number">12</span>) | ((c2 &amp; <span class="number">63</span>) &lt;&lt; <span class="number">6</span>) | (c3 &amp; <span class="number">63</span>)</span><br><span class="line">      );</span><br><span class="line">      i += <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> tmp_arr.join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="获取其数据类型"><a href="#获取其数据类型" class="headerlink" title="获取其数据类型"></a>获取其数据类型</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">type</span>(<span class="params">para</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(para);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="字符串去重"><a href="#字符串去重" class="headerlink" title="字符串去重"></a>字符串去重</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.unique = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> obj = &#123;&#125;,</span><br><span class="line">    str = <span class="string">&quot;&quot;</span>,</span><br><span class="line">    len = <span class="built_in">this</span>.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!obj[<span class="built_in">this</span>[i]]) &#123;</span><br><span class="line">      str += <span class="built_in">this</span>[i];</span><br><span class="line">      obj[<span class="built_in">this</span>[i]] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//去除连续的字符串</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniq</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str.replace(<span class="regexp">/(\w)\1+/g</span>, <span class="string">&quot;$1&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="找出字符串中第一次只出现一次的字母"><a href="#找出字符串中第一次只出现一次的字母" class="headerlink" title="找出字符串中第一次只出现一次的字母"></a>找出字符串中第一次只出现一次的字母</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.firstAppear = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> obj = &#123;&#125;,</span><br><span class="line">    len = <span class="built_in">this</span>.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj[<span class="built_in">this</span>[i]]) &#123;</span><br><span class="line">      obj[<span class="built_in">this</span>[i]]++;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      obj[<span class="built_in">this</span>[i]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj[prop] == <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> prop;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="找元素的第-n-级父元素"><a href="#找元素的第-n-级父元素" class="headerlink" title="找元素的第 n 级父元素"></a>找元素的第 n 级父元素</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parents</span>(<span class="params">ele, n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (ele &amp;&amp; n) &#123;</span><br><span class="line">    ele = ele.parentElement ? ele.parentElement : ele.parentNode;</span><br><span class="line">    n--;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ele;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="返回元素的第-n-个兄弟节点"><a href="#返回元素的第-n-个兄弟节点" class="headerlink" title="返回元素的第 n 个兄弟节点"></a>返回元素的第 n 个兄弟节点</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">retSibling</span>(<span class="params">e, n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (e &amp;&amp; n) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (e.nextElementSibling) &#123;</span><br><span class="line">        e = e.nextElementSibling;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (e = e.nextSibling; e &amp;&amp; e.nodeType !== <span class="number">1</span>; e = e.nextSibling);</span><br><span class="line">      &#125;</span><br><span class="line">      n--;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (e.previousElementSibling) &#123;</span><br><span class="line">        e = e.previousElementSibling;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (</span><br><span class="line">          e = e.previousElementSibling;</span><br><span class="line">          e &amp;&amp; e.nodeType !== <span class="number">1</span>;</span><br><span class="line">          e = e.previousElementSibling</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">      n++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="判断元素有没有子元素"><a href="#判断元素有没有子元素" class="headerlink" title="判断元素有没有子元素"></a>判断元素有没有子元素</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasChildren</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> children = e.childNodes,</span><br><span class="line">    len = children.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (children[i].nodeType === <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="获得滚动条的滚动距离"><a href="#获得滚动条的滚动距离" class="headerlink" title="获得滚动条的滚动距离"></a>获得滚动条的滚动距离</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getScrollOffset</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.pageXOffset) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      x: <span class="built_in">window</span>.pageXOffset,</span><br><span class="line">      y: <span class="built_in">window</span>.pageYOffset,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      x: <span class="built_in">document</span>.body.scrollLeft + <span class="built_in">document</span>.documentElement.scrollLeft,</span><br><span class="line">      y: <span class="built_in">document</span>.body.scrollTop + <span class="built_in">document</span>.documentElement.scrollTop,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="获得视口的尺寸"><a href="#获得视口的尺寸" class="headerlink" title="获得视口的尺寸"></a>获得视口的尺寸</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getViewportOffset</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.innerWidth) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      w: <span class="built_in">window</span>.innerWidth,</span><br><span class="line">      h: <span class="built_in">window</span>.innerHeight,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// ie8及其以下</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.compatMode === <span class="string">&quot;BackCompat&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// 怪异模式</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        w: <span class="built_in">document</span>.body.clientWidth,</span><br><span class="line">        h: <span class="built_in">document</span>.body.clientHeight,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 标准模式</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        w: <span class="built_in">document</span>.documentElement.clientWidth,</span><br><span class="line">        h: <span class="built_in">document</span>.documentElement.clientHeight,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="绑定事件的兼容"><a href="#绑定事件的兼容" class="headerlink" title="绑定事件的兼容"></a>绑定事件的兼容</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addEvent</span>(<span class="params">elem, type, handle</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (elem.addEventListener) &#123;</span><br><span class="line">    <span class="comment">//非ie和非ie9</span></span><br><span class="line">    elem.addEventListener(type, handle, <span class="literal">false</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (elem.attachEvent) &#123;</span><br><span class="line">    <span class="comment">//ie6到ie8</span></span><br><span class="line">    elem.attachEvent(<span class="string">&quot;on&quot;</span> + type, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      handle.call(elem);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    elem[<span class="string">&quot;on&quot;</span> + type] = handle;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="解绑事件"><a href="#解绑事件" class="headerlink" title="解绑事件"></a>解绑事件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeEvent</span>(<span class="params">elem, type, handle</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (elem.removeEventListener) &#123;</span><br><span class="line">    <span class="comment">//非ie和非ie9</span></span><br><span class="line">    elem.removeEventListener(type, handle, <span class="literal">false</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (elem.detachEvent) &#123;</span><br><span class="line">    <span class="comment">//ie6到ie8</span></span><br><span class="line">    elem.detachEvent(<span class="string">&quot;on&quot;</span> + type, handle);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    elem[<span class="string">&quot;on&quot;</span> + type] = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="检验字符串是否是回文"><a href="#检验字符串是否是回文" class="headerlink" title="检验字符串是否是回文"></a>检验字符串是否是回文</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPalindrome</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    str = str.replace(<span class="regexp">/\W/g</span>, <span class="string">&#x27;&#x27;</span>).toLowerCase();</span><br><span class="line">    <span class="built_in">console</span>.log(str)</span><br><span class="line">    <span class="keyword">return</span> (str == str.split(<span class="string">&#x27;&#x27;</span>).reverse().join(<span class="string">&#x27;&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">===========</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPalina</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.toString.call(str) !== <span class="string">&#x27;[object String]&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> len = str.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len / <span class="number">2</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str[i] != str[len - <span class="number">1</span> - i]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="运动函数"><a href="#运动函数" class="headerlink" title="运动函数"></a>运动函数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">animate</span>(<span class="params">obj, json, callback</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">clearInterval</span>(obj.timer);</span><br><span class="line">  <span class="keyword">var</span> speed, current;</span><br><span class="line">  obj.timer = <span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> lock = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> json) &#123;</span><br><span class="line">      <span class="keyword">if</span> (prop == <span class="string">&quot;opacity&quot;</span>) &#123;</span><br><span class="line">        current = <span class="built_in">parseFloat</span>(<span class="built_in">window</span>.getComputedStyle(obj, <span class="literal">null</span>)[prop]) * <span class="number">100</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        current = <span class="built_in">parseInt</span>(<span class="built_in">window</span>.getComputedStyle(obj, <span class="literal">null</span>)[prop]);</span><br><span class="line">      &#125;</span><br><span class="line">      speed = (json[prop] - current) / <span class="number">7</span>;</span><br><span class="line">      speed = speed &gt; <span class="number">0</span> ? <span class="built_in">Math</span>.ceil(speed) : <span class="built_in">Math</span>.floor(speed);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (prop == <span class="string">&quot;opacity&quot;</span>) &#123;</span><br><span class="line">        obj.style[prop] = (current + speed) / <span class="number">100</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        obj.style[prop] = current + speed + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (current != json[prop]) &#123;</span><br><span class="line">        lock = <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (lock) &#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(obj.timer);</span><br><span class="line">      <span class="keyword">typeof</span> callback == <span class="string">&quot;function&quot;</span> ? callback() : <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">30</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="弹性运动"><a href="#弹性运动" class="headerlink" title="弹性运动"></a>弹性运动</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ElasticMovement</span>(<span class="params">obj, target</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">clearInterval</span>(obj.timer);</span><br><span class="line">  <span class="keyword">var</span> iSpeed = <span class="number">40</span>,</span><br><span class="line">    a,</span><br><span class="line">    u = <span class="number">0.8</span>;</span><br><span class="line">  obj.timer = <span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    a = (target - obj.offsetLeft) / <span class="number">8</span>;</span><br><span class="line">    iSpeed = iSpeed + a;</span><br><span class="line">    iSpeed = iSpeed * u;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Math</span>.abs(iSpeed) &lt;= <span class="number">1</span> &amp;&amp; <span class="built_in">Math</span>.abs(a) &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;over&quot;</span>);</span><br><span class="line">      <span class="built_in">clearInterval</span>(obj.timer);</span><br><span class="line">      obj.style.left = target + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      obj.style.left = obj.offsetLeft + iSpeed + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">30</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="forEach-封装"><a href="#forEach-封装" class="headerlink" title="forEach 封装"></a>forEach 封装</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.myForEach = <span class="function"><span class="keyword">function</span> (<span class="params">func, obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> len = <span class="built_in">this</span>.length;</span><br><span class="line">  <span class="keyword">var</span> _this = <span class="built_in">arguments</span>[<span class="number">1</span>] ? <span class="built_in">arguments</span>[<span class="number">1</span>] : <span class="built_in">window</span>;</span><br><span class="line">  <span class="comment">// var _this=arguments[1]||window;</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    func.call(_this, <span class="built_in">this</span>[i], i, <span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="filter-封装"><a href="#filter-封装" class="headerlink" title="filter 封装"></a>filter 封装</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.myFilter = <span class="function"><span class="keyword">function</span> (<span class="params">func, obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> len = <span class="built_in">this</span>.length;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">var</span> _this = <span class="built_in">arguments</span>[<span class="number">1</span>] || <span class="built_in">window</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    func.call(_this, <span class="built_in">this</span>[i], i, <span class="built_in">this</span>) &amp;&amp; arr.push(<span class="built_in">this</span>[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="map-封装"><a href="#map-封装" class="headerlink" title="map 封装"></a>map 封装</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.myMap = <span class="function"><span class="keyword">function</span> (<span class="params">func</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">var</span> len = <span class="built_in">this</span>.length;</span><br><span class="line">  <span class="keyword">var</span> _this = <span class="built_in">arguments</span>[<span class="number">1</span>] || <span class="built_in">window</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    arr.push(func.call(_this, <span class="built_in">this</span>[i], i, <span class="built_in">this</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="every-封装"><a href="#every-封装" class="headerlink" title="every 封装"></a>every 封装</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.myEvery = <span class="function"><span class="keyword">function</span> (<span class="params">func</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> flag = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">var</span> len = <span class="built_in">this</span>.length;</span><br><span class="line">  <span class="keyword">var</span> _this = <span class="built_in">arguments</span>[<span class="number">1</span>] || <span class="built_in">window</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (func.apply(_this, [<span class="built_in">this</span>[i], i, <span class="built_in">this</span>]) == <span class="literal">false</span>) &#123;</span><br><span class="line">      flag = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> flag;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="reduce-封装"><a href="#reduce-封装" class="headerlink" title="reduce 封装"></a>reduce 封装</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.myReduce = <span class="function"><span class="keyword">function</span> (<span class="params">func, initialValue</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> len = <span class="built_in">this</span>.length,</span><br><span class="line">    nextValue,</span><br><span class="line">    i;</span><br><span class="line">  <span class="keyword">if</span> (!initialValue) &#123;</span><br><span class="line">    <span class="comment">// 没有传第二个参数</span></span><br><span class="line">    nextValue = <span class="built_in">this</span>[<span class="number">0</span>];</span><br><span class="line">    i = <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 传了第二个参数</span></span><br><span class="line">    nextValue = initialValue;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (; i &lt; len; i++) &#123;</span><br><span class="line">    nextValue = func(nextValue, <span class="built_in">this</span>[i], i, <span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> nextValue;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="遍历-DOM-树"><a href="#遍历-DOM-树" class="headerlink" title="遍历 DOM 树"></a>遍历 DOM 树</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给定页面上的DOM元素,将访问元素本身及其所有后代(不仅仅是它的直接子元素)</span></span><br><span class="line"><span class="comment">// 对于每个访问的元素，函数讲元素传递给提供的回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">traverse</span>(<span class="params">element, callback</span>) </span>&#123;</span><br><span class="line">  callback(element);</span><br><span class="line">  <span class="keyword">var</span> list = element.children;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">    traverse(list[i], callback);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="原生封装-ajax"><a href="#原生封装-ajax" class="headerlink" title="原生封装 ajax"></a>原生封装 ajax</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ajax = <span class="function"><span class="keyword">function</span> (<span class="params">conf</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ajax操作</span></span><br><span class="line">  <span class="keyword">let</span> url = conf.url,</span><br><span class="line">    data = conf.data,</span><br><span class="line">    senData = [], <span class="comment">// 封装后的数据</span></span><br><span class="line">    <span class="keyword">async</span> = conf.async !== <span class="literal">undefined</span> ? conf.async : <span class="literal">true</span>, <span class="comment">// ture为异步请求</span></span><br><span class="line">    type = conf.type || <span class="string">&quot;get&quot;</span>, <span class="comment">// 默认请求方式get</span></span><br><span class="line">    dataType = conf.dataType || <span class="string">&quot;json&quot;</span>,</span><br><span class="line">    contenType = conf.contenType || <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    success = conf.success,</span><br><span class="line">    error = conf.error,</span><br><span class="line">    isForm = conf.isForm || <span class="literal">false</span>, <span class="comment">// 是否formdata</span></span><br><span class="line">    header = conf.header || &#123;&#125;, <span class="comment">// 头部信息</span></span><br><span class="line">    xhr = <span class="string">&quot;&quot;</span>; <span class="comment">// 创建ajax引擎对象</span></span><br><span class="line">  <span class="keyword">if</span> (data == <span class="literal">null</span>) &#123;</span><br><span class="line">    senData = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> data === <span class="string">&quot;object&quot;</span> &amp;&amp; !isForm) &#123;</span><br><span class="line">    <span class="comment">// 如果data是对象，转换为字符串</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> data) &#123;</span><br><span class="line">      senData.push(<span class="built_in">encodeURIComponent</span>(k) + <span class="string">&quot;=&quot;</span> + <span class="built_in">encodeURIComponent</span>(data[k]));</span><br><span class="line">    &#125;</span><br><span class="line">    senData = senData.join(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    senData = data;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">&quot;microsoft.xmlhttp&quot;</span>); <span class="comment">// IE内核系列浏览器</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (e1) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      xhr = <span class="keyword">new</span> XMLHttpRequest(); <span class="comment">// 非IE内核浏览器</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (e2) &#123;</span><br><span class="line">      <span class="keyword">if</span> (error != <span class="literal">null</span>) &#123;</span><br><span class="line">        error(<span class="string">&quot;不支持ajax请求&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  xhr.open(type, type !== <span class="string">&quot;get&quot;</span> ? url : url + <span class="string">&quot;?&quot;</span> + senData, <span class="keyword">async</span>);</span><br><span class="line">  <span class="keyword">if</span> (type !== <span class="string">&quot;get&quot;</span> &amp;&amp; !isForm) &#123;</span><br><span class="line">    xhr.setRequestHeader(<span class="string">&quot;content-type&quot;</span>, contenType);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> h <span class="keyword">in</span> header) &#123;</span><br><span class="line">    xhr.setRequestHeader(h, header[h]);</span><br><span class="line">  &#125;</span><br><span class="line">  xhr.send(type !== <span class="string">&quot;get&quot;</span> ? senData : <span class="literal">null</span>);</span><br><span class="line">  xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dataType === <span class="string">&quot;json&quot;</span> &amp;&amp; success != <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="keyword">let</span> res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            res = <span class="built_in">eval</span>(<span class="string">&quot;(&quot;</span> + xhr.responseText + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">          &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(e);</span><br><span class="line">          &#125;</span><br><span class="line">          success(res); <span class="comment">// 将json字符串转换为js对象</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (error != <span class="literal">null</span>) &#123;</span><br><span class="line">          error(<span class="string">&quot;通讯失败!&quot;</span> + xhr.status);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="fetch-封装"><a href="#fetch-封装" class="headerlink" title="fetch 封装"></a>fetch 封装</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fetch = <span class="function"><span class="keyword">function</span> (<span class="params">url, setting</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// fetch请求的封装</span></span><br><span class="line">  <span class="keyword">let</span> opts = &#123;</span><br><span class="line">    <span class="comment">// 设置参数的初始值</span></span><br><span class="line">    method: (setting.method || <span class="string">&quot;GET&quot;</span>).toUpperCase(), <span class="comment">// 请求方式</span></span><br><span class="line">    headers: setting.headers || &#123;&#125;, <span class="comment">// 请求头设置</span></span><br><span class="line">    credentials: setting.credentials || <span class="literal">true</span>, <span class="comment">// 设置cookie是否一起发送</span></span><br><span class="line">    body: setting.body || &#123;&#125;,</span><br><span class="line">    mode: setting.mode || <span class="string">&quot;no-cors&quot;</span>, <span class="comment">// 可以设置 cors, no-cors, same-origin</span></span><br><span class="line">    redirect: setting.redirect || <span class="string">&quot;follow&quot;</span>, <span class="comment">// follow, error, manual</span></span><br><span class="line">    cache: setting.cache || <span class="string">&quot;default&quot;</span>, <span class="comment">// 设置 cache 模式 (default, reload, no-cache)</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> dataType = setting.dataType || <span class="string">&quot;json&quot;</span>; <span class="comment">// 解析方式</span></span><br><span class="line">  <span class="keyword">let</span> data = setting.data || <span class="string">&quot;&quot;</span>; <span class="comment">// 参数</span></span><br><span class="line">  <span class="keyword">let</span> paramsFormat = <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 参数格式</span></span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">      str += <span class="string">`<span class="subst">$&#123;i&#125;</span>=<span class="subst">$&#123;obj[i]&#125;</span>&amp;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str.split(<span class="string">&quot;&quot;</span>).slice(<span class="number">0</span>, -<span class="number">1</span>).join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (opts.method === <span class="string">&quot;GET&quot;</span>) &#123;</span><br><span class="line">    url = url + (data ? <span class="string">`?<span class="subst">$&#123;paramsFormat(data)&#125;</span>`</span> : <span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    setting.body = data || &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    fetch(url, opts)</span><br><span class="line">      .then(<span class="keyword">async</span> (res) =&gt; &#123;</span><br><span class="line">        <span class="keyword">let</span> data =</span><br><span class="line">          dataType === <span class="string">&quot;text&quot;</span></span><br><span class="line">            ? <span class="keyword">await</span> res.text()</span><br><span class="line">            : dataType === <span class="string">&quot;blob&quot;</span></span><br><span class="line">            ? <span class="keyword">await</span> res.blob()</span><br><span class="line">            : <span class="keyword">await</span> res.json();</span><br><span class="line">        resolve(data);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        reject(e);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="异步加载-script"><a href="#异步加载-script" class="headerlink" title="异步加载 script"></a>异步加载 script</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadScript</span>(<span class="params">url, callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> oscript = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (oscript.readyState) &#123;</span><br><span class="line">    <span class="comment">// ie8及以下版本</span></span><br><span class="line">    oscript.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        oscript.readyState === <span class="string">&quot;complete&quot;</span> ||</span><br><span class="line">        oscript.readyState === <span class="string">&quot;loaded&quot;</span></span><br><span class="line">      ) &#123;</span><br><span class="line">        callback();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    oscript.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      callback();</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  oscript.src = url;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(oscript);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="Cookie-管理"><a href="#Cookie-管理" class="headerlink" title="Cookie 管理"></a>Cookie 管理</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cookie = &#123;</span><br><span class="line">  set: <span class="function"><span class="keyword">function</span> (<span class="params">name, value, time</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.cookie = name + <span class="string">&quot;=&quot;</span> + value + <span class="string">&quot;; max-age=&quot;</span> + time;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  remove: <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.setCookie(name, <span class="string">&quot;&quot;</span>, -<span class="number">1</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  get: <span class="function"><span class="keyword">function</span> (<span class="params">name, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> allCookieArr = <span class="built_in">document</span>.cookie.split(<span class="string">&quot;; &quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; allCookieArr.length; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> itemCookieArr = allCookieArr[i].split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (itemCookieArr[<span class="number">0</span>] === name) &#123;</span><br><span class="line">        <span class="keyword">return</span> itemCookieArr[<span class="number">1</span>];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="bind-实现"><a href="#bind-实现" class="headerlink" title="bind() 实现"></a>bind() 实现</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myBind = <span class="function"><span class="keyword">function</span> (<span class="params">target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> target = target || <span class="built_in">window</span>;</span><br><span class="line">  <span class="keyword">var</span> _args1 = [].slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">var</span> self = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">var</span> temp = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _args2 = [].slice.call(<span class="built_in">arguments</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">var</span> parasArr = _args1.concat(_args2);</span><br><span class="line">    <span class="keyword">return</span> self.apply(<span class="built_in">this</span> <span class="keyword">instanceof</span> temp ? <span class="built_in">this</span> : target, parasArr);</span><br><span class="line">  &#125;;</span><br><span class="line">  temp.prototype = self.prototype;</span><br><span class="line">  F.prototype = <span class="keyword">new</span> temp();</span><br><span class="line">  <span class="keyword">return</span> F;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="call-实现"><a href="#call-实现" class="headerlink" title="call() 实现"></a>call() 实现</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myCall = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> ctx = <span class="built_in">arguments</span>[<span class="number">0</span>] || <span class="built_in">window</span>;</span><br><span class="line">  ctx.fn = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">var</span> args = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">    args.push(<span class="built_in">arguments</span>[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> result = ctx.fn(...args);</span><br><span class="line">  <span class="keyword">delete</span> ctx.fn;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="apply-实现"><a href="#apply-实现" class="headerlink" title="apply() 实现"></a>apply() 实现</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myApply = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> ctx = <span class="built_in">arguments</span>[<span class="number">0</span>] || <span class="built_in">window</span>;</span><br><span class="line">  ctx.fn = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">arguments</span>[<span class="number">1</span>]) &#123;</span><br><span class="line">    <span class="keyword">var</span> result = ctx.fn();</span><br><span class="line">    <span class="keyword">delete</span> ctx.fn;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> result = ctx.fn(...arguments[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">delete</span> ctx.fn;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 防抖函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> <span class="variable">func</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> <span class="variable">wait</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait = <span class="number">500</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timeout; <span class="comment">// 定时器变量</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timeout); <span class="comment">// 每次触发时先清除上一次的定时器,然后重新计时</span></span><br><span class="line">    event.persist &amp;&amp; event.persist(); <span class="comment">//保留对事件的引用</span></span><br><span class="line">    timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      func(event);</span><br><span class="line">    &#125;, wait); <span class="comment">// 指定 xx ms 后触发真正想进行的操作 handler</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">============</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> debounce = <span class="function"><span class="keyword">function</span>(<span class="params">func, wait, immediate</span>) </span>&#123; <span class="comment">//函数防抖[func 函数,wait 延迟执行毫秒数,immediate true 表立即执行,false 表非立即执行,立即执行是触发事件后函数会立即执行，然后n秒内不触发事件才能继续执行函数的效果]</span></span><br><span class="line">  <span class="keyword">let</span> timeout;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> context = <span class="built_in">this</span>;</span><br><span class="line">    <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">if</span> (timeout) <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">    <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">      <span class="keyword">var</span> callNow = !timeout;</span><br><span class="line">      timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        timeout = <span class="literal">null</span>;</span><br><span class="line">      &#125;, wait)</span><br><span class="line">      <span class="keyword">if</span> (callNow) func.apply(context, args)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      timeout = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        func.apply(context, args)</span><br><span class="line">      &#125;, wait);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 节流函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> <span class="variable">func</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> <span class="variable">interval</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, interval = <span class="number">100</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timeout;</span><br><span class="line">  <span class="keyword">let</span> startTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    event.persist &amp;&amp; event.persist(); <span class="comment">//保留对事件的引用</span></span><br><span class="line">    <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">    <span class="keyword">let</span> curTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">if</span> (curTime - startTime &lt;= interval) &#123;</span><br><span class="line">      <span class="comment">//小于规定时间间隔时，用setTimeout在指定时间后再执行</span></span><br><span class="line">      timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        func(event);</span><br><span class="line">      &#125;, interval);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//重新计时并执行函数</span></span><br><span class="line">      startTime = curTime;</span><br><span class="line">      func(event);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">=========</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> throttle = <span class="function"><span class="keyword">function</span>(<span class="params">func, wait ,type</span>) </span>&#123; <span class="comment">//函数节流 [func 函数 wait 延迟执行毫秒数 type 1 表时间戳版，2 表定时器版]</span></span><br><span class="line">    <span class="keyword">if</span>(type===<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> previous = <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type===<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> timeout;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="built_in">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">        <span class="keyword">if</span>(type===<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">let</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">            <span class="keyword">if</span> (now - previous &gt; wait) &#123;</span><br><span class="line">                func.apply(context, args);</span><br><span class="line">                previous = now;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type===<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!timeout) &#123;</span><br><span class="line">                timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    timeout = <span class="literal">null</span>;</span><br><span class="line">                    func.apply(context, args)</span><br><span class="line">                &#125;, wait)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="函数柯里化"><a href="#函数柯里化" class="headerlink" title="函数柯里化"></a>函数柯里化</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//是把接受多个参数的函数变换成接受一个单一参数(最初函数的第一个参数)的函数，并且返回接受余下的参数且返回结果的新函数的技术</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curryIt</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> length = fn.length,</span><br><span class="line">    args = [];</span><br><span class="line">  <span class="keyword">var</span> result = <span class="function"><span class="keyword">function</span> (<span class="params">arg</span>) </span>&#123;</span><br><span class="line">    args.push(arg);</span><br><span class="line">    length--;</span><br><span class="line">    <span class="keyword">if</span> (length &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> fn.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="html-过滤代码"><a href="#html-过滤代码" class="headerlink" title="html 过滤代码"></a>html 过滤代码</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filterTag = <span class="function"><span class="keyword">function</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 过滤html代码(把&lt;&gt;转换)</span></span><br><span class="line">  str = str.replace(<span class="regexp">/&amp;/gi</span>, <span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">  str = str.replace(<span class="regexp">/&lt;/gi</span>, <span class="string">&quot;&lt;&quot;</span>);</span><br><span class="line">  str = str.replace(<span class="regexp">/&gt;/gi</span>, <span class="string">&quot;&gt;&quot;</span>);</span><br><span class="line">  str = str.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="常用正则验证"><a href="#常用正则验证" class="headerlink" title="常用正则验证"></a>常用正则验证</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> checkStr = <span class="function"><span class="keyword">function</span> (<span class="params">str, type</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 常用正则验证，注意type大小写</span></span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;phone&quot;</span>: <span class="comment">// 手机号码</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^1[3|4|5|6|7|8|9][0-9]&#123;9&#125;$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;tel&quot;</span>: <span class="comment">// 座机</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^(0\d&#123;2,3&#125;-\d&#123;7,8&#125;)(-\d&#123;1,4&#125;)?$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;card&quot;</span>: <span class="comment">// 身份证</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/(^\d&#123;15&#125;$)|(^\d&#123;18&#125;$)|(^\d&#123;17&#125;(\d|X|x)$)/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;pwd&quot;</span>: <span class="comment">// 密码以字母开头，长度在6~18之间，只能包含字母、数字和下划线</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^[a-zA-Z]\w&#123;5,17&#125;$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;postal&quot;</span>: <span class="comment">// 邮政编码</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/[1-9]\d&#123;5&#125;(?!\d)/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;QQ&quot;</span>: <span class="comment">// QQ号</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^[1-9][0-9]&#123;4,9&#125;$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;email&quot;</span>: <span class="comment">// 邮箱</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;money&quot;</span>: <span class="comment">// 金额(小数点2位)</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^\d*(?:\.\d&#123;0,2&#125;)?$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;URL&quot;</span>: <span class="comment">// 网址</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/</span>.test(</span><br><span class="line">        str</span><br><span class="line">      );</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;IP&quot;</span>: <span class="comment">// IP</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.)&#123;3&#125;(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))/</span>.test(</span><br><span class="line">        str</span><br><span class="line">      );</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;date&quot;</span>: <span class="comment">// 日期时间</span></span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        /^(\d&#123;<span class="number">4</span>&#125;)\-(\d&#123;<span class="number">2</span>&#125;)\-(\d&#123;<span class="number">2</span>&#125;) (\d&#123;<span class="number">2</span>&#125;)(?:\:\d&#123;<span class="number">2</span>&#125;|:(\d&#123;<span class="number">2</span>&#125;):(\d&#123;<span class="number">2</span>&#125;))$/.test(</span><br><span class="line">          str</span><br><span class="line">        ) || <span class="regexp">/^(\d&#123;4&#125;)\-(\d&#123;2&#125;)\-(\d&#123;2&#125;)$/</span>.test(str)</span><br><span class="line">      );</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;number&quot;</span>: <span class="comment">// 数字</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^[0-9]$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;english&quot;</span>: <span class="comment">// 英文</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^[a-zA-Z]+$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;chinese&quot;</span>: <span class="comment">// 中文</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^[\u4E00-\u9FA5]+$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;lower&quot;</span>: <span class="comment">// 小写</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^[a-z]+$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;upper&quot;</span>: <span class="comment">// 大写</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/^[A-Z]+$/</span>.test(str);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;HTML&quot;</span>: <span class="comment">// HTML标记</span></span><br><span class="line">      <span class="keyword">return</span> <span class="regexp">/&lt;(&quot;[^&quot;]*&quot;|&#x27;[^&#x27;]*&#x27;|[^&#x27;&quot;&gt;])*&gt;/</span>.test(str);</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="文本复制功能"><a href="#文本复制功能" class="headerlink" title="文本复制功能"></a>文本复制功能</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> copyTxt = <span class="function"><span class="keyword">function</span> (<span class="params">text, fn</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 复制功能</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">document</span>.execCommand !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;复制失败，请长按复制&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> dom = <span class="built_in">document</span>.createElement(<span class="string">&quot;textarea&quot;</span>);</span><br><span class="line">  dom.value = text;</span><br><span class="line">  dom.setAttribute(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;display: block;width: 1px;height: 1px;&quot;</span>);</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(dom);</span><br><span class="line">  dom.select();</span><br><span class="line">  <span class="keyword">var</span> result = <span class="built_in">document</span>.execCommand(<span class="string">&quot;copy&quot;</span>);</span><br><span class="line">  <span class="built_in">document</span>.body.removeChild(dom);</span><br><span class="line">  <span class="keyword">if</span> (result) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;复制成功&quot;</span>);</span><br><span class="line">    <span class="keyword">typeof</span> fn === <span class="string">&quot;function&quot;</span> &amp;&amp; fn();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">document</span>.createRange !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;复制失败，请长按复制&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> range = <span class="built_in">document</span>.createRange();</span><br><span class="line">  <span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">  div.innerhtml = text;</span><br><span class="line">  div.setAttribute(<span class="string">&quot;style&quot;</span>, <span class="string">&quot;height: 1px;fontSize: 1px;overflow: hidden;&quot;</span>);</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(div);</span><br><span class="line">  range.selectNode(div);</span><br><span class="line">  <span class="keyword">var</span> selection = <span class="built_in">window</span>.getSelection();</span><br><span class="line">  <span class="built_in">console</span>.log(selection);</span><br><span class="line">  <span class="keyword">if</span> (selection.rangeCount &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    selection.removeAllRanges();</span><br><span class="line">  &#125;</span><br><span class="line">  selection.addRange(range);</span><br><span class="line">  <span class="built_in">document</span>.execCommand(<span class="string">&quot;copy&quot;</span>);</span><br><span class="line">  <span class="keyword">typeof</span> fn === <span class="string">&quot;function&quot;</span> &amp;&amp; fn();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;复制成功&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="对象序列化"><a href="#对象序列化" class="headerlink" title="对象序列化"></a>对象序列化</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> stringfyQueryString = <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//对象序列化【对象转url参数】</span></span><br><span class="line">  <span class="keyword">if</span> (!obj) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">let</span> pairs = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">let</span> value = obj[key];</span><br><span class="line">    <span class="keyword">if</span> (value <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; value.length; ++i) &#123;</span><br><span class="line">        pairs.push(</span><br><span class="line">          <span class="built_in">encodeURIComponent</span>(key + <span class="string">&quot;[&quot;</span> + i + <span class="string">&quot;]&quot;</span>) +</span><br><span class="line">            <span class="string">&quot;=&quot;</span> +</span><br><span class="line">            <span class="built_in">encodeURIComponent</span>(value[i])</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pairs.push(<span class="built_in">encodeURIComponent</span>(key) + <span class="string">&quot;=&quot;</span> + <span class="built_in">encodeURIComponent</span>(obj[key]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> pairs.join(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="图片地址转-base64"><a href="#图片地址转-base64" class="headerlink" title="图片地址转 base64"></a>图片地址转 base64</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getBase64 = <span class="function"><span class="keyword">function</span> (<span class="params">img</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//传入图片路径，返回base64，使用getBase64(url).then(function(base64)&#123;&#125;,function(err)&#123;&#125;);</span></span><br><span class="line">  <span class="keyword">let</span> getBase64Image = <span class="function"><span class="keyword">function</span> (<span class="params">img, width, height</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//width、height调用时传入具体像素值，控制大小,不传则默认图像大小</span></span><br><span class="line">    <span class="keyword">let</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line">    canvas.width = width ? width : img.width;</span><br><span class="line">    canvas.height = height ? height : img.height;</span><br><span class="line">    <span class="keyword">let</span> ctx = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">    ctx.drawImage(img, <span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);</span><br><span class="line">    <span class="keyword">let</span> dataURL = canvas.toDataURL();</span><br><span class="line">    <span class="keyword">return</span> dataURL;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> image = <span class="keyword">new</span> Image();</span><br><span class="line">  image.crossOrigin = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  image.src = img;</span><br><span class="line">  <span class="keyword">let</span> deferred = $.Deferred();</span><br><span class="line">  <span class="keyword">if</span> (img) &#123;</span><br><span class="line">    image.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      deferred.resolve(getBase64Image(image));</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> deferred.promise();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="base64-图片下载"><a href="#base64-图片下载" class="headerlink" title="base64 图片下载"></a>base64 图片下载</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> downloadFile = <span class="function"><span class="keyword">function</span> (<span class="params">base64, fileName</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//base64图片下载功能</span></span><br><span class="line">  <span class="keyword">let</span> base64ToBlob = <span class="function"><span class="keyword">function</span> (<span class="params">code</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> parts = code.split(<span class="string">&quot;;base64,&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> contentType = parts[<span class="number">0</span>].split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">let</span> raw = <span class="built_in">window</span>.atob(parts[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">let</span> rawLength = raw.length;</span><br><span class="line">    <span class="keyword">let</span> uInt8Array = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(rawLength);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; rawLength; ++i) &#123;</span><br><span class="line">      uInt8Array[i] = raw.charCodeAt(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Blob([uInt8Array], &#123;</span><br><span class="line">      type: contentType,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> aLink = <span class="built_in">document</span>.createElement(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> blob = base64ToBlob(base64); <span class="comment">//new Blob([content]);</span></span><br><span class="line">  <span class="keyword">let</span> evt = <span class="built_in">document</span>.createEvent(<span class="string">&quot;HTMLEvents&quot;</span>);</span><br><span class="line">  evt.initEvent(<span class="string">&quot;click&quot;</span>, <span class="literal">true</span>, <span class="literal">true</span>); <span class="comment">//initEvent不加后两个参数在FF下会报错  事件类型，是否冒泡，是否阻止浏览器的默认行为</span></span><br><span class="line">  aLink.download = fileName;</span><br><span class="line">  aLink.href = URL.createObjectURL(blob);</span><br><span class="line">  aLink.click();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="判断图片加载完成"><a href="#判断图片加载完成" class="headerlink" title="判断图片加载完成"></a>判断图片加载完成</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> imgLoadAll = <span class="function"><span class="keyword">function</span> (<span class="params">arr, callback</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 图片加载</span></span><br><span class="line">  <span class="keyword">let</span> arrImg = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">    img.src = arr[i];</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      arrImg.push(<span class="built_in">this</span>);</span><br><span class="line">      <span class="keyword">if</span> (arrImg.length == arr.length) &#123;</span><br><span class="line">        callback &amp;&amp; callback();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="小数位限制"><a href="#小数位限制" class="headerlink" title="小数位限制"></a>小数位限制</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc </span>小数位限制，四舍五入，不足不补位，末数为无意义0时去掉</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Number&#125;</span> <span class="variable">value</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Number&#125;</span> <span class="variable">length</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Number&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">parseFloatToFixed</span>(<span class="params">value, length</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> val = <span class="built_in">Number</span>.isNaN(<span class="built_in">Number</span>(value)) ? <span class="number">0</span> : value;</span><br><span class="line">  <span class="keyword">const</span> num = <span class="number">10</span> ** length;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.round(val * num) / num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="非空判断"><a href="#非空判断" class="headerlink" title="非空判断"></a>非空判断</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 非空判断，空对象 &#123;&#125; 、空数组 [] 都为false</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> <span class="variable">data</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;boolean&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isEmpty</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (data <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> !data.length;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (data <span class="keyword">instanceof</span> <span class="built_in">Object</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="built_in">Object</span>.keys(data).length;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> data === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> !data.trim();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> !data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="将枚举类型转换为数组格式"><a href="#将枚举类型转换为数组格式" class="headerlink" title="将枚举类型转换为数组格式"></a>将枚举类型转换为数组格式</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description </span>将枚举类型转换为数组格式</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;object&#125;</span> <span class="variable">data</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> <span class="variable">callback</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;boolean&#125;</span> </span>hasAll 是否添加所有</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;array&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">formatEnumToArray</span>(<span class="params">data, hasAll, callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (isEmpty(data)) <span class="keyword">return</span> [];</span><br><span class="line">  <span class="keyword">const</span> options = <span class="built_in">Object</span>.keys(data).map(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (callback &amp;&amp; <span class="keyword">typeof</span> callback === <span class="string">&#x27;function&#x27;</span>) <span class="keyword">return</span> callback(key, data[key]);</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">value</span>: key, <span class="attr">name</span>: data[key] &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">if</span> (hasAll) <span class="keyword">return</span> [...formatEnumToArray(allLabel, <span class="literal">false</span>, callback), ...options];</span><br><span class="line">  <span class="keyword">return</span> options;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="处理接口返回的response"><a href="#处理接口返回的response" class="headerlink" title="处理接口返回的response"></a>处理接口返回的response</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description </span>处理接口返回的response</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;object&#125;</span> <span class="variable">res</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;Promise&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkResponse</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; success, data, message &#125; = res;</span><br><span class="line">    <span class="keyword">if</span> (success) &#123;</span><br><span class="line">      resolve(data);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      reject();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="判断一个值得数据类型"><a href="#判断一个值得数据类型" class="headerlink" title="判断一个值得数据类型"></a>判断一个值得数据类型</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc </span>判断一个值得数据类型</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">type</span>(<span class="params">param</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(param).slice(<span class="number">8</span>, -<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="判断文件类型"><a href="#判断文件类型" class="headerlink" title="判断文件类型"></a>判断文件类型</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: 判断文件类型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span>  <span class="variable">filePath</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;*&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">judgeFileType</span>(<span class="params">filePath</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 获取最后一个.的位置</span></span><br><span class="line">  <span class="keyword">const</span> index = filePath.lastIndexOf(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  <span class="comment">// 获取后缀</span></span><br><span class="line">  <span class="keyword">const</span> ext = filePath.substr(index + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断是否是图片类型</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    [<span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>, <span class="string">&#x27;bmp&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;webp&#x27;</span>, <span class="string">&#x27;psd&#x27;</span>, <span class="string">&#x27;svg&#x27;</span>, <span class="string">&#x27;tiff&#x27;</span>].indexOf(</span><br><span class="line">      ext.toLowerCase(),</span><br><span class="line">    ) !== -<span class="number">1</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;image&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断是否是视频类型</span></span><br><span class="line">  <span class="keyword">if</span> ([<span class="string">&#x27;mp4&#x27;</span>, <span class="string">&#x27;avi&#x27;</span>, <span class="string">&#x27;mov&#x27;</span>, <span class="string">&#x27;rmvb&#x27;</span>, <span class="string">&#x27;rm&#x27;</span>, <span class="string">&#x27;flv&#x27;</span>, <span class="string">&#x27;3gp&#x27;</span>].indexOf(ext.toLowerCase()) !== -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;video&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断是否是音频类型</span></span><br><span class="line">  <span class="keyword">if</span> ([<span class="string">&#x27;cda&#x27;</span>, <span class="string">&#x27;wav&#x27;</span>, <span class="string">&#x27;mp3&#x27;</span>, <span class="string">&#x27;wmv&#x27;</span>, <span class="string">&#x27;flac&#x27;</span>, <span class="string">&#x27;aac&#x27;</span>].indexOf(ext.toLowerCase()) !== -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;audio&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;otherType&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>更多…：<a href="https://mp.weixin.qq.com/s/TheqYyIgi0MjmoYy7Ak6Vg">https://mp.weixin.qq.com/s/TheqYyIgi0MjmoYy7Ak6Vg</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> utils </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown基本语法</title>
      <link href="ag8qtu/"/>
      <url>ag8qtu/</url>
      
        <content type="html"><![CDATA[<h1 id="一级标题"><a href="#一级标题" class="headerlink" title="一级标题"></a>一级标题</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 一级标题</span><br></pre></td></tr></table></figure><h2 id="二级标题"><a href="#二级标题" class="headerlink" title="二级标题"></a>二级标题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## 二级标题</span><br></pre></td></tr></table></figure><h3 id="三级标题"><a href="#三级标题" class="headerlink" title="三级标题"></a>三级标题</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">### 三级标题</span><br></pre></td></tr></table></figure><h4 id="四级标题"><a href="#四级标题" class="headerlink" title="四级标题"></a>四级标题</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#### 四级标题</span><br></pre></td></tr></table></figure><h5 id="五级标题"><a href="#五级标题" class="headerlink" title="五级标题"></a>五级标题</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">##### 五级标题</span><br></pre></td></tr></table></figure><h6 id="六级标题"><a href="#六级标题" class="headerlink" title="六级标题"></a>六级标题</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">###### 六级标题</span><br></pre></td></tr></table></figure><h1 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h1><p><em>斜体</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*这段文字斜体显示*</span><br></pre></td></tr></table></figure><p><strong>加粗</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**文字加粗**</span><br></pre></td></tr></table></figure><p><strong><em>斜体加粗</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">***斜体加粗***</span><br></pre></td></tr></table></figure><p><del>删除线</del></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~~删除线~~</span><br></pre></td></tr></table></figure><blockquote><p>引用</p></blockquote><blockquote><p>嵌套引用</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;引用</span><br><span class="line"></span><br><span class="line">&gt;&gt;嵌套引用</span><br></pre></td></tr></table></figure><h1 id="—-分割线—–"><a href="#—-分割线—–" class="headerlink" title="—-分割线—–"></a>—-分割线—–</h1><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">分割线</span><br><span class="line">****或----</span><br></pre></td></tr></table></figure><h1 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h1><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fa.36krcnd.com%2Fphoto%2Ffd2a069db6129124413d83fce249be42.jpeg%21heading&refer=http%3A%2F%2Fa.36krcnd.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1620438409&t=bcff7f4154d223d6b8afa66fdd9a0445#id=W0nhc&originalType=binary&ratio=1&status=done&style=none"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![image](https:&#x2F;&#x2F;gimg2.baidu.com&#x2F;image_search&#x2F;src&#x3D;http%3A%2F%2Fa.36krcnd.com%2Fphoto%2Ffd2a069db6129124413d83fce249be42.jpeg%21heading&amp;refer&#x3D;http%3A%2F%2Fa.36krcnd.com&amp;app&#x3D;2002&amp;size&#x3D;f9999,10000&amp;q&#x3D;a80&amp;n&#x3D;0&amp;g&#x3D;0n&amp;fmt&#x3D;jpeg?sec&#x3D;1620438409&amp;t&#x3D;bcff7f4154d223d6b8afa66fdd9a0445 &quot;Markdown&quot;)</span><br></pre></td></tr></table></figure><h1 id="超链接"><a href="#超链接" class="headerlink" title="超链接"></a>超链接</h1><p><a href="https://www.baidu.com/">百度</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[百度](https:&#x2F;&#x2F;www.baidu.com&#x2F;)</span><br></pre></td></tr></table></figure><hr><h1 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h1><ul><li><p>无序列表</p></li><li><p>无序列表</p></li><li><p>无序列表</p></li></ul><ol><li>有序列表 1</li><li>有序列表 2</li><li>有序列表 3</li></ol><ul><li><p>列表 1 1.嵌套列表 1 2.嵌套列表 2 3.嵌套列表 3</p></li><li><p>列表 2</p><ul><li>嵌套 1</li><li>嵌套 2</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* 无序列表</span><br><span class="line">- 无序列表</span><br><span class="line">+ 无序列表</span><br><span class="line"></span><br><span class="line">1. 有序列表1</span><br><span class="line">2. 有序列表2</span><br><span class="line">3. 有序列表3</span><br><span class="line"></span><br><span class="line">* 列表1</span><br><span class="line">   1.嵌套列表1</span><br><span class="line">   2.嵌套列表2</span><br><span class="line">   3.嵌套列表3</span><br><span class="line">- 列表2</span><br><span class="line">   * 嵌套1</span><br><span class="line">   * 嵌套2</span><br></pre></td></tr></table></figure><hr><h1 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h1><table><thead><tr><th>姓名</th><th>年龄</th><th>职业</th></tr></thead><tbody><tr><td>张三</td><td>22</td><td>搬砖工</td></tr><tr><td>李四</td><td>33</td><td>厨师</td></tr><tr><td>王五</td><td>18</td><td>学生</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">姓名|年龄|职业</span><br><span class="line">--|:--:|--:</span><br><span class="line">张三|22|搬砖工</span><br><span class="line">李四|33|厨师</span><br><span class="line">王五|18|学生</span><br></pre></td></tr></table></figure><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">name</span>:<span class="string">&quot;张三&quot;</span>&#125;</span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;aaaaaaaaaaa&#x27;</span></span><br><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line">&lt;h1&gt;markdown&lt;/h1&gt;</span><br><span class="line">&lt;span&gt;aaaaa&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>单行代码<br><code>var arr = [1,2,3,4,5]</code></p>]]></content>
      
      
      <categories>
          
          <category> Markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决 element 表格数据量过大导致页面渲染缓慢、卡顿问题</title>
      <link href="np4k2h/"/>
      <url>np4k2h/</url>
      
        <content type="html"><![CDATA[<p><strong>在 B/S 架构中，经常会遇到大数据渲染问题，毕竟 javascript 是单线程。</strong></p><p>在使用 table 时，用户需要在上面做大量操作时，就需要考虑页面的渲染问题了。</p><p><strong><em>导致卡顿原因：</em></strong><br><strong>数据量过多导致浏览器一次性渲染过多的 DOM，导致 DOM 树占用内存溢出，使得用户操作阻塞。</strong><br><strong>具体原因查看文章：</strong><a href="https://www.cnblogs.com/hyddd/archive/2013/02/07/2908960.html"><strong>DOM 性能瓶颈与 Javascript 性能优化</strong></a></p><p>这里给提供两种表格插件：</p><h2 id="Vxe-table（基于-vue-的-pc-端表格插件）"><a href="#Vxe-table（基于-vue-的-pc-端表格插件）" class="headerlink" title="Vxe-table（基于 vue 的 pc 端表格插件）"></a>Vxe-table（基于 vue 的 pc 端表格插件）</h2><ul><li>优势：<ul><li>可以自定义选择要引入的模块，有效减少项目体积</li><li>表格种类多</li><li>vue 扩展库</li></ul></li></ul><p><strong><em>1.安装</em></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm insatall xe-utils vxe-table</span><br></pre></td></tr></table></figure><p><strong><em>2.在 main.js 中引入 vxe-table</em></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&quot;./App.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;xe-utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> VXETable <span class="keyword">from</span> <span class="string">&#x27;vxe-table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;vxe-table/lib/index.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line">Vue.use(VXETable);</span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).$mount(<span class="string">&quot;#app&quot;</span>);<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p><a href="https://xuliangzhan_admin.gitee.io/vxe-table/#/table/api"><em>Vxe-table API 文档地址：</em> https://xuliangzhan_admin.gitee.io/vxe-table/#/table/api</a><br><a href="https://xuliangzhan_admin.gitee.io/vxe-table/#/table/scroll/scroll"><em>Vxe-table 演示：</em> https://xuliangzhan_admin.gitee.io/vxe-table/#/table/scroll/scroll</a></p><hr><h2 id="pl-table-一个轻量级表格插件"><a href="#pl-table-一个轻量级表格插件" class="headerlink" title="pl-table(一个轻量级表格插件)"></a>pl-table(一个轻量级表格插件)</h2><p><strong><em>1.安装</em></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pl-table --save</span><br></pre></td></tr></table></figure><p><strong><em>2.在 main.js 中引入 pl-table</em></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plTable <span class="keyword">from</span> <span class="string">&quot;pl-table&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;pl-table/themes/index.css&quot;</span>; <span class="comment">// 引入样式（必须引入)，vuecli3.0不需要配置，cli2.0请查看webpack是否配置了url-loader对woff，ttf文件的引用,不配置会报错哦</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;pl-table/themes/plTableStyle.css&quot;</span>; <span class="comment">// 默认表格样式很丑 引入这个样式就可以好看啦（如果你不喜欢这个样式，就不要引入，不引入就跟ele表格样式一样）</span></span><br><span class="line"></span><br><span class="line">Vue.use(plTable);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">  render: <span class="function">(<span class="params">h</span>) =&gt;</span> h(App),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意：如果你不想在入口文件注入, 而是想在单个某个文件页面引入，你可以这样写哦</span></span><br><span class="line"><span class="keyword">import</span> &#123; PlTable, PlTableColumn, PlxTableGrid, PlxTableColumn &#125; <span class="keyword">from</span> <span class="string">&quot;pl-table&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    PlTable,</span><br><span class="line">    PlTableColumn,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;pl-table</span><br><span class="line">     ref=&quot;table&quot;</span><br><span class="line">     stripe</span><br><span class="line">     use-virtual</span><br><span class="line">     v-loading=&quot;loading&quot;</span><br><span class="line">     :data=&quot;tableData&quot;</span><br><span class="line">     highlight-current-row</span><br><span class="line">     height=&quot;500&quot;</span><br><span class="line">     style=&quot;width: 100%&quot;&gt;</span><br><span class="line">  &lt;pl-table-column</span><br><span class="line">         prop=&quot;number&quot;</span><br><span class="line">         width=&quot;90&quot;</span><br><span class="line">         label=&quot;编号&quot;&gt;</span><br><span class="line">     <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">       &#123;&#123;scope.row.number&#125;&#125;</span><br><span class="line">     <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">pl-table-column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">pl-table</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>pl-table 主要通过开启 use-virtual 属性来解决表格卡顿问题</strong></p><p><a href="https://github.com/livelyPeng/pl-table"><em>pl-table GitHub:</em>  https://github.com/livelyPeng/pl-table</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Table </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端路由实现</title>
      <link href="bhkocy/"/>
      <url>bhkocy/</url>
      
        <content type="html"><![CDATA[<h2 id="路由概念"><a href="#路由概念" class="headerlink" title="路由概念"></a>路由概念</h2><p>路由的本质其实就是一种对应关系，比如说我们在浏览器地址栏输入 URL 地址后，浏览器就会请求对应的 URL 地址的资源；URL 地址和真实的资源之间就会形成一种对应的关系，就是路由。<br><strong>路由主要分为前端路由和后端路由。</strong><br>后端路由又称为服务端路由，**<em>服务端中路由描述的是 URL 与处理函数之间的映射关系</em>**</p><p>前端路由主要应用于 SPA 单页面应用架构，SPA 页面只有一个主页面，也就是挂载点，所有的页面内容都依赖于挂载点上，通过动态替换 DOM 内容和同步去修改 URL 地址来实现多页面的效果；<br><strong><em>前端路由描述的是 URL 和 UI 之间的映射关系，这种映射是单向的，通过 URL 的改变引起 UI 的更新，而且无需刷新页面。</em></strong></p><hr><h2 id="前端路由的实现"><a href="#前端路由的实现" class="headerlink" title="前端路由的实现"></a>前端路由的实现</h2><p>要实现前端路由，必须解决两个核心问题：</p><ul><li>如何改变 URL 却不引起页面刷新？</li><li>如何检测 URL 的变化？</li></ul><p><strong><em>hash 实现</em></strong></p><ul><li>hash 是 URL 中 hash(#)及后面的那部分，常用作锚点在页面内进行导航，改变 URL 中的 hash 部分不会引起页面刷新</li><li>通过 hashchange 事件监听 URL 的变化，改变 URL 的方式只有这几种：通过浏览器前进后退改变 URL、通过 a 标签改变 URL、通过 window.location 改变 URL，这几种情况改变 URL 都会触发 hashchange 事件</li></ul><p><strong><em>history 实现</em></strong></p><ul><li>history 提供了<strong>pushState 和 replaceState</strong>两个方法，这两个方法改变 URL 的 path 部分不会引起页面刷新</li><li>history 提供类似 hashchange 事件的 popstate 事件，但 popstate 事件有些不同：通过浏览器前进后退改变 URL 时会触发 popstate 事件，通过 pushState/replaceState 或 a 标签改变 URL 不会触发 popstate 事件。好在我们可以拦截 pushState/replaceState 的调用和 a 标签的点击事件来检测 URL 变化，所以监听 URL 变化可以实现，只是没有 hashchange 那么方便</li></ul><p><strong>hash 和 history API 对比</strong></p><table><thead><tr><th>对比项</th><th>hash</th><th>history</th></tr></thead><tbody><tr><td>url</td><td>不美观（#）</td><td>正常</td></tr><tr><td>命名限制</td><td>通常只能在同一个 document 下进行改变</td><td>url 地址可以自己来定义，只要是同一个域名下都可以，自由度更大</td></tr><tr><td>url 地址变更</td><td>会改变</td><td>可以改变，也可以不变</td></tr><tr><td>状态保存</td><td>无内置方法，需要另行保存页面的状态信息</td><td>将页面信息压入历史栈时可以附带自定义的信息</td></tr><tr><td>参数传递能力</td><td>受到 url 总长度的限制</td><td>将页面信息压入历史栈时可以附带自定义的信息</td></tr><tr><td>实用性</td><td>可直接使用</td><td>通常服务端需要修改代码以配合实现</td></tr><tr><td>兼容性</td><td>IE8 以上</td><td>IE10 以上</td></tr></tbody></table><hr><h2 id="原生实现前端路由"><a href="#原生实现前端路由" class="headerlink" title="原生实现前端路由"></a>原生实现前端路由</h2><ul><li><p>hash:</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/hash.png"></p><p>html:</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--路由--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/home&quot;</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/about&quot;</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--路由跳转渲染的view--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>javascript:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当初始的 HTML 文档被完全加载和解析完成之后，DOMContentLoaded 事件被触发，而无需等待样式表、图像和子框架的完成加载</span></span><br><span class="line"><span class="comment">// 主动触发一次hashchange事件</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&quot;DOMContentLoaded&quot;</span>, onLoad);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听路由变化</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&quot;hashchange&quot;</span>, onHashChange);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 路由view</span></span><br><span class="line"><span class="keyword">var</span> routerView = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onLoad</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  routerView = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#view&quot;</span>);</span><br><span class="line">  onHashChange();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据路由的变化，渲染对应的UI</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onHashChange</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (location.hash) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;#/home&quot;</span>:</span><br><span class="line">      routerView.innerHTML = <span class="string">&quot;Home&quot;</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;#/about&quot;</span>:</span><br><span class="line">      routerView.innerHTML = <span class="string">&quot;About&quot;</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>history</p><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/lp-Imagine/lp-Imagine@main/images/history.png"></p><p>html:</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>History Router<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--路由--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/home&quot;</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--路由跳转渲染的view--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>javascript</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当初始的 HTML 文档被完全加载和解析完成之后，DOMContentLoaded 事件被触发，而无需等待样式表、图像和子框架的完成加载</span></span><br><span class="line"><span class="comment">// 主动触发一次hashchange事件</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&quot;DOMContentLoaded&quot;</span>, onLoad);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听路由变化</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&quot;popstate&quot;</span>, onPopState);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 路由view</span></span><br><span class="line"><span class="keyword">var</span> routerView = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onLoad</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  routerView = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#view&quot;</span>);</span><br><span class="line">  onPopState();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拦截a标签的点击事件默认行为，点击时使用pushState修改URL并手动更新UI</span></span><br><span class="line">  <span class="keyword">var</span> linkList = <span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;a[href]&quot;</span>);</span><br><span class="line">  linkList.forEach(<span class="function">(<span class="params">el</span>) =&gt;</span></span><br><span class="line">    el.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">      e.preventDefault();</span><br><span class="line">      history.pushState(<span class="literal">null</span>, <span class="string">&quot;&quot;</span>, el.getAttribute(<span class="string">&quot;href&quot;</span>));</span><br><span class="line">      onPopState();</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据路由的变化，渲染对应的UI</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onPopState</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (location.pathname) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;/home&quot;</span>:</span><br><span class="line">      routerView.innerHTML = <span class="string">&quot;Home&quot;</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;/about&quot;</span>:</span><br><span class="line">      routerView.innerHTML = <span class="string">&quot;About&quot;</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="React-Router-实现"><a href="#React-Router-实现" class="headerlink" title="React-Router 实现"></a>React-Router 实现</h2><ul><li>hash</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">BrowserRouter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span>&gt;</span>home<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>about<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home&quot;</span> <span class="attr">render</span>=<span class="string">&#123;()</span> =&gt;</span> <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>&#125; /&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">render</span>=<span class="string">&#123;()</span> =&gt;</span> <span class="tag">&lt;<span class="name">h2</span>&gt;</span>About<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>&#125; /&gt;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">BrowserRouter</span>&gt;</span></span><br></pre></td></tr></table></figure><p>BrowserRouter 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">BrowserRouter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    currentPath: utils.extractHashPath(<span class="built_in">window</span>.location.href),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  onHashChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> currentPath = utils.extractHashPath(e.newURL);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;onHashChange:&quot;</span>, currentPath);</span><br><span class="line">    <span class="built_in">this</span>.setState(&#123; currentPath &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">componentDidMount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&quot;hashchange&quot;</span>, <span class="built_in">this</span>.onHashChange);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">componentWillUnmount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">&quot;hashchange&quot;</span>, <span class="built_in">this</span>.onHashChange);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;RouteContext.Provider value=&#123;&#123; <span class="attr">currentPath</span>: <span class="built_in">this</span>.state.currentPath &#125;&#125;&gt;</span><br><span class="line">        &#123;<span class="built_in">this</span>.props.children&#125;</span><br><span class="line">      &lt;/RouteContext.Provider&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Route 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123; path, render &#125;) =&gt; (</span><br><span class="line">  &lt;RouteContext.Consumer&gt;</span><br><span class="line">    &#123;<span class="function">(<span class="params">&#123; currentPath &#125;</span>) =&gt;</span> currentPath === path &amp;&amp; render()&#125;</span><br><span class="line">  &lt;/RouteContext.Consumer&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>Link 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123; to, ...props &#125;) =&gt; <span class="xml"><span class="tag">&lt;<span class="name">a</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">href</span>=<span class="string">&#123;</span>&quot;#&quot; + <span class="attr">to</span>&#125; /&gt;</span></span>;</span><br></pre></td></tr></table></figure><ul><li>history</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">HistoryRouter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span>&gt;</span>home<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>about<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home&quot;</span> <span class="attr">render</span>=<span class="string">&#123;()</span> =&gt;</span> <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>&#125; /&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">render</span>=<span class="string">&#123;()</span> =&gt;</span> <span class="tag">&lt;<span class="name">h2</span>&gt;</span>About<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>&#125; /&gt;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">HistoryRouter</span>&gt;</span></span><br></pre></td></tr></table></figure><p>HistoryRouter 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">HistoryRouter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    currentPath: utils.extractUrlPath(<span class="built_in">window</span>.location.href),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  onPopState = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> currentPath = utils.extractUrlPath(<span class="built_in">window</span>.location.href);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;onPopState:&quot;</span>, currentPath);</span><br><span class="line">    <span class="built_in">this</span>.setState(&#123; currentPath &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">componentDidMount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&quot;popstate&quot;</span>, <span class="built_in">this</span>.onPopState);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">componentWillUnmount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">&quot;popstate&quot;</span>, <span class="built_in">this</span>.onPopState);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;RouteContext.Provider</span><br><span class="line">        value=&#123;&#123;</span><br><span class="line">          currentPath: <span class="built_in">this</span>.state.currentPath,</span><br><span class="line">          onPopState: <span class="built_in">this</span>.onPopState,</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        &#123;<span class="built_in">this</span>.props.children&#125;</span><br><span class="line">      &lt;/RouteContext.Provider&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Route 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123; path, render &#125;) =&gt; (</span><br><span class="line">  &lt;RouteContext.Consumer&gt;</span><br><span class="line">    &#123;<span class="function">(<span class="params">&#123; currentPath &#125;</span>) =&gt;</span> currentPath === path &amp;&amp; render()&#125;</span><br><span class="line">  &lt;/RouteContext.Consumer&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>Link 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123; to, ...props &#125;) =&gt; (</span><br><span class="line">  &lt;RouteContext.Consumer&gt;</span><br><span class="line">    &#123;<span class="function">(<span class="params">&#123; onPopState &#125;</span>) =&gt;</span> (</span><br><span class="line">      &lt;a</span><br><span class="line">        href=<span class="string">&quot;&quot;</span></span><br><span class="line">        &#123;...props&#125;</span><br><span class="line">        onClick=&#123;<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">          e.preventDefault();</span><br><span class="line">          <span class="built_in">window</span>.history.pushState(<span class="literal">null</span>, <span class="string">&quot;&quot;</span>, to);</span><br><span class="line">          onPopState();</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    )&#125;</span><br><span class="line">  &lt;/RouteContext.Consumer&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><hr><h2 id="Vue-Router-实现"><a href="#Vue-Router-实现" class="headerlink" title="Vue-Router 实现"></a>Vue-Router 实现</h2><ul><li>hash</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span>&gt;</span>home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>about<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = &#123;</span><br><span class="line">  <span class="string">&quot;/home&quot;</span>: &#123;</span><br><span class="line">    template: <span class="string">&quot;&lt;h2&gt;Home&lt;/h2&gt;&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;/about&quot;</span>: &#123;</span><br><span class="line">    template: <span class="string">&quot;&lt;h2&gt;About&lt;/h2&gt;&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&quot;.vue.hash&quot;</span>,</span><br><span class="line">  components: &#123;</span><br><span class="line">    <span class="string">&quot;router-view&quot;</span>: RouterView,</span><br><span class="line">    <span class="string">&quot;router-link&quot;</span>: RouterLink,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeCreate</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$routes = routes;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>router-view 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;component :is=<span class="string">&quot;routeView&quot;</span> /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> utils <span class="keyword">from</span> <span class="string">&#x27;~/utils.js&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      routeView: <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="built_in">this</span>.boundHashChange = <span class="built_in">this</span>.onHashChange.bind(<span class="built_in">this</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeMount () &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&#x27;hashchange&#x27;</span>, <span class="built_in">this</span>.boundHashChange)</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted () &#123;</span><br><span class="line">    <span class="built_in">this</span>.onHashChange()</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeDestroy</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">&#x27;hashchange&#x27;</span>, <span class="built_in">this</span>.boundHashChange)</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onHashChange () &#123;</span><br><span class="line">      <span class="keyword">const</span> path = utils.extractHashPath(<span class="built_in">window</span>.location.href)</span><br><span class="line">      <span class="built_in">this</span>.routeView = <span class="built_in">this</span>.$root.$routes[path] || <span class="literal">null</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;vue:hashchange:&#x27;</span>, path)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>router-link 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a @click.prevent=<span class="string">&quot;onClick&quot;</span> href=<span class="string">&#x27;&#x27;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span>&lt;/a&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    to: <span class="built_in">String</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onClick () &#123;</span><br><span class="line">      <span class="built_in">window</span>.location.hash = <span class="string">&#x27;#&#x27;</span> + <span class="built_in">this</span>.to</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ul><li>history</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span>&gt;</span>home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>about<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = &#123;</span><br><span class="line">  <span class="string">&quot;/home&quot;</span>: &#123;</span><br><span class="line">    template: <span class="string">&quot;&lt;h2&gt;Home&lt;/h2&gt;&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;/about&quot;</span>: &#123;</span><br><span class="line">    template: <span class="string">&quot;&lt;h2&gt;About&lt;/h2&gt;&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&quot;.vue.history&quot;</span>,</span><br><span class="line">  components: &#123;</span><br><span class="line">    <span class="string">&quot;router-view&quot;</span>: RouterView,</span><br><span class="line">    <span class="string">&quot;router-link&quot;</span>: RouterLink,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$routes = routes;</span><br><span class="line">    <span class="built_in">this</span>.boundPopState = <span class="built_in">this</span>.onPopState.bind(<span class="built_in">this</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeMount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">&quot;popstate&quot;</span>, <span class="built_in">this</span>.boundPopState);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeDestroy</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">&quot;popstate&quot;</span>, <span class="built_in">this</span>.boundPopState);</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">onPopState</span>(<span class="params">...args</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.$emit(<span class="string">&quot;popstate&quot;</span>, ...args);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>router-view 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;component :is=<span class="string">&quot;routeView&quot;</span> /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> utils <span class="keyword">from</span> <span class="string">&#x27;~/utils.js&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      routeView: <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="built_in">this</span>.boundPopState = <span class="built_in">this</span>.onPopState.bind(<span class="built_in">this</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeMount () &#123;</span><br><span class="line">    <span class="built_in">this</span>.$root.$on(<span class="string">&#x27;popstate&#x27;</span>, <span class="built_in">this</span>.boundPopState)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeDestroy</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$root.$off(<span class="string">&#x27;popstate&#x27;</span>, <span class="built_in">this</span>.boundPopState)</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onPopState (e) &#123;</span><br><span class="line">      <span class="keyword">const</span> path = utils.extractUrlPath(<span class="built_in">window</span>.location.href)</span><br><span class="line">      <span class="built_in">this</span>.routeView = <span class="built_in">this</span>.$root.$routes[path] || <span class="literal">null</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;[Vue] popstate:&#x27;</span>, path)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>router-link 代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a @click.prevent=<span class="string">&quot;onClick&quot;</span> href=<span class="string">&#x27;&#x27;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span>&lt;/a&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    to: <span class="built_in">String</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  methods: &#123;</span><br><span class="line">    onClick () &#123;</span><br><span class="line">      history.pushState(<span class="literal">null</span>, <span class="string">&#x27;&#x27;</span>, <span class="built_in">this</span>.to)</span><br><span class="line">      <span class="built_in">this</span>.$root.$emit(<span class="string">&#x27;popstate&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 路由 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Router </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 NProgress 为页面/接口添加加载进度条</title>
      <link href="cy0ics/"/>
      <url>cy0ics/</url>
      
        <content type="html"><![CDATA[<p>当你打开一个页面，页面显示空白或者部分空白，那么用户就会怀疑你的网页是不是有问题。我们需要让我们的用户知道数据在路上，当他们点击一个需要请求数据链接时，就会给出反馈，让用户知道页面的加载情况</p><h2 id="一、NProgress（一个轻量级进度条组件）"><a href="#一、NProgress（一个轻量级进度条组件）" class="headerlink" title="一、NProgress（一个轻量级进度条组件）"></a>一、NProgress（一个轻量级进度条组件）</h2><ol><li> 借用 axios 拦截器组合实现</li><li> 通过组件内的路由守卫实现</li><li> 通过路由的全局前置守卫实现</li></ol><hr><h2 id="二、解决方案-1：NProgress-与-axios-interceptors"><a href="#二、解决方案-1：NProgress-与-axios-interceptors" class="headerlink" title="二、解决方案 1：NProgress 与 axios interceptors"></a>二、解决方案 1：NProgress 与 axios interceptors</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1）安装NProgress</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install nprogress</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2） 安装好之后，需要在main.js中引入CSS</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;nprogress/nprogress.css&quot;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3） 最后在axios中引入NProgress</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> NProgress <span class="keyword">from</span> <span class="string">&quot;nprogress&quot;</span>;</span><br></pre></td></tr></table></figure><p>NProgress 提供四个基本 API</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">NProgress.start(); <span class="comment">// 开始展示进度条</span></span><br><span class="line">NProgress.set(<span class="number">0.4</span>); <span class="comment">// 设置进度百分比</span></span><br><span class="line">NProgress.inc(); <span class="comment">// 以随机量递增进度</span></span><br><span class="line">NProgress.done(); <span class="comment">// 完成进度条</span></span><br><span class="line"><span class="comment">// 配置进度条</span></span><br><span class="line">NProgress.configure(&#123;</span><br><span class="line">  minimum: <span class="number">0.08</span>, <span class="comment">// 配置开始初始值，默认0.08</span></span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;bar&quot; role=&quot;bar&quot;&gt;</span></span><br><span class="line"><span class="string">         &lt;div class=&quot;peg&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">     &lt;/div&gt;</span></span><br><span class="line"><span class="string">     &lt;div class=&quot;spinner&quot; role=&quot;spinner&quot;&gt;</span></span><br><span class="line"><span class="string">         &lt;div class=&quot;spinner-icon&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string"> `</span>, <span class="comment">// 配置模板</span></span><br><span class="line">  easing: <span class="string">&quot;linear&quot;</span>, <span class="comment">// 配置动画</span></span><br><span class="line">  speed: <span class="number">200</span>, <span class="comment">//配置速度</span></span><br><span class="line">  trickle: <span class="literal">true</span>, <span class="comment">// 是否让进度条自动增加</span></span><br><span class="line">  trickleSpeed: <span class="number">200</span>, <span class="comment">// 配置自动前进的频率ms</span></span><br><span class="line">  showSpinner: <span class="literal">true</span>, <span class="comment">//是否显示加载动画，如下图</span></span><br><span class="line">  parent: <span class="string">&quot;body&quot;</span>, <span class="comment">//配置挂载元素，即相对定位的元素</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/npm/@qinyuanqiu/statics@1.0.5/images/subscription/nprogress1.png#id=PGmpA&originHeight=544&originWidth=908&originalType=binary&ratio=1&status=done&style=none"></p><p>AXIOS 拦截器允许我们拦截我们的请求和响应，添加额外的功能，我们可以在其中启动和停止进度条，一个简单的功能如下所示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> axios.interceptors.request.use(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line"><span class="number">2</span>     NProgress.start()</span><br><span class="line"><span class="number">3</span>     <span class="keyword">return</span> config</span><br><span class="line"><span class="number">4</span> &#125;)</span><br><span class="line"><span class="number">5</span> axios.interceptors.response.use(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line"><span class="number">6</span>     NProgress.done()</span><br><span class="line"><span class="number">7</span>     <span class="keyword">return</span> response</span><br><span class="line"><span class="number">8</span> &#125;)</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/npm/@qinyuanqiu/statics@1.0.5/images/subscription/nprogress2.png#id=B4TcG&originHeight=549&originWidth=986&originalType=binary&ratio=1&status=done&style=none"></p><p>正如您所看到的，AXIOS 拦截器充当中间件，允许您在发出请求时或在接收到响应时运行某些代码</p><p>总结：这是一个有效的解决方案，可能对你很有用，但有两个注意事项你应该知道。</p><p><strong>不适合同时进行多个 API 调用</strong><br><strong>在我们使用两个或更多的 API 调用来加载页面之前，这种方法需要一些改进。在这个场景中，我们希望持续显示进度条，直到所有 API 调用返回为止。此问题的常见解决方案是创建一个保存加载状态的加载 Vuex 模块。</strong></p><p>在返回 API 调用之前首屏呈现一定的空白<br>在某些网页上，在数据完全之前看到该页的部分元素并不是很好的用户体验，最好是拿到数据后在进行渲染。我们来看看其他的方案</p><hr><h2 id="三、解决方案-2：组件内的路由守卫-beforeRouteEnter"><a href="#三、解决方案-2：组件内的路由守卫-beforeRouteEnter" class="headerlink" title="三、解决方案 2：组件内的路由守卫 beforeRouteEnter"></a>三、解决方案 2：组件内的路由守卫 beforeRouteEnter</h2><p>同样的我们安装 nprogress,并在 main.js 中引入 css</p><p>不同的是我们这次在对应的页面组件中引入 NProgress，而不是在请求中</p><p>实例如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//page.vue</span></span><br><span class="line">  <span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line">  <span class="keyword">import</span> NProgress <span class="keyword">from</span> <span class="string">&#x27;nprogress&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//组件渲染之前的生命周期函数</span></span><br><span class="line">  <span class="function"><span class="title">beforeRouteEnter</span>(<span class="params">routeTo、routeFrom、next</span>)</span>&#123;</span><br><span class="line">      NProgress.start()<span class="comment">// 启动进度条</span></span><br><span class="line">      <span class="comment">// 由于组件尚未创建，因此不能在此处使用this关键字。</span></span><br><span class="line">      store.dispatch(<span class="string">&#x27;event/fetchEvent,routeTo.params.id).(data =&gt; &#123;</span></span><br><span class="line"><span class="string">        console.log(data)// 获取数据</span></span><br><span class="line"><span class="string">        NProgress.done()// 当操作完成时，完成进度条</span></span><br><span class="line"><span class="string">        next()// 只有调用此命令，导航才会继续</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>这样我们就能确保获取到组件渲染所需的数据后才渲染组件</p><hr><h2 id="四、解决方案-3：路由全局守卫与单路由守卫-Global-and-Per-Route-Guards"><a href="#四、解决方案-3：路由全局守卫与单路由守卫-Global-and-Per-Route-Guards" class="headerlink" title="四、解决方案 3：路由全局守卫与单路由守卫 Global and Per-Route Guards"></a>四、解决方案 3：路由全局守卫与单路由守卫 Global and Per-Route Guards</h2><p>同样的先安装引入 NProgress</p><p>在 route.js 中引入 NProgress</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// route.js</span></span><br><span class="line"> <span class="comment">// 在每个路由行为之前</span></span><br><span class="line"> router.beforeach(<span class="function">(<span class="params">routeTo, routeFrom, next</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="comment">//启动路由进度条</span></span><br><span class="line">     NProgress.start（）</span><br><span class="line">     next()</span><br><span class="line"> &#125;)</span><br><span class="line"> <span class="comment">// 在每个路由行为之后</span></span><br><span class="line">router.afterEach(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 完成路由进度条</span></span><br><span class="line">    NProgress.done()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>这样我们已经初步完成 NProgress 的布置，但是我们还是需要在确保页面数据都请求到之后才执行 router.afterEach，有两种方法：</p><p>在页面中使用 beforeRouteEnter 生命周期函数，但是这里推荐使用下一种方案<br>在路由列表中使用 beforeEnter 守卫，配合使用 props,我们可以将 vuex 从页面组件中移除，这样我们的组件会变得更加的简洁，也更容易维护</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> Vue.use(Router)</span><br><span class="line">  <span class="keyword">const</span> router = <span class="keyword">new</span> Router(&#123;</span><br><span class="line">      mode: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">      routes: [</span><br><span class="line">          &#123;</span><br><span class="line">              path: <span class="string">&#x27;/event/:id&#x27;</span>,</span><br><span class="line">              name: <span class="string">&#x27;event-show&#x27;</span>,</span><br><span class="line">              component: EventShow,</span><br><span class="line">            props: <span class="literal">true</span>,</span><br><span class="line">            <span class="function"><span class="title">beforeEnter</span>(<span class="params">routeTo, routeFrom, next</span>)</span> &#123;</span><br><span class="line">                store.dispatch(<span class="string">&#x27;event/fetchEvent&#x27;</span>, routeTo.params.id).then(<span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">                    routeTo.params.event = event</span><br><span class="line">                    next()</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>单独的配置路由列表，无数据请求的路由页，进度条可以瞬间完成，配置 beforeEnter 的将等待数据请求成功后才渲染组件。<br>另外，这样通过组件传参的方式将数据传递到组件中，可以将 vuex 从组件中移除，优化了组件，使其更加具有维护性</p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL 数据库常用操作</title>
      <link href="wsh1gw/"/>
      <url>wsh1gw/</url>
      
        <content type="html"><![CDATA[<h2 id="连接-mysql"><a href="#连接-mysql" class="headerlink" title="连接 mysql"></a>连接 mysql</h2><blockquote><p>mysql -h 主机地址 -u 用户名 -p 用户密码</p></blockquote><h3 id="连接本地"><a href="#连接本地" class="headerlink" title="连接本地"></a>连接本地</h3><p>在 mysql 安装目录下的 bin 下打开 cmd，输入命令 mysql -uroot -p,回车输入密码；如果刚安装好 MYSQL，超级用户 root 是没有密码的，故直接回车即可进入到 MYSQL 中了，MYSQL 的提示符是：mysql&gt;</p><h3 id="连接远程"><a href="#连接远程" class="headerlink" title="连接远程"></a>连接远程</h3><p><code>mysql -h192.168.8.1 -uroot -p123456</code></p><h3 id="退出"><a href="#退出" class="headerlink" title="退出"></a>退出</h3><ul><li><code>exit</code> 回车</li></ul><h3 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h3><blockquote><p>mysqladmin -u 用户名 -p 旧密码 password 新密码</p></blockquote><p><code>mysqladmin -uroot -p123456 password 123</code></p><h2 id="增加新用户"><a href="#增加新用户" class="headerlink" title="增加新用户"></a>增加新用户</h2><blockquote><p>grant select on 数据库.* to 用户名@登录主机 identified by ”密码”</p></blockquote><ul><li>例 1：增加一个用户 test1 密码为 abc，让他可以在任何主机上登录，并对所有数据库有查询、插入、修改、删除的权限。首先用以 root 用户连入 MYSQL，然后键入以下命令：</li></ul><p><code>grant select,,update,delete on *.* to test1@“%” Identified by ”abc”;</code></p><ul><li>例 2：增加一个用户 test2 密码为 abc,让他只可以在 localhost 上登录，并可以对数据库 mydb 进行查询、插入、修改、删除的操作(localhost 指本地主机，即 MYSQL 数据库所在的那台主机)</li></ul><p>这样用户即使用知道 test2 的密码，他也无法从 internet 上直接访问数据库，只能通过 MYSQL 主机上的 web 页来访问了。</p><p><code>grant select,,update,delete on mydb.* to test2@localhost identified by ”abc”;</code></p><h2 id="显示命令"><a href="#显示命令" class="headerlink" title="显示命令"></a>显示命令</h2><ul><li>显示数据库列表<br><code>show databases;</code></li><li>显示库中的数据表</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use mysql; <span class="operator">/</span><span class="operator">/</span> 打开数据库</span><br><span class="line"><span class="keyword">show</span> tables;</span><br></pre></td></tr></table></figure><ul><li>显示数据表结构<br><code>describe 表名</code></li><li>建库<br><code>create database 库名</code></li><li>建表<br><code>use 库名create table 表名 (字段设定列表)</code></li><li>删库和删表<br><code>drop database 库名drop table 表名</code></li><li>将表中记录清空<br><code>delete from 表名</code></li><li>显示表中的记录<br><code>select * from 表名</code></li><li>建库和建表以及插入数据的实例</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> database if <span class="keyword">exists</span> school; <span class="operator">/</span><span class="operator">/</span>如果存在SCHOOL则删除</span><br><span class="line"><span class="keyword">create</span> database school; <span class="operator">/</span><span class="operator">/</span>建立库</span><br><span class="line">SCHOOL use school; <span class="operator">/</span><span class="operator">/</span>打开库</span><br><span class="line">SCHOOL <span class="keyword">create</span> <span class="keyword">table</span> teacher <span class="operator">/</span><span class="operator">/</span>建立表</span><br><span class="line">TEACHER (  id <span class="type">int</span>(<span class="number">3</span>) auto_increment <span class="keyword">not</span>  <span class="keyword">primary</span> key,  name <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">not</span> ,  address <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">default</span> <span class="string">&#x27;深圳&#x27;</span>,  <span class="keyword">year</span> <span class="type">date</span> ); <span class="operator">/</span><span class="operator">/</span>建表结束</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>以下为插入字段 teacher <span class="keyword">values</span>(<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;glchengang&#x27;</span>,<span class="string">&#x27;深圳一中&#x27;</span>,<span class="string">&#x27;1976-10-10&#x27;</span>); teacher <span class="keyword">values</span>(<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;深圳一中&#x27;</span>,<span class="string">&#x27;1975-12-23&#x27;</span>);</span><br></pre></td></tr></table></figure><div class="note info modern"><p>在建表中：</p><ul><li>将 ID 设为长度为 3 的数字字段：int(3)并让它每个记录自动加一：auto_increment 并不能为空：not 而且让他成为主字段 primary key</li><li>将 NAME 设为长度为 10 的字符字段</li><li>将 ADDRESS 设为长度 50 的字符字段，而且缺省值为深圳</li><li>将 YEAR 设为日期字段</li></ul></div><h2 id="备份数据库"><a href="#备份数据库" class="headerlink" title="备份数据库"></a>备份数据库</h2><ul><li>\mysql\bin 目录下执行<br>将数据库 school 备份到 school.bbb 文件，school.bbb 是一个文本文件，文件名任取</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump –opt school<span class="operator">&gt;</span>school.bbb</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS 循环遍历方法</title>
      <link href="nn7ncb/"/>
      <url>nn7ncb/</url>
      
        <content type="html"><![CDATA[<p>本文主要总结一下 javascript 遍历方法。</p><h2 id="for"><a href="#for" class="headerlink" title="for"></a>for</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i, arr[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0 1</span></span><br><span class="line"><span class="comment">// 1 2</span></span><br><span class="line"><span class="comment">// 2 3</span></span><br></pre></td></tr></table></figure><blockquote><p>for 循环是最常用的遍历方法，主要用来遍历数组。</p></blockquote><hr><h2 id="for-in"><a href="#for-in" class="headerlink" title="for in"></a>for in</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">name</span>: <span class="string">&quot;Li&quot;</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i, obj[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// name Li</span></span><br><span class="line"><span class="comment">// age  18</span></span><br></pre></td></tr></table></figure><blockquote><p>for in 主要是遍历对象，i 表示对象 obj 的 key，obj[i]表示 value；当用于遍历数组时，i 输出为字符串形式，而不是数组需要的数字下标，这意味着在某些情况下，会发生字符串运算，导致数据错误，比如：’9’+1 = ‘91’ 而不是我们需要的 10,所以不建议用来遍历数组。<br>另外 for in 循环的时候，不仅遍历自身的属性，还会找到 prototype 上去，所以最好在循环体内加一个判断，就用 obj[i].hasOwnProperty(i)，这样就避免遍历出太多不需要的属性。</p></blockquote><hr><h2 id="while"><a href="#while" class="headerlink" title="while"></a>while</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (arr[i]) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i, arr[i]);</span><br><span class="line">  i++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0 1</span></span><br><span class="line"><span class="comment">// 1 2</span></span><br><span class="line"><span class="comment">// 2 3</span></span><br></pre></td></tr></table></figure><blockquote><p>while 循环会在指定条件下重复执行代码块。与 for 循环原理是一样的，只是 for 循环将条件判断、定义和自增都放在一个条件里了。</p></blockquote><hr><h2 id="do-while"><a href="#do-while" class="headerlink" title="do/while"></a>do/while</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;number is&quot;</span>,</span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(str + i); <span class="comment">// number is0   number is1</span></span><br><span class="line">  i++;</span><br><span class="line">&#125; <span class="keyword">while</span> (i &lt; <span class="number">2</span>);</span><br></pre></td></tr></table></figure><blockquote><p>do/while 循环是 while 循环的变体。该循环会在检查条件是否为真之前执行一次代码块，然后如果条件为真的话，就会重复这个循环，否则就结束循环。</p></blockquote><hr><h2 id="forEach-Array"><a href="#forEach-Array" class="headerlink" title="forEach(Array)"></a>forEach(Array)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item, index, arr</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index, item, arr);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0 1 [1,2,3]</span></span><br><span class="line"><span class="comment">// 1 2 [1,2,3]</span></span><br><span class="line"><span class="comment">// 2 3 [1,2,3]</span></span><br></pre></td></tr></table></figure><blockquote><p>forEach 循环 循环数组中的每一个元素并操作，直接修改原数组，没有返回值；一共有三个参数：item(数组的每一项)，index(下标)，arr(原数组)，只有 item 是必须的。<br>**<em>注意</em>**：forEach 循环在所有元素调用完毕之前是不能停止的，它没有 break 语句，如果你必须要停止，可以尝试 try catch 语句，就是在要强制退出的时候，抛出一个 error 给 catch 捕捉到，然后在 catch 里面 return，这样就能中止循环了。</p></blockquote><hr><h2 id="map-Array"><a href="#map-Array" class="headerlink" title="map(Array)"></a>map(Array)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = arr.map(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item); <span class="comment">// 1 2 3</span></span><br><span class="line">  <span class="keyword">return</span> item + <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr2); <span class="comment">// [2, 3, 4]</span></span><br></pre></td></tr></table></figure><blockquote><p>map()方法返回一个新数组，数组中的元素为原始数组元素调用函数处理后的值。</p></blockquote><hr><h2 id="filter-Array"><a href="#filter-Array" class="headerlink" title="filter(Array)"></a>filter(Array)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> item &lt; <span class="number">3</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr2); <span class="comment">// [1, 2]</span></span><br></pre></td></tr></table></figure><blockquote><p>filter()方法是 Array 对象内置方法，它会返回通过过滤的元素，不改变原来的数组。</p></blockquote><hr><h2 id="some-Array"><a href="#some-Array" class="headerlink" title="some(Array)"></a>some(Array)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> bool = arr.some(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> item &lt; <span class="number">3</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(bool); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><blockquote><p>some()方法用于检测数组中的元素是否满足指定条件（函数提供）,返回 boolean 值，不改变原数组。</p></blockquote><hr><h2 id="every-Array"><a href="#every-Array" class="headerlink" title="every(Array)"></a>every(Array)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> bool = arr.every(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> item &gt; <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(bool); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><blockquote><p>every()方法用于检测数组所有元素是否都符合指定条件（通过函数提供），返回 boolean 值，不改变原数组。</p></blockquote><hr><h2 id="reduce-Array"><a href="#reduce-Array" class="headerlink" title="reduce(Array)"></a>reduce(Array)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">i, j</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> i + j;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr2); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><blockquote><p>reduce()方法接收一个函数作为累加器，数组中的每个值（从左到右）开始缩减，最终计算为一个值。</p></blockquote><hr><h2 id="reduceRight-Array"><a href="#reduceRight-Array" class="headerlink" title="reduceRight(Array)"></a>reduceRight(Array)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = arr.reduceRight(<span class="function"><span class="keyword">function</span> (<span class="params">i, j</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> i + j;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr2); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><blockquote><p>reduceRight()方法,和 reduce() 功能是一样的，它是从数组的末尾处向前开始计算。</p></blockquote><hr><h2 id="for-of"><a href="#for-of" class="headerlink" title="for of"></a>for of</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> arr) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &#x27;a&#x27;</span></span><br><span class="line"><span class="comment">// &#x27;b&#x27;</span></span><br><span class="line"><span class="comment">// &#x27;c&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>for of 循环是 Es6 中新增的语句，用来替代 for in 和 forEach，它允许你遍历 Arrays（数组）, Strings（字符串）, Maps（映射）, Sets（集合）等可迭代(Iterable data)的数据结构。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javascript 正则表达式校验</title>
      <link href="ctko47/"/>
      <url>ctko47/</url>
      
        <content type="html"><![CDATA[<h2 id="一、校验数字的表达式"><a href="#一、校验数字的表达式" class="headerlink" title="一、校验数字的表达式"></a>一、校验数字的表达式</h2><ul><li>数字：<a href="#fn1">[1]</a>*$</li><li>n 位的数字：^\d{n}$</li><li>至少 n 位的数字：^\d{n,}$</li><li>m-n 位的数字：^\d{m,n}$</li><li>零和非零开头的数字：^(0|[1-9][0-9]*)$</li><li>非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]{1,2})?$</li><li>带 1-2 位小数的正数或负数：^(-)?\d+(.\d{1,2})?$</li><li>正数、负数、和小数：^(-|+)?\d+(.\d+)?$</li><li>有两位小数的正实数：<a href="#fn2">[2]</a>+(.[0-9]{2})?$</li><li>有 1~3 位小数的正实数：<a href="#fn3">[3]</a>+(.[0-9]{1,3})?$</li><li>非零的正整数：<a href="#fn4">[4]</a>\d*$ 或 ^([1-9][0-9]*){1,3}$ 或 ^+?[1-9][0-9]*$</li><li>非零的负整数：^-[1-9][]0-9”<em>$ 或 ^-[1-9]\d</em>$</li><li>非负整数：^\d+$ 或 <a href="#fn5">[5]</a>\d*|0$</li><li>非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$</li><li>非负浮点数：^\d+(.\d+)?$ 或 <a href="#fn6">[6]</a>\d*.\d*|0.\d*[1-9]\d*|0?.0+|0$</li><li>非正浮点数：^((-\d+(.\d+)?)|(0+(.0+)?))$ 或 ^(-([1-9]\d*.\d*|0.\d*[1-9]\d*))|0?.0+|0$</li><li>正浮点数：<a href="#fn7">[7]</a>\d*.\d*|0.\d*[1-9]\d*$ 或 ^(([0-9]+.[0-9]<em>[1-9][0-9]</em>)|([0-9]<em>[1-9][0-9]</em>.[0-9]+)|([0-9]<em>[1-9][0-9]</em>))$</li><li>负浮点数：^-([1-9]\d*.\d*|0.\d*[1-9]\d*)$ 或 ^(-(([0-9]+.[0-9]<em>[1-9][0-9]</em>)|([0-9]<em>[1-9][0-9]</em>.[0-9]+)|([0-9]<em>[1-9][0-9]</em>)))$</li><li>浮点数：^(-?\d+)(.\d+)?$ 或 ^-?([1-9]\d*.\d*|0.\d*[1-9]\d*|0?.0+|0)$</li></ul><hr><h2 id="二、校验字符的表达式"><a href="#二、校验字符的表达式" class="headerlink" title="二、校验字符的表达式"></a>二、校验字符的表达式</h2><ul><li>汉字：<a href="#fn8">[8]</a>{0,}$</li><li>英文和数字：<a href="#fn9">[9]</a>+$ 或 <a href="#fn10">[10]</a>{4,40}$</li><li>长度为 3-20 的所有字符：^.{3,20}$</li><li>由 26 个英文字母组成的字符串：<a href="#fn11">[11]</a>+$</li><li>由 26 个大写英文字母组成的字符串：<a href="#fn12">[12]</a>+$</li><li>由 26 个小写英文字母组成的字符串：<a href="#fn13">[13]</a>+$</li><li>由数字和 26 个英文字母组成的字符串：<a href="#fn14">[14]</a>+$</li><li>由数字、26 个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w{3,20}$</li><li>中文、英文、数字包括下划线：<a href="#fn15">[15]</a>+$</li><li>中文、英文、数字但不包括下划线等符号：<a href="#fn16">[16]</a>+$ 或 <a href="#fn17">[17]</a>{2,20}$</li><li>可以输入含有^%&amp;’,;=?![\x22]+</li><li>禁止输入含有的字符：[^\x22]+</li></ul><hr><h2 id="三、特殊需求表达式"><a href="#三、特殊需求表达式" class="headerlink" title="三、特殊需求表达式"></a>三、特殊需求表达式</h2><ul><li>Email 地址：^\w+([-+.]\w+)<em>@\w+([-.]\w+)</em>.\w+([-.]\w+)*$</li><li>域名：[a-zA-Z0-9][-a-za-z0-9]{0,62}(/.[a-zA-Z0-9][-a-za-z0-9]{0,62})+/.?</li><li>InternetURL：[a-zA-z]+://[^\s]_ 或 ^http://([\w-]+.)+[\w-]+(/[\w-./?%&amp;=]_)?$</li><li>手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$</li><li>电话号码(“XXX-XXXXXXX”、”XXXX-XXXXXXXX”、”XXX-XXXXXXX”、”XXX-XXXXXXXX”、”XXXXXXX”和”XXXXXXXX)：^((\d{3,4}-)|\d{3.4}-)?\d{7,8}$</li><li>国内电话号码(0511-4405222、021-87888822)：\d{3}-\d{8}|\d{4}-\d{7}<br><strong>身份证号：</strong></li><li>15 或 18 位身份证：^\d{15}|\d{18}$</li><li>15 位身份证：<a href="#fn18">[18]</a>\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$</li><li>18 位身份证：<a href="#fn19">[19]</a>\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{4}$</li><li>短身份证号码(数字、字母 x 结尾)：^([0-9]){7,18}(x|X)?$ 或 ^\d{8,18}|[0-9x]{8,18}|[0-9X]{8,18}?$</li></ul><hr><ul><li>帐号是否合法(字母开头，允许 5-16 字节，允许字母数字下划线)：<a href="#fn20">[20]</a>[a-zA-Z0-9_]{4,15}$</li><li>密码(以字母开头，长度在 6~18 之间，只能包含字母、数字和下划线)：<a href="#fn21">[21]</a>\w{5,17}$</li><li>强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在 8-10 之间)：^(?=.<em>\d)(?=.</em>[a-z])(?=.*[A-Z]).{8,10}$</li><li>日期格式：^\d{4}-\d{1,2}-\d{1,2}</li><li>一年的 12 个月(01 ～ 09 和 1 ～ 12)：^(0?[1-9]|1[0-2])$</li><li>一个月的 31 天(01 ～ 09 和 1 ～ 31)：^((0?[1-9])|((1|2)[0-9])|30|31)$<br><strong>钱的输入格式：</strong></li><li>1）有四种钱的表示形式我们可以接受:”10000.00” 和 “10,000.00”, 和没有 “分” 的 “10000” 和 “10,000”：<a href="#fn22">[22]</a>[0-9]*$</li><li>2）这表示任意一个不以 0 开头的数字,但是,这也意味着一个字符”0”不通过,所以我们采用下面的形式：^(0|[1-9][0-9]*)$</li><li>3）一个 0 或者一个不以 0 开头的数字.我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$</li><li>4）这表示一个 0 或者一个可能为负的开头不为 0 的数字.让用户以 0 开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：<a href="#fn23">[23]</a>+(.[0-9]+)?$</li><li>5）必须说明的是,小数点后面至少应该有 1 位数,所以”10.”是不通过的,但是 “10” 和 “10.2” 是通过的：<a href="#fn24">[24]</a>+(.[0-9]{2})?$</li><li>6）这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：<a href="#fn25">[25]</a>+(.[0-9]{1,2})?$</li><li>7）这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：<a href="#fn26">[26]</a>{1,3}(,[0-9]{3})*(.[0-9]{1,2})?$</li><li>8）1 到 3 个数字,后面跟着任意个 逗号+3 个数字,逗号成为可选,而不是必须：^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$</li></ul><blockquote><p>备注：这就是最终结果了,别忘了”+”可以用”*“替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里</p></blockquote><ul><li>xml 文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+.[x|X][m|m][l|L]$</li><li>中文字符的正则表达式：[\u4e00-\u9fa5]</li><li>双字节字符：[^\x00-\xff]    (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计 2，ASCII 字符计 1))</li><li>空白行的正则表达式：\n\s*\r    (可以用来删除空白行)</li><li>HTML 标记的正则表达式：&lt;(\S*?)[^&gt;]*&gt;._?&lt;/\1&gt;|&lt;._? /&gt;    (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</li><li>首尾空白字符的正则表达式：^\s*|\s*![]    (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</li><li>腾讯 QQ 号：[1-9][0-9]{4,}    (腾讯 QQ 号从 10000 开始)</li><li>中国邮政编码：[1-9]\d{5}(?!\d)    (中国邮政编码为 6 位数字)</li><li>IP 地址：\d+.\d+.\d+.\d+    (提取 IP 地址时有用)</li></ul><hr><h2 id="四、过滤-Emoji"><a href="#四、过滤-Emoji" class="headerlink" title="四、过滤 Emoji"></a>四、过滤 Emoji</h2><ul><li>name = name.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g, “”)</li></ul><hr><p>相关推荐：<a href="https://www.cnblogs.com/zqyanywn/p/7125211.html">https://www.cnblogs.com/zqyanywn/p/7125211.html</a></p>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
            <tag> RegExp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git 命令</title>
      <link href="egd000/"/>
      <url>egd000/</url>
      
        <content type="html"><![CDATA[<h1 id="一：Git-是什么？"><a href="#一：Git-是什么？" class="headerlink" title="一：Git 是什么？"></a>一：Git 是什么？</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Git是目前世界上最先进的分布式版本控制系统。</span><br></pre></td></tr></table></figure><hr><h1 id="二：SVN-与-Git-的最主要的区别"><a href="#二：SVN-与-Git-的最主要的区别" class="headerlink" title="二：SVN 与 Git 的最主要的区别?"></a>二：SVN 与 Git 的最主要的区别?</h1><p>SVN 为集中式版本控制系统，版本库是集中存放在中央服务器的<br>单独搭建 SVN 服务器，不能离线工作<br>操作简单，代码保密性较强</p><p>GIT 为分布式版本控制系统根本没有“中央服务器”，每个人的电脑上都是一个完整的版本库<br>适合分布式开发，强调个体<br>公共服务器压力和数据量都不会太大<br>速度快灵活<br>可以离线工作<br>操作复杂，代码保密性差</p><p>GitHub,免费的远程仓库，如果是个人的开源项目，放到 GitHub 上是完全没有问题的。GitHub 还是一个开源协作社区，通过 GitHub，既可以让别人参与你的开源项目，也可以参与别人的开源项目。</p><p>SVN 的存储需要依赖一个服务器，而 git 所有的东西是放在线上的。节约成本，省时省力。</p><p>‘Please tell me who you are.’</p><p>查看全局配置   git config –global –list</p><p>命令   git config –global user.name “你的 git 名称”<br>命令   git config –global user.email “你的 git 验证邮箱”</p><p>git 命令行中的操作命令：<br>命令  cd D:   进入 相应的磁盘<br>命令  mkdir   创建目录<br>命令  cd 进入当前盘符中的文件夹<br>命令  pwd 显示当前工作目录的全路径<br>命令  rm   删除文件<br>命令  ls 查看文件夹下的子文件</p><p>然后！最重要的步骤来了！！git init</p><p>命令  git init<br>显示成功后去相应的文件夹中查看是不是多了一个.git 文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这个文件夹就是你的版本库了，把项目放在文件夹下。</span><br></pre></td></tr></table></figure><hr><h1 id="三-将文件提交到-git-服务器。"><a href="#三-将文件提交到-git-服务器。" class="headerlink" title="三.将文件提交到 git 服务器。"></a>三.将文件提交到 git 服务器。</h1><p>你的本地仓库由 git 维护的三棵“树”组成：<br>　　第一个是你的 工作目录，它持有实际文件；<br>　　第二个是 暂存区（Index），临时保存你的改动；<br>　　最后是 HEAD，指向你最近一次提交后的结果。</p><h2 id="1-打开-Git-Bash"><a href="#1-打开-Git-Bash" class="headerlink" title="1.打开 Git Bash"></a>1.打开 Git Bash</h2><p>命令 git add ‘文件名’<br>git add -u   提交所有被修改(modified)和被删除(deleted)文件，不包括新文件(new)<br>git add .   提交所有新文件(new)和被修改(modified)文件，不包括被删除(deleted)文件<br>git add -A   提交所有变化</p><p>把咱们的文件存放在一个神秘的地方 &gt;&gt;&gt;&gt; 暂存区 （暂存区在本机）</p><h2 id="2-把文件提交到本地仓库中去。"><a href="#2-把文件提交到本地仓库中去。" class="headerlink" title="2.把文件提交到本地仓库中去。"></a>2.把文件提交到本地仓库中去。</h2><p>git commit -m ‘我提交时候的备注（注释）’</p><h2 id="3-查看-commit-状态"><a href="#3-查看-commit-状态" class="headerlink" title="3.查看 commit 状态"></a>3.查看 commit 状态</h2><p>git status   用于显示工作目录和暂存区的状态。</p><h2 id="4-查看修改内容。"><a href="#4-查看修改内容。" class="headerlink" title="4.查看修改内容。"></a>4.查看修改内容。</h2><p>git diff 你的文件名   会出现更改信息；<br>将更改后的东西提交上去，和之前一样。先 add 然后再 commit 。</p><h2 id="5-版本退回"><a href="#5-版本退回" class="headerlink" title="5.版本退回"></a>5.版本退回</h2><p>git log          （ 查看日志）<br>git reflog</p><p>git reset –hard HEAD^   退回到上个版本 如果需要退回好多版本就在后面加上 ^ 例： git reset –hard HEAD^^退回两个版本。<br>git reset –hard 191e0c7   回退到指定版本</p><h2 id="6-删除"><a href="#6-删除" class="headerlink" title="6.删除"></a>6.删除</h2><p>新建一个 b.txt，然后 commit 到库中。 并删除。</p><p>命令 1. git add</p><p>命令 2. git commit -m ‘备注’</p><p>命令 3. rm b.txt   这个是删除 b 文件的命令</p><p>回过头来看文件夹中的 b.txt</p><p>b.txt 不见了，查看下状态。<br>可以 commit，可以放弃修改  git reset –hard 版本号来回复文件。</p><h2 id="7-连接远程仓库"><a href="#7-连接远程仓库" class="headerlink" title="7.连接远程仓库"></a>7.连接远程仓库</h2><ol><li>git init   -&gt; 创建版本库</li><li>git add 文件名   -&gt; 添加到暂存区</li><li>git commit -m ‘提交注释’   -&gt;提交到本地仓库</li></ol><p>然后连接本地仓库，并将自己的库 push 到服务器中去。</p><ol><li> 命令 1. git remote add origin https: // github.com/你的账号/你的项目名称   设置远程仓库地址</li><li> 命令 2. git push -u origin master 将本地的库推送到 master 分支 （就是推送到服务器上）</li></ol><p>git push -u -f origin master(提交到远程仓库，这个命令中的 -f 是强制推送，因为远程仓库只有初始化的文件，所以强制推送上去就行了，不加-f 会报当前分支没有远程分支，强制推送可以覆盖 master，这样就完成了第一次提交的步骤)</p><p>git remote -v   查看远程仓库地址<br>git remote rm origin   删除远程仓库地址</p><p>在服务器上查看是否推送成功。</p><p>从现在开始，只需要 git push 就可以把本机的代码提交到远程仓库。<br>git push     (提交 master 分支 到远程仓库)<br>git push origin 分支名     (提交其他分支 到远程仓库)</p><p>获取远程仓库的更新数据：<br>git fetch：相当于是从远程获取最新到本地，不会自动 merge<br>git pull：相当于是从远程获取最新版本并 merge 到本地<br>git pull origin 分支名   更新某个远程分支到本地</p><p>从服务器克隆数据， git clone<br>git clone <a href="https://github.com/yanghuaizhi1210/GitTest">https://github.com/yanghuaizhi1210/GitTest</a><br>将服务器端的数据克隆过来。</p><p>如果输入$ git remote add origin <a href="mailto:git@github.com">git@github.com</a>:djqiang（github 帐号名）/gitdemo（项目名）.git<br>提示出错信息：fatal: remote origin already exists.<br>解决办法如下：<br>1、先输入$ git remote rm origin<br>2、再输入$ git remote add origin <a href="mailto:git@github.com">git@github.com</a>:djqiang/gitdemo.git 就不会报错了！<br>3、如果输入$ git remote rm origin 还是报错的话，error: Could not remove config section ‘remote.origin’. 我们需要修改 gitconfig 文件的内容<br>4、找到你的 github 的安装路径，我的是 C:\Users\ASUS\AppData\Local\GitHub\PortableGit_ca477551eeb4aea0e4ae9fcd3358bd96720bb5c8\etc<br>5、找到一个名为 gitconfig 的文件，打开它把里面的[remote “origin”]那一行删掉就好了！</p><p>生成秘钥：<br>（1）首先检查电脑是否曾经生成过秘钥<br>cd <del>/.ssh<br>若打开该文件夹为空，则表示没有生成过秘钥，进入第二步。（</del>表示根目录）<br>(2) 生成秘钥<br>ssh-keygen -t rsa -C “your email”<br>命令要求输入密码，不用输，三个回车即可。<br>执行成功后，会在主目录.ssh 路径下生成两个文件：id_rsa 私钥文件；id_rsa.pub 公钥文件；</p><p>登陆 github 帐户点击头像，然后 Settings -&gt; 左栏点击 SSH and GPG keys -&gt; 点击 New SSH key<br>在远程仓库 gitlab 上添加 title 和 key，和本地的一致。title 可以自己取一个容易区分的名字，key 为 id_rsa.pub 中的内容（全部复制，可用 cat id_rsa.pub 命令打开）</p><p>配置了 ssh 秘钥，使用远程仓库的 ssh 地址提交<br><a href="https://www.cnblogs.com/superGG1990/p/6844952.html">https://www.cnblogs.com/superGG1990/p/6844952.html</a></p><hr><h1 id="分支操作"><a href="#分支操作" class="headerlink" title="分支操作"></a>分支操作</h1><p>查看分支：git branch<br>当前分支前有 * 号</p><p>创建分支：git branch</p><p>切换分支：git checkout</p><p>创建+切换分支：git checkout -b</p><p>合并某分支到当前分支：git merge</p><p>删除分支：git branch -d</p><p><strong>合并分支：</strong></p><p>1、先建一个分支              git branch 分支名</p><p>2、切换到新建的分支          git checkout 分支名</p><p>3、提交分支上的代码          git add .    git commit -m “提交注释”</p><p>4、切换至主分支上            git checkout master</p><p>5、然后合并分支              git merge 分支<br>6、合并完以后就 push           最好先 pull 一次   然后 git push</p><p>7、切换到自己的分支          git merge 线上分支名称</p><p>设置 git 忽略文件： 1.创建文件：.gitignore 2.忽略文件列表</p><h1 id="gitignore-忽略文件列表"><a href="#gitignore-忽略文件列表" class="headerlink" title=".gitignore 忽略文件列表"></a>.gitignore 忽略文件列表</h1><p>.DS_Store<br>node_modules/<br>/dist/<br>npm-debug.log*<br>yarn-debug.log*<br>yarn-error.log*</p><h1 id="Editor-directories-and-files"><a href="#Editor-directories-and-files" class="headerlink" title="Editor directories and files"></a>Editor directories and files</h1><p>.idea<br>.vscode<br>_.suo<br><em>.ntvs</em><br>_.njsproj<br>*.sln</p><p>如果出现如：<br><strong>Please enter a commit message to explain why this merge is necessary,# especially if it merges an updated upstream into a topic branch.</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">“:wq”是Linux操作系统命令： 表示强制性写入文件并退出。</span><br><span class="line">输入“:wq”，注意是英文输入状态下的冒号，然后按下“Enter”键。</span><br></pre></td></tr></table></figure><hr><h1 id="Git-Submodule"><a href="#Git-Submodule" class="headerlink" title="Git Submodule"></a>Git Submodule</h1><p>有的时候我们会遇到仓库嵌套的问题，即一个仓库内部还有一个 git 仓库。这时就需要使用到 git submodule 模块化。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule add 远程仓库地址  仓库名&#x2F;</span><br></pre></td></tr></table></figure><p>执行此命令后会在外层仓库根目录下生成<strong>一个.gitmodules 文件</strong><br>如果想删除模块的话，可以执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm -r --cached 远程仓库名&#x2F;，并删除对应的.gitmodules文件中的模块信息</span><br></pre></td></tr></table></figure><h1 id="git-push-时遇到：！-rejected-master-gt-master-non-fast-forward-的问题"><a href="#git-push-时遇到：！-rejected-master-gt-master-non-fast-forward-的问题" class="headerlink" title="git push 时遇到：！[rejected] master -&gt; master(non-fast-forward)的问题"></a>git push 时遇到：！[rejected] master -&gt; master(non-fast-forward)的问题</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. git pull origin master --allow-unrelated histories 把远程和本地同步，消除差异</span><br><span class="line">2. git add</span><br><span class="line">3. git commit -m</span><br><span class="line">4. git push origin master</span><br></pre></td></tr></table></figure><h1 id="git-stash"><a href="#git-stash" class="headerlink" title="git stash"></a>git stash</h1><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><blockquote><ol><li>当正在dev分支上开发某个项目，这时项目中出现一个bug，需要紧急修复，但是正在开发的内容只是完成一半，还不想提交，这时可以用<span class='p red'>git stash</span>命令将修改的内容保存至堆栈区，然后顺利切换到fix分支进行bug修复，修复完成后，再次切回到dev分支，从堆栈中恢复刚刚保存的内容。</li><li>由于疏忽，本应该在dev分支开发的内容，却在master上进行了开发，需要重新切回到dev分支上进行开发，可以用<span class='p red'>git stash</span>将内容保存至堆栈中，切回到dev分支后，再次恢复内容即可。<br>总的来说，<span class='p red'>git stash</span>命令的作用就是将目前还不想提交的但是已经修改的内容进行保存至堆栈中，后续可以在某个分支上恢复出堆栈中的内容。这也就是说，stash中的内容不仅仅可以恢复到原先开发的分支，也可以恢复到其他任意指定的分支上。<span class='p red'>git stash</span>作用的范围包括工作区和暂存区中的内容，也就是说没有提交的内容都会保存至堆栈中。</li></ol></blockquote><h2 id="常用的用法"><a href="#常用的用法" class="headerlink" title="常用的用法"></a>常用的用法</h2><ol><li>git stash save “save message”  : 执行存储时，添加备注，方便查找，只有git stash 也要可以的，但查找时不方便识别。</li><li>git stash list  ：查看stash了哪些存储</li><li>git stash show ：显示做了哪些改动，默认show第一个存储,如果要显示其他存贮，后面加stash@{$num}，比如第二个 git stash show stash@{1}</li><li>git stash show -p : 显示第一个存储的改动，如果想显示其他存存储，命令：git stash show  stash@{$num}  -p ，比如第二个：git stash show  stash@{1}  -p</li><li>git stash apply :应用某个存储,但不会把存储从存储列表中删除，默认使用第一个存储,即stash@{0}，如果要使用其他个，git stash apply stash@{$num} ， 比如第二个：git stash apply stash@{1} </li><li>git stash pop ：命令恢复之前缓存的工作目录，将缓存堆栈中的对应stash删除，并将对应修改应用到当前的工作目录下,默认为第一个stash,即stash@{0}，如果要应用并删除其他stash，命令：git stash pop stash@{$num} ，比如应用并删除第二个：git stash pop stash@{1}</li><li>git stash drop stash@{$num} ：丢弃stash@{$num}存储，从列表中删除这个存储</li><li>git stash clear ：删除所有缓存的stash</li></ol><hr><h1 id="SVN-使用"><a href="#SVN-使用" class="headerlink" title="SVN 使用"></a>SVN 使用</h1><p>使用 VisualSVN Server 建立版本库<br><a href="https://www.cnblogs.com/lcyuhe/p/4539696.html">https://www.cnblogs.com/lcyuhe/p/4539696.html</a></p>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>js 深拷贝总结</title>
      <link href="va1sn5/"/>
      <url>va1sn5/</url>
      
        <content type="html"><![CDATA[<h2 id="JSON-stringify-amp-amp-JSON-parse"><a href="#JSON-stringify-amp-amp-JSON-parse" class="headerlink" title="JSON.stringify &amp;&amp; JSON.parse"></a>JSON.stringify &amp;&amp; JSON.parse</h2><p>这是最简单的 js 实现深拷贝方式了，原理是先将对象转换为字符串，再通过 JSON.parse 重新建立一个对象。</p><p><em>但这种方式存在一定的局限性：</em></p><p><strong>不能复制 Function、正则、Symbol</strong><br><strong>循环引用会报错</strong><br><strong>相同引用会被重复复制</strong><br>根据以上三点我们来验证，实测代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  func: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  reg: <span class="regexp">/^abc$/</span>,</span><br><span class="line">  syb: <span class="built_in">Symbol</span>(<span class="string">&quot;demo&quot;</span>),</span><br><span class="line">  str: <span class="string">&quot;abc&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> copyObj = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line"><span class="built_in">console</span>.log(copyObj);</span><br></pre></td></tr></table></figure><p>打印结果：Function、正则和 Symbol 都没有被复制正确的值</p><p>如果 JSON.stringify 中传入一个循环引用的对象，就会报错：</p><p>我们来看看下面这段代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123; <span class="attr">name</span>: <span class="string">&quot;Mike&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> obj2 = &#123; <span class="attr">age</span>: <span class="number">18</span> &#125;;</span><br><span class="line"></span><br><span class="line">obj1.text1 = obj2; <span class="comment">// &#123;age:18&#125;</span></span><br><span class="line">obj1.text2 = obj2; <span class="comment">// &#123;age:18&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> copys = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj1));</span><br><span class="line"></span><br><span class="line">obj1.text1.age = <span class="number">22</span>;</span><br><span class="line">copys.text1.age = <span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;原对象&quot;</span>, obj1);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;复制对象&quot;</span>, copys);</span><br></pre></td></tr></table></figure><p>结果：<br>我们看到当原对象的 text1.age 改变时 text2.age 也会改变；因为它们指向相同的对象。</p><p>但是，在复制对象中 text1 和 text2 分别指向两个对象，复制对象没有保持和原对象一样的结构；所以可以得出：</p><p>JSON 实现深拷贝不能处理指向相同引用的情况，相同的引用会被重复复制。</p><hr><h2 id="递归实现深拷贝"><a href="#递归实现深拷贝" class="headerlink" title="递归实现深拷贝"></a>递归实现深拷贝</h2><p>通过递归遍历实现深拷贝，对于简单类型，进行直接复制；引用类型，递归复制它的每一个属性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> obj !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> obj === <span class="string">&quot;object&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_cloneDeep</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!isObject(target)) <span class="keyword">return</span> target;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> result = <span class="built_in">Array</span>.isArray(target) ? [] : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(target);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = keys.length; i &lt; len; i++) &#123;</span><br><span class="line">    result[keys[i]] = cloneDeep(target[keys[i]]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上代码并没有考虑到循环引用和相同引用的问题；对于循环引用的对象使用的话会直接栈溢出，会出现和 JSON 方法一样的问题。</p><h3 id="解决方法和思路："><a href="#解决方法和思路：" class="headerlink" title="解决方法和思路："></a>解决方法和思路：</h3><p>1、通过闭包维护一个变量，变量中存储已经遍历过的对象</p><p>2、每次递归时判断当前的参数是否已经存在于变量中；如果已经存在，说明已经递归过该对象，就停止这次递归并返回上次递归该对象时的返回值</p><p>代码实现如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 判断类型</span></span><br><span class="line">  <span class="keyword">return</span> obj !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> obj === <span class="string">&quot;object&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_cloneDeep</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> visitedObjs = [];</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">baseClone</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isObject(target)) <span class="keyword">return</span> target;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; visitedObjs.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (visitedObjs[i].target === target) &#123;</span><br><span class="line">        <span class="keyword">return</span> visitedObjs[i].result;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result = <span class="built_in">Array</span>.isArray(target) ? [] : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    visitedObjs.push(&#123; target, result &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(target);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = keys.length; i &lt; len; i++) &#123;</span><br><span class="line">      result[keys[i]] = baseClone(target[keys[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> baseClone(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS 声明提升</title>
      <link href="df4477/"/>
      <url>df4477/</url>
      
        <content type="html"><![CDATA[<h2 id="产生因素"><a href="#产生因素" class="headerlink" title="产生因素"></a>产生因素</h2><p>函数在执行时会先创建当前的执行上下文环境。其中产生声明提升的因素有以下两点：</p><ul><li>变量定义</li><li>函数声明</li></ul><hr><h2 id="编译阶段"><a href="#编译阶段" class="headerlink" title="编译阶段"></a>编译阶段</h2><blockquote><p>当 js 引擎开始解析脚本时，这时代码还没有运行，会先给代码中的变量、函数声明设置内存，并暂时将变量赋值为 undefined,函数先声明为可使用；为后面即将执行的代码做准备，这个阶段就是编译阶段。</p></blockquote><p>比如 var a = 1； JS 引擎会将其看作两个声明：var a; 和 a = 1;。第一个定义声明在编译阶段进行，第二个赋值声明会被留在原地等待执行阶段。</p><hr><h2 id="变量声明提升"><a href="#变量声明提升" class="headerlink" title="变量声明提升"></a>变量声明提升</h2><blockquote><p>只有 var 声明的变量存在变量提升；let、const 会形成块级作用域，造成暂时性死区。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(fun); <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">var</span> fun = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br></pre></td></tr></table></figure><p>上面例子都会会打印出 ‘undefined’，变量声明提升会将变量声明提升到作用域顶部，但只会提升声明部分，不会提升赋值部分，实际提升后结果如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a;</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line">a = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fun;</span><br><span class="line"><span class="built_in">console</span>.log(fun);</span><br><span class="line">fun = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br></pre></td></tr></table></figure><hr><h2 id="函数声明提升"><a href="#函数声明提升" class="headerlink" title="函数声明提升"></a>函数声明提升</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>上例不会报错，因为 ‘函数声明提升’，即将函数声明提升（整体）到作用域顶部（注意是函数声明，不包括函数表达式），实际提升后结果同下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">func();</span><br></pre></td></tr></table></figure><hr><h2 id="函数声明和变量声明提升的优先顺序"><a href="#函数声明和变量声明提升的优先顺序" class="headerlink" title="函数声明和变量声明提升的优先顺序"></a>函数声明和变量声明提升的优先顺序</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> func = <span class="number">1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span>(func))  <span class="comment">// number</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">-----</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span>(func))  <span class="comment">// function</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> func = <span class="number">1</span></span><br></pre></td></tr></table></figure><p>上两例将分别输出 ‘number’、’function’，原因是 函数声明提升优先于变量提升，函数声明会被变量赋值影响，但不会被变量声明影响，实际提升后结果如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> func = <span class="number">10</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span>(func))</span><br><span class="line"></span><br><span class="line">-----</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> func</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span>(func))</span><br><span class="line">func = <span class="number">10</span></span><br></pre></td></tr></table></figure><hr><h2 id="局部与全局变量"><a href="#局部与全局变量" class="headerlink" title="局部与全局变量"></a>局部与全局变量</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">window</span>.a = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(a); <span class="comment">// undefined</span></span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">window</span>.a); <span class="comment">// 2</span></span><br><span class="line">&#125;</span><br><span class="line">func();</span><br></pre></td></tr></table></figure><p>上例将会分别打印出 ‘undefined’、’5’，第一处为局部变量，第二处为全局变量，实际提升后结果如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  <span class="built_in">window</span>.a = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(a); <span class="comment">// undefined</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">window</span>.a); <span class="comment">// 2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a;</span><br><span class="line">a = <span class="number">1</span>;</span><br><span class="line">func();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitHub 精选—前端</title>
      <link href="ebgc4u/"/>
      <url>ebgc4u/</url>
      
        <content type="html"><![CDATA[<h2 id="综合资源"><a href="#综合资源" class="headerlink" title="综合资源"></a>综合资源</h2><h3 id="javascript（Star：108k）"><a href="#javascript（Star：108k）" class="headerlink" title="javascript（Star：108k）"></a><a href="https://github.com/airbnb/javascript">javascript</a>（Star：108k）</h3><p>airbnb 出品写 js 最佳的姿势，已成众多公司 js 代码风格的标准</p><ul><li>github 仓库地址：<a href="https://github.com/airbnb/javascript">https://github.com/airbnb/javascript</a></li></ul><h3 id="awesome-wechat-weapp（Star：34-9k）"><a href="#awesome-wechat-weapp（Star：34-9k）" class="headerlink" title="awesome-wechat-weapp（Star：34.9k）"></a><a href="https://github.com/justjavac/awesome-wechat-weapp">awesome-wechat-weapp</a>（Star：34.9k）</h3><p>微信小程序开发资源汇总 💯</p><ul><li>github 仓库地址：<a href="https://github.com/justjavac/awesome-wechat-weapp">https://github.com/justjavac/awesome-wechat-weapp</a></li></ul><h3 id="gold-miner（Star：28-8k）"><a href="#gold-miner（Star：28-8k）" class="headerlink" title="gold-miner（Star：28.8k）"></a><a href="https://github.com/xitu/gold-miner">gold-miner</a>（Star：28.8k）</h3><p>🥇 掘金翻译计划，可能是世界最大最好的英译中技术社区，最懂读者和译者的翻译平台</p><ul><li>github 仓库地址：<a href="https://github.com/xitu/gold-miner">https://github.com/xitu/gold-miner</a></li></ul><h3 id="Blog（Star：22-7k）"><a href="#Blog（Star：22-7k）" class="headerlink" title="Blog（Star：22.7k）"></a><a href="https://github.com/mqyqingfeng/Blog">Blog</a>（Star：22.7k）</h3><p>冴羽写博客的地方，预计写四个系列：JavaScript 深入系列、JavaScript 专题系列、ES6 系列、React 系列</p><ul><li>github 仓库地址：<a href="https://github.com/mqyqingfeng/Blog">https://github.com/mqyqingfeng/Blog</a></li></ul><h3 id="mars（Star：15-4k）"><a href="#mars（Star：15-4k）" class="headerlink" title="mars（Star：15.4k）"></a><a href="https://github.com/Tencent/mars#mars_cn">mars</a>（Star：15.4k）</h3><p>腾讯移动 web 前端知识库</p><ul><li>github 仓库地址：<a href="https://github.com/Tencent/mars#mars_cn">https://github.com/Tencent/mars#mars_cn</a></li></ul><h3 id="Besr-App（Star：14-9k）"><a href="#Besr-App（Star：14-9k）" class="headerlink" title="Besr-App（Star：14.9k）"></a><a href="https://github.com/hzlzh/Best-App">Besr-App</a>（Star：14.9k）</h3><p>收集&amp;推荐优秀的 Apps/硬件/技巧/周边等</p><ul><li>github 仓库地址：<a href="https://github.com/hzlzh/Best-App">https://github.com/hzlzh/Best-App</a></li></ul><h3 id="Awsome-Front-End-learning-resource（Star：7-4k）"><a href="#Awsome-Front-End-learning-resource（Star：7-4k）" class="headerlink" title="Awsome-Front-End-learning-resource（Star：7.4k）"></a><a href="https://github.com/helloqingfeng/Awsome-Front-End-learning-resource">Awsome-Front-End-learning-resource</a>（Star：7.4k）</h3><p>GitHub 最全的前端资源汇总仓库（包括前端学习、开发资源、求职面试等）</p><ul><li>github 仓库地址：<a href="https://github.com/helloqingfeng/Awsome-Front-End-learning-resource">https://github.com/helloqingfeng/Awsome-Front-End-learning-resource</a></li><li>线上地址：<a href="https://helloqingfeng.github.io/front-end-index/index.html">https://helloqingfeng.github.io/front-end-index/index.html</a></li></ul><h3 id="front-end-collect（Star：5-3k）"><a href="#front-end-collect（Star：5-3k）" class="headerlink" title="front-end-collect（Star：5.3k）"></a><a href="https://github.com/foru17/front-end-collect">front-end-collect</a>（Star：5.3k）</h3><p>作者分享自己长期关注的前端开发相关的优秀网站、博客、以及活跃开发者</p><ul><li>github 仓库地址：<a href="https://github.com/foru17/front-end-collect">https://github.com/foru17/front-end-collect</a></li></ul><h3 id="Front-end-tutorial（Star：4-4k）"><a href="#Front-end-tutorial（Star：4-4k）" class="headerlink" title="Front-end-tutorial（Star：4.4k）"></a><a href="https://github.com/windiest/Front-end-tutorial">Front-end-tutorial</a>（Star：4.4k）</h3><p>最全的资源教程-前端涉及的所有知识体系</p><ul><li>github 仓库地址：<a href="https://github.com/windiest/Front-end-tutorial">https://github.com/windiest/Front-end-tutorial</a></li></ul><h3 id="mobile-web-favorites（Star：1-7k）"><a href="#mobile-web-favorites（Star：1-7k）" class="headerlink" title="mobile-web-favorites（Star：1.7k）"></a><a href="https://github.com/hoosin/mobile-web-favorites">mobile-web-favorites</a>（Star：1.7k）</h3><p>移动端 H5 开发经验、资源、以及踩坑汇总</p><ul><li>github 仓库地址：<a href="https://github.com/hoosin/mobile-web-favorites">https://github.com/hoosin/mobile-web-favorites</a></li></ul><hr><h2 id="面试相关"><a href="#面试相关" class="headerlink" title="面试相关"></a>面试相关</h2><h3 id="fe-interview-（Star：17-5k）"><a href="#fe-interview-（Star：17-5k）" class="headerlink" title="fe-interview （Star：17.5k）"></a><a href="https://github.com/haizlin/fe-interview">fe-interview</a> （Star：17.5k）</h3><p>前端面试每日 3+1，以面试题来驱动学习，提倡每日学习与思考，每天进步一点！</p><ul><li>github 仓库地址：<a href="https://github.com/haizlin/fe-interview">https://github.com/haizlin/fe-interview</a></li></ul><h3 id="CS-Interview-Knowledge-Map（Star：17k）"><a href="#CS-Interview-Knowledge-Map（Star：17k）" class="headerlink" title="CS-Interview-Knowledge-Map（Star：17k）"></a><a href="https://github.com/InterviewMap/CS-Interview-Knowledge-Map">CS-Interview-Knowledge-Map</a>（Star：17k）</h3><p>一份前端面试资源，作者很用心，还配有专门的网页</p><ul><li>github 仓库地址：<a href="https://github.com/InterviewMap/CS-Interview-Knowledge-Map">https://github.com/InterviewMap/CS-Interview-Knowledge-Map</a></li><li>线上地址：<a href="https://yuchengkai.cn/home/">https://yuchengkai.cn/home/</a></li></ul><hr><h2 id="样式-UI-css"><a href="#样式-UI-css" class="headerlink" title="样式/UI/css"></a>样式/UI/css</h2><h3 id="Semantic-UI（Star：49-2k）"><a href="#Semantic-UI（Star：49-2k）" class="headerlink" title="Semantic-UI（Star：49.2k）"></a><a href="https://github.com/Semantic-Org/Semantic-UI">Semantic-UI</a>（Star：49.2k）</h3><p>让你使用任何 html 标签来表现 UI 控件，这是一款语义化设计的前端框架，为攻城师而制作的可复用的开源前端框架</p><ul><li>github 仓库地址：<a href="https://github.com/Semantic-Org/Semantic-UI">https://github.com/Semantic-Org/Semantic-UI</a></li><li>线上文档地址：<a href="https://semantic-ui.com/">https://semantic-ui.com/</a></li></ul><h3 id="normalize-css（Star：43-5k）"><a href="#normalize-css（Star：43-5k）" class="headerlink" title="normalize.css（Star：43.5k）"></a><a href="https://github.com/necolas/normalize.css">normalize.css</a>（Star：43.5k）</h3><p>一个可定制的 css 文件，使浏览器呈现的所有元素，更一致和符合现代标准。支持 IE8+</p><ul><li>github 仓库地址：<a href="https://github.com/necolas/normalize.css">https://github.com/necolas/normalize.css</a></li></ul><h3 id="materialize（Star：38-5k）"><a href="#materialize（Star：38-5k）" class="headerlink" title="materialize（Star：38.5k）"></a><a href="https://github.com/Dogfalo/materialize">materialize</a>（Star：38.5k）</h3><p>materialize 是 material design 一套轻量级的纯 CSS 框架。material design 是 Goole 提出的一套 UI 设计方案，并应 Goole 用于所有产品中</p><ul><li>github 仓库地址：<a href="https://github.com/Dogfalo/materialize">https://github.com/Dogfalo/materialize</a></li><li>线上文档地址：<a href="https://materializecss.com/">https://materializecss.com/</a></li></ul><h3 id="weui（Star：25-6k）"><a href="#weui（Star：25-6k）" class="headerlink" title="weui（Star：25.6k）"></a><a href="https://github.com/Tencent/weui/blob/master/README_cn.md">weui</a>（Star：25.6k）</h3><p>为微信 web 服务量身设计的一套 ui 框架</p><ul><li>github 仓库地址：<a href="https://github.com/Tencent/weui/blob/master/README_cn.md">https://github.com/Tencent/weui/blob/master/README_cn.md</a></li><li>演示地址：<a href="https://weui.io/">https://weui.io/</a></li></ul><h3 id="pure（Star：21-6k）"><a href="#pure（Star：21-6k）" class="headerlink" title="pure（Star：21.6k）"></a><a href="https://github.com/pure-css/pure">pure</a>（Star：21.6k）</h3><p>一组很小的，响应式的 css 组件，你可以在网页的项目上到处使用</p><ul><li>github 仓库地址：<a href="https://github.com/pure-css/pure">https://github.com/pure-css/pure</a></li><li>线上文档地址：<a href="https://purecss.io/">https://purecss.io/</a></li></ul><h3 id="uikit（Star：16-8k）"><a href="#uikit（Star：16-8k）" class="headerlink" title="uikit（Star：16.8k）"></a><a href="https://github.com/uikit/uikit">uikit</a>（Star：16.8k）</h3><p>一个轻量级的、模块化前端框架，它被用于快速开发强大的 web 界面。也是一款优秀的响应式 html5 框架</p><ul><li>github 仓库地址：<a href="https://github.com/uikit/uikit">https://github.com/uikit/uikit</a></li><li>线上文档地址：<a href="https://getuikit.com/">https://getuikit.com/</a></li></ul><h3 id="iCSS（Star：9-8k）"><a href="#iCSS（Star：9-8k）" class="headerlink" title="iCSS（Star：9.8k）"></a><a href="https://github.com/chokcoco/iCSS">iCSS</a>（Star：9.8k）</h3><p>一系列 css 有趣的话题，有开发中常用 css 代码；CSS 奇技淫巧，在这里，都有</p><ul><li>github 仓库地址：<a href="https://github.com/chokcoco/iCSS">https://github.com/chokcoco/iCSS</a></li><li>作者博客地址：<a href="https://www.cnblogs.com/coco1s/">https://www.cnblogs.com/coco1s/</a></li></ul><h3 id="css-doodle（Star：3-5k）"><a href="#css-doodle（Star：3-5k）" class="headerlink" title="css-doodle（Star：3.5k）"></a><a href="https://github.com/css-doodle/css-doodle">css-doodle</a>（Star：3.5k）</h3><p>一个用 css 绘制图形的 web 组件</p><ul><li>github 仓库地址：<a href="https://github.com/css-doodle/css-doodle">https://github.com/css-doodle/css-doodle</a></li><li>线上地址：<a href="https://css-doodle.com/">https://css-doodle.com/</a></li></ul><hr><h2 id="构建工具-预编译"><a href="#构建工具-预编译" class="headerlink" title="构建工具/预编译"></a>构建工具/预编译</h2><h3 id="TypeScript（Star：70-5k）"><a href="#TypeScript（Star：70-5k）" class="headerlink" title="TypeScript（Star：70.5k）"></a><a href="https://github.com/microsoft/TypeScript">TypeScript</a>（Star：70.5k）</h3><p>有类型的 js 预编译语言，非常强大的预编译与代码报错提示，赋予了 JS 构建大型项目的可能</p><ul><li>github 仓库地址：<a href="https://github.com/microsoft/TypeScript">https://github.com/microsoft/TypeScript</a></li><li>线上文档地址：<a href="https://www.typescriptlang.org/zh/">https://www.typescriptlang.org/zh/</a></li></ul><h3 id="webpack（Star：58-1k）"><a href="#webpack（Star：58-1k）" class="headerlink" title="webpack（Star：58.1k）"></a><a href="https://github.com/webpack/webpack">webpack</a>（Star：58.1k）</h3><p>一个模块打包工具，你可以使用 webpack 管理你的模块依赖，并编绎输出模块们所需的静态文件</p><ul><li>github 仓库地址：<a href="https://github.com/webpack/webpack">https://github.com/webpack/webpack</a></li><li>线上文档地址：</li></ul><h3 id="babel（Star：38-9k）"><a href="#babel（Star：38-9k）" class="headerlink" title="babel（Star：38.9k）"></a><a href="https://github.com/babel/babel">babel</a>（Star：38.9k）</h3><p>是一款为了写下一代 js 的编译器，无需等待浏览器支持就可以使用各种 ES6，ES7 新的语法</p><ul><li>github 仓库地址：<a href="https://github.com/babel/babel">https://github.com/babel/babel</a></li><li>线上文档地址：<a href="https://babel.dev/">https://babel.dev/</a></li></ul><h3 id="parcel（Star：38k）"><a href="#parcel（Star：38k）" class="headerlink" title="parcel（Star：38k）"></a><a href="https://github.com/parcel-bundler/parcel">parcel</a>（Star：38k）</h3><p>一个零配置的新一代前端构建工具，识别各种常用类型文件，最优加载模块，代码拆包等，非常值得尝试的一款打包工具</p><ul><li>github 仓库地址：<a href="https://github.com/parcel-bundler/parcel">https://github.com/parcel-bundler/parcel</a></li><li>线上文档地址：<a href="https://parceljs.org/">https://parceljs.org/</a></li></ul><h3 id="gulp（Star：32-2k）"><a href="#gulp（Star：32-2k）" class="headerlink" title="gulp（Star：32.2k）"></a><a href="https://github.com/gulpjs/gulp">gulp</a>（Star：32.2k）</h3><p>基于 node.js 流构建系统，只有原生几个 api，和庞大的插件生态，使用非常简单</p><ul><li>github 仓库地址：<a href="https://github.com/gulpjs/gulp">https://github.com/gulpjs/gulp</a></li><li>线上文档地址：<a href="https://gulpjs.com/">https://gulpjs.com/</a></li></ul><h3 id="postcss（Star：24-5k）"><a href="#postcss（Star：24-5k）" class="headerlink" title="postcss（Star：24.5k）"></a><a href="https://github.com/postcss/postcss">postcss</a>（Star：24.5k）</h3><p>用 js 插件来对 css 样式文件，进行转换、预编译等操作，并且实现了模块化，支持非常多插架</p><ul><li>github 仓库地址：<a href="https://github.com/postcss/postcss">https://github.com/postcss/postcss</a></li><li>线上文档地址：<a href="https://postcss.org/">https://postcss.org/</a></li></ul><h3 id="less-js（Star：16-6k）"><a href="#less-js（Star：16-6k）" class="headerlink" title="less.js（Star：16.6k）"></a><a href="https://github.com/less/less.js">less.js</a>（Star：16.6k）</h3><p>轻量级的，动态 CSS 预编语言，具有 CSS 所有特性，并提供了动态编程方式编写 CSS 代码。也是各大 UI 框架所选用的样式语言，比如 bootstrap,ant design 等</p><ul><li>github 仓库地址：<a href="https://github.com/less/less.js">https://github.com/less/less.js</a></li><li>线上文档地址：<a href="https://lesscss.org/">https://lesscss.org/</a></li></ul><h3 id="stylus（Star：10-7k）"><a href="#stylus（Star：10-7k）" class="headerlink" title="stylus（Star：10.7k）"></a><a href="https://github.com/stylus/stylus">stylus</a>（Star：10.7k）</h3><p>富有表现力的，健壮的 css 预编译语言, 除了代码简洁，可读性强外，函数功能非常强大，可与 js 混合使用，实现动态 css 编程</p><ul><li>github 仓库地址：<a href="https://github.com/stylus/stylus">https://github.com/stylus/stylus</a></li><li>线上文档地址：<a href="https://stylus-lang.com/">https://stylus-lang.com/</a></li></ul><h3 id="node-sass（Star：7-7k）"><a href="#node-sass（Star：7-7k）" class="headerlink" title="node-sass（Star：7.7k）"></a><a href="https://github.com/sass/node-sass">node-sass</a>（Star：7.7k）</h3><p>动态 CSS 预编语言, 并有拥有强大 sass compass 的生态圈，可以直接引入并使用，sass 是由 ruby 编写的，node-sass 是 node 重构版本，方便 npm 直接使用<br>富有表现力的，健壮的 css 预编译语言, 除了代码简洁，可读性强外，函数功能非常强大，可与 js 混合使用，实现动态 css 编程</p><ul><li>github 仓库地址：<a href="https://github.com/sass/node-sass">https://github.com/sass/node-sass</a></li><li>npm 地址：<a href="https://www.npmjs.com/package/node-sass">https://www.npmjs.com/package/node-sass</a></li></ul><hr><h2 id="canvas-数据可视化"><a href="#canvas-数据可视化" class="headerlink" title="canvas/数据可视化"></a>canvas/数据可视化</h2><h3 id="d3（Star：96-7k）"><a href="#d3（Star：96-7k）" class="headerlink" title="d3（Star：96.7k）"></a><a href="https://github.com/d3/d3">d3</a>（Star：96.7k）</h3><p>一个基于数据操作文档的 js 数据可视化框架，最流行的数据可视化库之一</p><ul><li>github 仓库地址：<a href="https://github.com/d3/d3">https://github.com/d3/d3</a></li><li>线上文档地址：<a href="https://d3js.org/">https://d3js.org/</a></li></ul><h3 id="Chart-js（Star：53-4k）"><a href="#Chart-js（Star：53-4k）" class="headerlink" title="Chart.js（Star：53.4k）"></a><a href="https://github.com/chartjs/Chart.js">Chart.js</a>（Star：53.4k）</h3><p>使用 canvas 标签的简易 html5 图表</p><ul><li>github 仓库地址：<a href="https://github.com/chartjs/Chart.js">https://github.com/chartjs/Chart.js</a></li><li>线上文档地址：<a href="https://www.chartjs.org/">https://www.chartjs.org/</a></li></ul><h3 id="echarts（Star：46-2k）"><a href="#echarts（Star：46-2k）" class="headerlink" title="echarts（Star：46.2k）"></a><a href="https://github.com/apache/echarts">echarts</a>（Star：46.2k）</h3><p>基于 canvas 的纯 js 图表库，提供直观，生动，可交互，可个性化定制的数据可视化图表</p><ul><li>github 仓库地址：<a href="https://github.com/apache/echarts">https://github.com/apache/echarts</a></li><li>线上文档地址：<a href="https://echarts.apache.org/zh/index.html">https://echarts.apache.org/zh/index.html</a></li></ul><h3 id="G2（Star：10-6k）"><a href="#G2（Star：10-6k）" class="headerlink" title="G2（Star：10.6k）"></a><a href="https://github.com/antvis/G2">G2</a>（Star：10.6k）</h3><p>是一套基于可视化编码的图形语法，以数据驱动，具有高度的易用性和扩展性，可定制的颗粒度极细，相比项目 echart 大而全且易用的图表库，这个库会让你有不一样的体验，且官方提供了 g2-react 的 react 封装包</p><ul><li>github 仓库地址：<a href="https://github.com/antvis/G2">https://github.com/antvis/G2</a></li><li>线上文档地址：<a href="https://g2.antv.vision/zh">https://g2.antv.vision/zh</a></li></ul><h3 id="highcharts（Star：10k）"><a href="#highcharts（Star：10k）" class="headerlink" title="highcharts（Star：10k）"></a><a href="https://github.com/highcharts/highcharts">highcharts</a>（Star：10k）</h3><p>基于 svg 的 javascript 图表框架</p><ul><li>github 仓库地址：<a href="https://github.com/highcharts/highcharts">https://github.com/highcharts/highcharts</a></li><li>线上文档地址：<a href="https://www.highcharts.com/">https://www.highcharts.com/</a></li></ul><h3 id="c3（Star：9-1k）"><a href="#c3（Star：9-1k）" class="headerlink" title="c3（Star：9.1k）"></a><a href="https://github.com/c3js/c3">c3</a>（Star：9.1k）</h3><p>一个基于 d3.js 的可重用 javascript 图表库，几乎零学习曲线</p><ul><li>github 仓库地址：<a href="https://github.com/c3js/c3">https://github.com/c3js/c3</a></li><li>线上文档地址：<a href="https://c3js.org/">https://c3js.org/</a></li></ul><h3 id="G6（Star：7-8k）"><a href="#G6（Star：7-8k）" class="headerlink" title="G6（Star：7.8k）"></a><a href="https://github.com/antvis/G6">G6</a>（Star：7.8k）</h3><p>是一个由纯 JavaScript 编写的关系图基础技术框架。开发者能基于 G6 进行关系图的分析视图和编辑视图进行快速的二次开发</p><ul><li>github 仓库地址：<a href="https://github.com/antvis/G6">https://github.com/antvis/G6</a></li><li>线上文档地址：<a href="https://g6.antv.vision/zh">https://g6.antv.vision/zh</a></li></ul><h3 id="zrender（Star：4-8k）"><a href="#zrender（Star：4-8k）" class="headerlink" title="zrender（Star：4.8k）"></a><a href="https://github.com/ecomfe/zrender">zrender</a>（Star：4.8k）</h3><p>一个轻量级的 canvas 类库，mvc 封装，数据驱动，提供类 dom 事件模型，让 canvas 绘图大有不同</p><ul><li>github 仓库地址：<a href="https://github.com/ecomfe/zrender">https://github.com/ecomfe/zrender</a></li><li>线上文档地址：<a href="https://ecomfe.github.io/zrender-doc/public/">https://ecomfe.github.io/zrender-doc/public/</a></li></ul><hr><h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><h3 id="animate-css（Star：69-9k）"><a href="#animate-css（Star：69-9k）" class="headerlink" title="animate.css（Star：69.9k）"></a><a href="https://github.com/animate-css/animate.css">animate.css</a>（Star：69.9k）</h3><p>一个跨浏览器的 css 动画库，实现了多种 css3 动画效果，简单易用易上手</p><ul><li>github 仓库地址：<a href="https://github.com/animate-css/animate.css">https://github.com/animate-css/animate.css</a></li><li>线上文档地址：<a href="https://animate.style/">https://animate.style/</a></li></ul><h3 id="anime（Star：39-1k）"><a href="#anime（Star：39-1k）" class="headerlink" title="anime（Star：39.1k）"></a><a href="https://github.com/juliangarnier/anime">anime</a>（Star：39.1k）</h3><p>极小的 js 动画引擎，支持 css3、svg 的动画效果，能编写出各种复杂动画效果，gzip 后 6K 左右</p><ul><li>github 仓库地址：<a href="https://github.com/juliangarnier/anime">https://github.com/juliangarnier/anime</a></li><li>线上文档地址：<a href="https://animejs.com/">https://animejs.com/</a></li></ul><hr><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><h3 id="fullPage-js（Star：32-1k）"><a href="#fullPage-js（Star：32-1k）" class="headerlink" title="fullPage.js（Star：32.1k）"></a><a href="https://github.com/alvarotrigo/fullPage.js">fullPage.js</a>（Star：32.1k）</h3><p>pc 端的全屏滚动插件</p><ul><li>github 仓库地址：<a href="https://github.com/alvarotrigo/fullPage.js">https://github.com/alvarotrigo/fullPage.js</a></li><li>线上文档地址：<a href="https://alvarotrigo.com/fullPage/zh/">https://alvarotrigo.com/fullPage/zh/</a></li></ul><h3 id="video-js（Star：31-3k）"><a href="#video-js（Star：31-3k）" class="headerlink" title="video.js（Star：31.3k）"></a><a href="https://github.com/videojs/video.js">video.js</a>（Star：31.3k）</h3><p>开源的 html5 和 flash 视频播放器，支持自定义进度条、按钮以及工具栏的底色</p><ul><li>github 地址：<a href="https://github.com/videojs/video.js">https://github.com/videojs/video.js</a></li></ul><h3 id="awesome-browser-extensions-for-github（Star：2-1k）"><a href="#awesome-browser-extensions-for-github（Star：2-1k）" class="headerlink" title="awesome-browser-extensions-for-github（Star：2.1k）"></a><a href="https://github.com/stefanbuck/awesome-browser-extensions-for-github">awesome-browser-extensions-for-github</a>（Star：2.1k）</h3><p>收集关于 github 上优秀的浏览器插件，非常实用</p><ul><li>github 地址：<a href="https://github.com/stefanbuck/awesome-browser-extensions-for-github">https://github.com/stefanbuck/awesome-browser-extensions-for-github</a></li><li>线上地址：<a href="https://stefanbuck.com/awesome-browser-extensions-for-github">https://stefanbuck.com/awesome-browser-extensions-for-github</a></li></ul><h3 id="front-end-plugins-（Star：956）"><a href="#front-end-plugins-（Star：956）" class="headerlink" title="front-end-plugins （Star：956）"></a><a href="https://github.com/iamjoel/front-end-plugins">front-end-plugins</a> （Star：956）</h3><p>前端常用插件汇总</p><ul><li>github 地址：<a href="https://github.com/iamjoel/front-end-plugins">https://github.com/iamjoel/front-end-plugins</a></li></ul><hr><h2 id="框架、库和组件"><a href="#框架、库和组件" class="headerlink" title="框架、库和组件"></a>框架、库和组件</h2><h3 id="three-js（Star：70-3k）"><a href="#three-js（Star：70-3k）" class="headerlink" title="three.js（Star：70.3k）"></a><a href="https://github.com/mrdoob/three.js">three.js</a>（Star：70.3k）</h3><p>是 js 编写的 webgl 第三方库，提供了非常多的 3D 显示功能</p><ul><li>github 仓库地址：<a href="https://github.com/mrdoob/three.js">https://github.com/mrdoob/three.js</a></li><li>线上地址：<a href="https://threejs.org/">https://threejs.org/</a></li></ul><h3 id="reveal-js（Star：56-2k）"><a href="#reveal-js（Star：56-2k）" class="headerlink" title="reveal.js（Star：56.2k）"></a><a href="https://github.com/hakimel/reveal.js">reveal.js</a>（Star：56.2k）</h3><p>基于 css3 的 3D 幻灯片工具，能够制作绚丽的演示文稿并生成 html 格式，将它发布到 web 上</p><ul><li>github 地址：<a href="https://github.com/hakimel/reveal.js">https://github.com/hakimel/reveal.js</a></li><li>线上地址：<a href="https://revealjs.com/">https://revealjs.com/</a></li></ul><h3 id="impress-js（Star：36-3k）"><a href="#impress-js（Star：36-3k）" class="headerlink" title="impress.js（Star：36.3k）"></a><a href="https://github.com/impress/impress.js">impress.js</a>（Star：36.3k）</h3><p>创建令人兴奋的演示。使用 css3 的转换和过渡，这个库允许你创建令人印象深刻的演示文稿</p><ul><li>github 地址：<a href="https://github.com/impress/impress.js">https://github.com/impress/impress.js</a></li></ul><h3 id="highlight-js（Star：18-4k）"><a href="#highlight-js（Star：18-4k）" class="headerlink" title="highlight.js（Star：18.4k）"></a><a href="https://github.com/highlightjs/highlight.js">highlight.js</a>（Star：18.4k）</h3><p>js 语法高亮，既可以运行在浏览器端也可以运行在服务端</p><ul><li>github 地址：<a href="https://github.com/highlightjs/highlight.js">https://github.com/highlightjs/highlight.js</a></li></ul><h3 id="ice-飞冰-（Star：16-3k）"><a href="#ice-飞冰-（Star：16-3k）" class="headerlink" title="ice(飞冰)（Star：16.3k）"></a><a href="https://github.com/alibaba/ice">ice(飞冰)</a>（Star：16.3k）</h3><p>阿里飞冰，从此再也不担心管理系统的开发。(简单项目还是可以，复杂的做不了)</p><ul><li>github 仓库地址：<a href="https://github.com/alibaba/ice">https://github.com/alibaba/ice</a></li><li>线上文档地址：<a href="https://ice.work/">https://ice.work/</a></li></ul><h3 id="ScrollMagic（Star：13-1k）"><a href="#ScrollMagic（Star：13-1k）" class="headerlink" title="ScrollMagic（Star：13.1k）"></a><a href="https://github.com/janpaepke/ScrollMagic">ScrollMagic</a>（Star：13.1k）</h3><p>一款非常赞的滚动交互的 js 插件，可用于官网与宣传广告场景</p><ul><li>github 地址：<a href="https://github.com/janpaepke/ScrollMagic">https://github.com/janpaepke/ScrollMagic</a></li></ul><h3 id="nodePPT（Star：9-3k）"><a href="#nodePPT（Star：9-3k）" class="headerlink" title="nodePPT（Star：9.3k）"></a><a href="https://github.com/ksky521/nodeppt">nodePPT</a>（Star：9.3k）</h3><p>使用 nodejs 写的网络幻灯片，可能是迄今为止最好的网页版 ppt</p><ul><li>github 地址：<a href="https://github.com/ksky521/nodeppt">https://github.com/ksky521/nodeppt</a></li><li>演示地址：<a href="https://nodeppt.js.org/#slide=1">https://nodeppt.js.org/#slide=1</a></li></ul><h3 id="webuploader（Star：7-5k）"><a href="#webuploader（Star：7-5k）" class="headerlink" title="webuploader（Star：7.5k）"></a><a href="https://github.com/fex-team/webuploader">webuploader</a>（Star：7.5k）</h3><p>一个简单的以 html5 为主，flash 为辅的现代文件上传组件。支持大文件分片并发上传，极大的提高了文件上传效率</p><ul><li>github 地址：<a href="https://github.com/fex-team/webuploader">https://github.com/fex-team/webuploader</a></li><li>线上地址：<a href="http://fex.baidu.com/webuploader/">http://fex.baidu.com/webuploader/</a></li></ul><h3 id="JavaScript-Load-Image（Star：4-1k）"><a href="#JavaScript-Load-Image（Star：4-1k）" class="headerlink" title="JavaScript-Load-Image（Star：4.1k）"></a><a href="https://github.com/blueimp/JavaScript-Load-Image">JavaScript-Load-Image</a>（Star：4.1k）</h3><p>一个 js 加载和转换图像文件的库</p><ul><li>github 地址：<a href="https://github.com/blueimp/JavaScript-Load-Image">https://github.com/blueimp/JavaScript-Load-Image</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> GitHub </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GitHub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue 组件—常用选项(methods、watch、filters、props、computed)</title>
      <link href="hczb69/"/>
      <url>hczb69/</url>
      
        <content type="html"><![CDATA[<p>在介绍这些选项之前，我们先要了解这几个属性参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">el: 指定Vue实例的挂载点，也就是DOM元素，是Vue的特有属性</span><br><span class="line">data: 用于声明需要响应式绑定的数据对象（实例的数据）</span><br><span class="line">components：Vue实例配置局部注册组件</span><br><span class="line">template：用于挂载元素的字符串模板</span><br><span class="line">render：渲染函数，创建虚拟DOM，是字符串模板的替代方案</span><br></pre></td></tr></table></figure><p>首先，先创建出一个 Vue 实例：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&quot;#app&quot;</span>, <span class="comment">// 挂载点</span></span><br><span class="line">  data: &#123;&#125;, <span class="comment">// vm实例数据</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><hr><h2 id="methods-方法"><a href="#methods-方法" class="headerlink" title="methods 方法"></a>methods 方法</h2><p>methods 选项是个对象，在其内部可以定义方法<br>比如说 click 事件、请求方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    num: <span class="number">1</span>,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">numAdd</span>(<span class="params">e</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(e, event);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.num++;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; num &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;numAdd&quot;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>通过 v-on 指令绑定 click 点击事件，调用 methods 中定义的 numAdd()方法;从而实现 data 中 num 值加 1，并更新视图。</p><ul><li>方法的参数（方法中可以获得绑定事件的 event）<ol><li> 当 numAdd 时，默认的参数值为 event 事件对象</li><li> 当 numAdd(5)时，参数 e 就是传过来的参数 5</li></ol></li></ul><hr><h2 id="watch-侦听属性（观察）"><a href="#watch-侦听属性（观察）" class="headerlink" title="watch 侦听属性（观察）"></a>watch 侦听属性（观察）</h2><p>侦听属性 watch 的作用可以监控 Vue 实例上的数据变动，并调用其回调函数。<br>在 watch 中侦听数据变化，一旦变化就执行回调，其回调函数有两个参数，新值和旧值，如果侦听的数据是数组或对象，新值和旧值打印的结果是一样的。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    num: <span class="number">1</span>,</span><br><span class="line">    list: [</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&quot;a&quot;</span>, <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">num</span>: <span class="number">12.45</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&quot;b&quot;</span>, <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">num</span>: <span class="number">23.6789</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&quot;c&quot;</span>, <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">num</span>: <span class="number">43.512</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&quot;d&quot;</span>, <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">num</span>: <span class="number">55.4</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&quot;e&quot;</span>, <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">num</span>: <span class="number">40</span> &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">numAdd</span>(<span class="params">e</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.num + e;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">changeList</span>(<span class="params">val</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.list.push(val);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  watch: &#123;</span><br><span class="line">    <span class="function"><span class="title">num</span>(<span class="params">oldVal, newVal</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`监听到num的变化，<span class="subst">$&#123;oldVal&#125;</span>---&gt;<span class="subst">$&#123;newVal&#125;</span>`</span>);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">list</span>(<span class="params">oldVal, newVal</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`监听到list的变化，<span class="subst">$&#123;oldVal&#125;</span>---&gt;<span class="subst">$&#123;newVal&#125;</span>`</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; num &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;numAdd(5)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>ID<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>Num<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">&quot;item in list&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; item.id &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; item.num &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;changList(&#123;name:&#x27;f&#x27;,id:6, num: 10&#125;)&quot;</span>&gt;</span>PUSH<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="handler-方法和-immediate-属性"><a href="#handler-方法和-immediate-属性" class="headerlink" title="handler 方法和 immediate 属性"></a>handler 方法和 immediate 属性</h3><p>watch 中的方法在最初绑定的时候是不会执行的，只有当数据发生改变时才会去监听数据，当我们想要让它一开始就执行的话，就要用到 handler 和 immediate。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">watch:&#123;</span><br><span class="line">  num:&#123;</span><br><span class="line">    <span class="function"><span class="title">handler</span>(<span class="params">oldVal,newVal</span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`监听到num的变化，<span class="subst">$&#123;oldVal&#125;</span>---&gt;<span class="subst">$&#123;newVal&#125;</span>`</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    immediate: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="deep-深度监听属性"><a href="#deep-深度监听属性" class="headerlink" title="deep(深度监听属性)"></a>deep(深度监听属性)</h3><p>watch 中有一个深度监听属性 deep,默认为 false;当数据为引用类型时，重新赋值时未监听到，可以通过设置 deep 属性来进行深度监听。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  list: &#123;</span><br><span class="line">    <span class="function"><span class="title">handler</span>(<span class="params">oldVal,newVal</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`监听到list的变化，<span class="subst">$&#123;oldVal&#125;</span>---&gt;<span class="subst">$&#123;newVal&#125;</span>`</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    deep: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="filters-过滤器"><a href="#filters-过滤器" class="headerlink" title="filters 过滤器"></a>filters 过滤器</h2><p>在 Vue 中允许自定义过滤器，来用于文本的格式化。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">过滤器一般用于双花括号“&#123;&#123;&#125;&#125;”插值和v-bind表达式中，也可以用于methods方法中。</span><br><span class="line"></span><br><span class="line">过滤器应该被添加在JS表达式的尾部，由“管道”符号连接。</span><br><span class="line"></span><br><span class="line">过滤器函数始终以表达式的值作为第一个参数；带引号的参数视为字符串，而不带引号的参数按表达式计算。</span><br><span class="line"></span><br><span class="line">模板中调用过滤器函数时如果使用了参数，顺序称为过滤器函数的第二、三…个函数。</span><br><span class="line"></span><br><span class="line">可以添加多个过滤器。</span><br></pre></td></tr></table></figure><p>现将 list 中的 num 值做一下格式化，只保留到整数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//** 根据list中 name值进行格式化*/</span></span><br><span class="line"><span class="keyword">const</span> nameOptions = [</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">&quot;a&quot;</span>, <span class="attr">value</span>: <span class="string">&quot;张三&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">&quot;b&quot;</span>, <span class="attr">value</span>: <span class="string">&quot;小明&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">&quot;c&quot;</span>, <span class="attr">value</span>: <span class="string">&quot;李四&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">&quot;d&quot;</span>, <span class="attr">value</span>: <span class="string">&quot;王五&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">&quot;e&quot;</span>, <span class="attr">value</span>: <span class="string">&quot;小华&quot;</span> &#125;,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> nameValue = nameOptions.reduce(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">  a[b.key] = b.value;</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line">  filters:&#123;</span><br><span class="line">    <span class="function"><span class="title">numFilter</span>(<span class="params">val</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> val.toFixed(<span class="number">0</span>)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">nameFilter</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> nameValue[value]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; num | numFilter &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; name | nameFilter &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>也可以定义全局的过滤器，放在 Vue 实例之前：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vue.filter(<span class="string">&quot;numFilter&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> val.toFixed(<span class="number">0</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>如何在 js 中使用过滤器？</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.list.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  item.num = <span class="built_in">this</span>.$options.filters[<span class="string">&quot;numFilter&quot;</span>](item.num);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><hr><h2 id="props-用于接收来自父组件的数据（组件通信）"><a href="#props-用于接收来自父组件的数据（组件通信）" class="headerlink" title="props 用于接收来自父组件的数据（组件通信）"></a>props 用于接收来自父组件的数据（组件通信）</h2><p>组件实例的作用域是孤立的。在子组件的模板内不能直接引用父组件的数据。父组件的数据需要通过 Prop 才能下发到子组件中，使用选项 props 申明该组件可接受的 prop 列表。</p><blockquote><p>Prop 可以理解为在组件上注册的一些自定义属性，这些属性的值可以通过组件的 props 选项接收到。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 父组件</span></span><br><span class="line">  &lt;template&gt;</span><br><span class="line">    &lt;Child  name=<span class="string">&quot;userName&quot;</span> /&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;script&gt;</span><br><span class="line">  <span class="keyword">import</span> Child <span class="keyword">from</span> <span class="string">&quot;./Child&quot;</span></span><br><span class="line">   <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">     name: <span class="string">&#x27;parent&#x27;</span>,</span><br><span class="line">     components: &#123; Child &#125;   <span class="comment">// 注入 Child 组件</span></span><br><span class="line">     <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> &#123;</span><br><span class="line">         userName: <span class="string">&#x27;李四&#x27;</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">   &#125;</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// 子组件</span></span><br><span class="line">  &lt;template&gt;</span><br><span class="line">  &lt;!-- 李四 --&gt;</span><br><span class="line">  &#123;&#123; name &#125;&#125;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name:<span class="string">&#x27;Child&#x27;</span>,</span><br><span class="line">  <span class="comment">//*字符串数组写法*/</span></span><br><span class="line">  <span class="comment">// props: [&#x27;name&#x27;]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//*对象写法*/</span></span><br><span class="line">  props: &#123;</span><br><span class="line">    name: &#123;</span><br><span class="line">      type: <span class="built_in">String</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="string">&#x27;张三&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><blockquote><p>单向数据流：父级 prop 的更新会向下流动到子组件中，但是反过来则不行；每次父级组件发生更新时，子组件中所有的 prop 都将会刷新为最新的值。</p></blockquote><hr><h2 id="computed-计算属性"><a href="#computed-计算属性" class="headerlink" title="computed 计算属性"></a>computed 计算属性</h2><p>有时候，我们拿到一些数据，需要经过处理计算后得到的结果，才是我们要展示的内容；对于复杂的计算应当使用实例的计算属性 computed。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  平均年龄：&lt;span&gt;&#123;&#123; meanAge &#125;&#125;&lt;/span&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        dataList: [</span><br><span class="line">          &#123;<span class="attr">name</span>: <span class="string">&#x27;张三&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span>&#125;,</span><br><span class="line">          &#123;<span class="attr">name</span>: <span class="string">&#x27;李四&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span>&#125;,</span><br><span class="line">          &#123;<span class="attr">name</span>: <span class="string">&#x27;王五&#x27;</span>, <span class="attr">age</span>: <span class="number">22</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//*计算属性*/</span></span><br><span class="line">    computed: &#123;</span><br><span class="line">      <span class="function"><span class="title">meanAge</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">           <span class="keyword">let</span> sum = <span class="built_in">this</span>.dataList.reduce(<span class="function">(<span class="params">sum, data</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> sum + <span class="built_in">parseInt</span>(data.age);</span><br><span class="line">          &#125;, <span class="number">0</span>);</span><br><span class="line">          <span class="keyword">return</span> sum / <span class="built_in">this</span>.dataList.length;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><blockquote><p>计算属性对于从现有源组合新数据非常方便，与方法相比，它们的一大优点是缓存了输出。<br>即：如果独立于计算属性的某些内容在页面上发生更改，并且重新呈现 UI。<br>computed 中的方法会返回缓存的结果，不会重新计算；<br>methods 中方法中会重新执行。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javascript 之 this 指向问题</title>
      <link href="vtadwe/"/>
      <url>vtadwe/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>关于 this 指向的问题，之前我一直都相信这样的说法：谁调用它，this 就指向谁。可是在开发中往往有一些不一样的情况；所以在这里说说我对 this 的一些认知和理解。</p><p>首先，我们要知道的是，<strong>this 的指向，是在函数被调用的时候被确定的</strong>。也就是在执行上下文被创建时确定的。</p><hr><p><strong>例 1：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">// window</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.a); <span class="comment">// undefined</span></span><br><span class="line">&#125;</span><br><span class="line">fn();</span><br></pre></td></tr></table></figure><p>按照我们上面说的 this 最终指向的是调用它的对象，这里的函数 fn 实际是被 Window 对象所点出来的，如下代码可以得到证明。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">// window</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.a); <span class="comment">// undefined</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.fn();</span><br></pre></td></tr></table></figure><p>其实 alert 也是 window 的一个属性，也是 window 点出来的。</p><hr><p><strong>例 2：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">a = <span class="number">10</span>;</span><br><span class="line">fn:<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">// &#123;a: 10, fn: ƒ&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">this</span>.a); <span class="comment">// 10</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.fn();</span><br></pre></td></tr></table></figure><p>这里的 this 指向的对象是 obj,因为调用这个 fn 是通过 obj.fn()执行的，那么自然指向的就是对象 obj，还有就是，this 的指向在函数创建的时候是决定不了的，只有在调用的时候才能决定，谁调用的就指向谁。</p><p>其实上面两个例子也并不是很准确，下面看看接下来的几个例子。</p><hr><p><strong>例 3：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">a = <span class="number">10</span>;</span><br><span class="line">fn: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">this</span>.a); <span class="comment">// 10</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">// &#123;a: 10, fn: ƒ&#125;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.obj.fn();</span><br></pre></td></tr></table></figure><p>例 3 和例 2 几乎是一样的，但是这里的 this 为什么不是指向 window，如果按照上面的理论，最终 this 指向的应该是调用它的对象 window,而不是 obj。<br>好，话不多说，暂且先不说为什么 this 没有指向 window，我们再来看一段代码。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: <span class="number">10</span>,</span><br><span class="line">  b: &#123;</span><br><span class="line">    a: <span class="number">20</span>,</span><br><span class="line">    fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">// &#123;a: 20, fn: ƒ&#125;</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.a); <span class="comment">// 20</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.b.fn();</span><br></pre></td></tr></table></figure><p>这里同样也是对象 obj 点出来的，但是 this 并没有执行它，那是不是之前说的都是错误的呢？其实只能说一开始说的不准确；接下来要补充的才是重点。</p><p><strong>情况一</strong>：如果一个函数中有 this，但是它没有被上一级的对象所调用，在非严格模式下那么 this 指向的就是 window。<br><strong>情况二</strong>：如果一个函数中有 this，这个函数有被上一级的对象所调用，那么 this 指向的就是上一级的对象。<br><strong>情况三</strong>：如果一个函数中有 this，这个函数包含多个对象，<strong>尽管这个函数是被最外层的对象所调用，this 指向的也只是它上一级的对象</strong>，例 3 就可以证明这一点，接下来可以再来几个例子来说明。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: <span class="number">10</span>,</span><br><span class="line">  b: &#123;</span><br><span class="line">    fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">// &#123;fn: ƒ&#125;</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.a); <span class="comment">// undefined</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.b.fn();</span><br></pre></td></tr></table></figure><p>尽管对象 b 中没有属性 a，这个 this 指向的也是对象 b，因为 this 只会指向它的上一级对象，不管这个对象中有没有 this 要的东西。</p><hr><p><strong>还有比较特殊的情况，例 4</strong>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: <span class="number">10</span>,</span><br><span class="line">  b: &#123;</span><br><span class="line">    a: <span class="number">20</span>,</span><br><span class="line">    fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.a); <span class="comment">//undefined</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">// window</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fun = obj.b.fn;</span><br><span class="line">fun();</span><br></pre></td></tr></table></figure><p>这里的 this 指向的是 window，到这里是不是搞得有些蒙了？其实就是还有句话，<strong>this 永远指向的是最后调用它的对象，也就是看它执行的时候是谁调用的</strong>；例 4 中虽然函数 fn 是被对象 b 所引用，但是在将 fn 赋值给变量 fun 的时候并没用执行，所以最终指向的是 window。</p><h2 id="构造函数-this"><a href="#构造函数-this" class="headerlink" title="构造函数 this"></a>构造函数 this</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fnuction <span class="function"><span class="title">Fun</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.str = <span class="string">&quot;构造函数&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> Fun();</span><br><span class="line"><span class="built_in">console</span>.log(a.str);  <span class="comment">// 构造函数</span></span><br></pre></td></tr></table></figure><p>这里之所以对象 a 可以点出函数 Fun 里面的 str 是因为 new 关键字可以改变 this 的指向，将这个 this 指向对象 a，这里用变量 a 创建了一个 Fun 的实例，相当于复制了一份 Fun 到对象 a 里面，此时只是创建好，并没有执行，而调用这个函数 Fun 的是对象 a，那么 this 指向的自然就是对象 a，那么为什么对象 a 中会有 str，因为已经复制了一份 Fun 函数到对象 a 中，用了 new 关键字就相当于复制了一份。</p><hr><p>除此之外，我们还可以自行改变 this 的指向，在 javascript 中提供了<strong>call，apply，bind</strong>来解决，一般用来指定 this 的环境。<br>例如，我们通常会遇到这样的问题</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">    <span class="comment">// console.log(this);</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line"><span class="built_in">console</span>.log(b()); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>我们想打印对象 a 里面的 name 却打印出来 undefined 是什么情况？如果直接执行 a.fn()是可以的。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(a.fn()); <span class="comment">// 张三</span></span><br></pre></td></tr></table></figure><p>这里能够打印是因为这里的 this 指向的是函数 a，那为什么上面的不是指向 a 呢？那么为了可以达到目的，就需要通过以下方法实现。</p><h2 id="1、call"><a href="#1、call" class="headerlink" title="1、call()"></a>1、call()</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name); <span class="comment">// 张三</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line">b.call(a);</span><br></pre></td></tr></table></figure><p>通过 call 方法，给第一个参数添加要把 b 添加到哪个环境中，简单来说，this 就会指向那个对象。<br>call 方法除了第一个参数以外还可以添加多个参数，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name); <span class="comment">//张三</span></span><br><span class="line">    <span class="built_in">console</span>.log(m + n); <span class="comment">// 3</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line">b.call(a, <span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure><hr><h2 id="2、apply"><a href="#2、apply" class="headerlink" title="2、apply()"></a>2、apply()</h2><p>apply 方法和 call 方法有些相似，它也可以改变 this 的指向</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name); <span class="comment">//张三</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line">b.apply(a);</span><br></pre></td></tr></table></figure><p>同样 apply 也可以有多个参数，但是不同的是，第二个参数必须是一个数组，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name); <span class="comment">//张三</span></span><br><span class="line">    <span class="built_in">console</span>.log(m + n); <span class="comment">//30</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line">b.apply(a, [<span class="number">10</span>, <span class="number">20</span>]);</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name); <span class="comment">//张三</span></span><br><span class="line">    <span class="built_in">console</span>.log(m + n); <span class="comment">//30</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">20</span>];</span><br><span class="line">b.apply(a, arr);</span><br></pre></td></tr></table></figure><blockquote><p>注意：如果 call 和 apply 的第一个参数是 null,那么 this 指向的是 window 对象</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">//Window</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line">b.apply(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure><hr><h2 id="3、bind"><a href="#3、bind" class="headerlink" title="3、bind()"></a>3、bind()</h2><p>bind 方法和 call、apply 方法有些不同，但不管怎么说它们都是用来改变 this 的指向。<br>先来说说它们的不同吧。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line">b.bind(a);</span><br></pre></td></tr></table></figure><p>我们发现代码没有打印，对，这就是 bind 和 call、apply 方法的不同，实际上 bind（）返回的是一个修改过后的函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line"><span class="keyword">var</span> c = b.bind(a);</span><br><span class="line"><span class="built_in">console</span>.log(c); <span class="comment">//ƒ ()&#123;console.log(this.name);&#125;</span></span><br></pre></td></tr></table></figure><p>那么我们现在执行一下函数 c 看看，能不能打印出对象 a 里面的 name</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name); <span class="comment">// 张三</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line"><span class="keyword">var</span> c = b.bind(a);</span><br><span class="line">c();</span><br></pre></td></tr></table></figure><p>OK!同样 bind 也可以有多个参数，并且参数可以执行的时候再次添加，但是要注意的是，参数是按照形参的顺序进行的。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  fn: <span class="function"><span class="keyword">function</span> (<span class="params">num1, num2, num3</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name); <span class="comment">//张三</span></span><br><span class="line">    <span class="built_in">console</span>.log(num1, num2, num3); <span class="comment">// 10  1  2</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.fn;</span><br><span class="line"><span class="keyword">var</span> c = b.bind(a, <span class="number">10</span>);</span><br><span class="line">c(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure><hr><blockquote><p>总结：call 和 apply 都是改变上下文中的 this 并立即执行这个函数，bind 方法可以让对应的函数想什么时候调用就什么调用，并且可以将参数在执行的时候添加，这是它们的区别，根据自己实际情况来选择使用。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
